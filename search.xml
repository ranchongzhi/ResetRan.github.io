<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pythonçˆ¬è™«ï¼ˆ4ï¼‰â€”â€”XPathè¯­æ³•å’Œlxml</title>
      <link href="2020/07/07/python-spyder-4/"/>
      <url>2020/07/07/python-spyder-4/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰é¢çš„pythonçˆ¬è™«ï¼ˆ1-3ï¼‰è®²äº†æ€ä¹ˆå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å¾—ç½‘é¡µçš„æºä»£ç ï¼Œä¸è¿‡ä¸€ä¸ªç½‘é¡µçš„æºä»£ç æœ‰å¾ˆå¤šéƒ¨åˆ†æˆ‘ä»¬éƒ½æ˜¯ç”¨ä¸ä¸Šçš„ï¼Œé‚£ç”¨ä»€ä¹ˆæ–¹æ³•èƒ½å¿«é€Ÿè·å–åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œç½‘é¡µè§£æå°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå¸¸ç”¨çš„è§£ææ–¹æ³•æœ‰ï¼šXPathè¯­å¥ã€beautifulsoup4åº“ã€reæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™é‡Œå…ˆæ¥ä»‹ç»ç¬¬ä¸€ç§ã€‚</p><h1 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a>XPath</h1><h2 id="ä»€ä¹ˆæ˜¯XPath"><a href="#ä»€ä¹ˆæ˜¯XPath" class="headerlink" title="ä»€ä¹ˆæ˜¯XPath"></a>ä»€ä¹ˆæ˜¯XPath</h2><p>xpathï¼ˆXML Path Languageï¼‰æ˜¯ä¸€é—¨åœ¨ XML å’Œ HTML æ–‡æ¡£ä¸­æŸ¥æ‰¾ä¿¡æ¯çš„è¯­è¨€ï¼Œå¯ç”¨æ¥åœ¨ XMLå’Œ HTML æ–‡æ¡£ä¸­å¯¹å…ƒç´ å’Œå±æ€§è¿›è¡Œéå†ã€‚ç®€å•ç‚¹è¯´ï¼Œè¿™ç©æ„å„¿å°±æ˜¯ç”¨æ¥å¸®æˆ‘ä»¬æå–ç½‘é¡µæºä»£ç ä¸­æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®çš„ï¼Œæ¯”å¦‚æ ‡ç­¾å±æ€§å€¼ã€æ–‡æœ¬å€¼ã€é“¾æ¥ç­‰ç­‰éƒ½èƒ½é€šè¿‡XPathè¯­æ³•æå–ã€‚</p><h2 id="XPathè¯­æ³•çš„å¼€å‘å·¥å…·ï¼ˆChromeæ’ä»¶ï¼‰"><a href="#XPathè¯­æ³•çš„å¼€å‘å·¥å…·ï¼ˆChromeæ’ä»¶ï¼‰" class="headerlink" title="XPathè¯­æ³•çš„å¼€å‘å·¥å…·ï¼ˆChromeæ’ä»¶ï¼‰"></a>XPathè¯­æ³•çš„å¼€å‘å·¥å…·ï¼ˆChromeæ’ä»¶ï¼‰</h2><p>æˆ‘ä»¬æƒ³çœ‹XPathè¯­æ³•å®æ—¶çš„æ•ˆæœï¼Œæˆ‘è§‰å¾—ç›´æ¥åœ¨æµè§ˆå™¨é‡Œè¾¹å†™æ˜¯æœ€ç›´è§‚çš„æ–¹æ³•äº†ã€‚è°·æ­Œæµè§ˆå™¨çš„æ’ä»¶å°±å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ’ä»¶åå­—å«â€œXPath Helperâ€ï¼Œç›´æ¥å®‰è£…å°±è¡Œï¼Œå®‰è£…æ­¥éª¤å¯ä»¥ç™¾åº¦ï¼Œæ•™ç¨‹ä¸€å¤§æŠŠã€‚<br>æ¥çœ‹çœ‹ä½¿ç”¨ï¼Œè¿™é‡Œä»¥è±†ç“£ç½‘ä¸ºä¾‹å­ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594126565193.jpg"><br>æˆ‘å…ˆå†™ä¸€å¥åšä¸ªä¾‹å­ï¼ˆå–ç”µå½±æ±‰å¯†å°”é¡¿çš„è±†ç“£è¯„åˆ†ï¼‰ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594127192478.jpg"><br>åŒ¹é…å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¯­å¥å¤åˆ¶ä¸‹æ¥ç²˜è´´åˆ°ä»£ç ä¸­ã€‚</p><h2 id="XPathè¯­æ³•è¯¦è§£"><a href="#XPathè¯­æ³•è¯¦è§£" class="headerlink" title="XPathè¯­æ³•è¯¦è§£"></a>XPathè¯­æ³•è¯¦è§£</h2><p>å…³äºXPathçš„è¯­æ³•ä»‹ç»æœ‰å¾ˆå¤šï¼Œè¿™é‡Œç®€å•ç½—åˆ—ï¼š</p><h3 id="é€‰å–èŠ‚ç‚¹"><a href="#é€‰å–èŠ‚ç‚¹" class="headerlink" title="é€‰å–èŠ‚ç‚¹"></a>é€‰å–èŠ‚ç‚¹</h3><table><thead><tr><th align="center">è¡¨è¾¾å¼</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">nodename</td><td align="center">é€‰å–æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹</td></tr><tr><td align="center">/</td><td align="center">ä»æ ¹èŠ‚ç‚¹é€‰å–</td></tr><tr><td align="center">//</td><td align="center">ä»åŒ¹é…é€‰æ‹©çš„å½“å‰èŠ‚ç‚¹é€‰æ‹©æ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ï¼Œè€Œä¸è€ƒè™‘å®ƒä»¬çš„ä½ç½®</td></tr><tr><td align="center">.</td><td align="center">é€‰å–å½“å‰èŠ‚ç‚¹</td></tr><tr><td align="center">..</td><td align="center">é€‰å–å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</td></tr><tr><td align="center">@</td><td align="center">é€‰å–å±æ€§</td></tr></tbody></table><h3 id="è°“è¯­"><a href="#è°“è¯­" class="headerlink" title="è°“è¯­"></a>è°“è¯­</h3><p>è°“è¯­ç”¨æ¥æŸ¥æ‰¾æŸä¸ªç‰¹å®šçš„èŠ‚ç‚¹æˆ–è€…åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼çš„èŠ‚ç‚¹ï¼Œè¢«åµŒåœ¨æ–¹æ‹¬å·ä¸­ã€‚åœ¨ä¸‹é¢çš„è¡¨æ ¼ä¸­ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†å¸¦æœ‰è°“è¯­çš„ä¸€äº›è·¯å¾„è¡¨è¾¾å¼ï¼Œä»¥åŠè¡¨è¾¾å¼çš„ç»“æœï¼š</p><table><thead><tr><th align="center">è·¯å¾„è¡¨è¾¾å¼</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">/bookstore/book[1]</td><td align="center">é€‰å– bookstore ä¸‹çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ </td></tr><tr><td align="center">/bookstore/book[last()]</td><td align="center">é€‰å– bookstore ä¸‹çš„å€’æ•°ç¬¬äºŒä¸ª book å…ƒç´ ã€‚</td></tr><tr><td align="center">bookstore/book[position()&lt;3]</td><td align="center">é€‰å– bookstore ä¸‹å‰é¢ä¸¤ä¸ªå­å…ƒç´ ã€‚</td></tr><tr><td align="center">//book[@price]</td><td align="center">é€‰å–æ‹¥æœ‰ price å±æ€§çš„ book å…ƒç´ </td></tr><tr><td align="center">//book[@price=10]</td><td align="center">é€‰å–æ‰€æœ‰å±æ€§ price ç­‰äº 10 çš„ book å…ƒç´ </td></tr><tr><td align="center">//div[contains(@id,â€™1234â€™)]</td><td align="center">é€‰å–æ‰€ä»¥å±æ€§ id ä¸­å«æœ‰ 1234 çš„ div å…ƒç´ </td></tr></tbody></table><h3 id="é€šé…ç¬¦"><a href="#é€šé…ç¬¦" class="headerlink" title="é€šé…ç¬¦"></a>é€šé…ç¬¦</h3><table><thead><tr><th align="center">é€šé…ç¬¦</th><th align="center">æè¿°</th><th align="center">ç¤ºä¾‹</th><th align="center">ç»“æœ</th></tr></thead><tbody><tr><td align="center">*</td><td align="center">åŒ¹é…ä»»æ„èŠ‚ç‚¹</td><td align="center">/bookstore/*</td><td align="center">é€‰å– bookstore ä¸‹çš„æ‰€æœ‰å­å…ƒç´ ã€‚</td></tr><tr><td align="center">@*</td><td align="center">åŒ¹é…èŠ‚ç‚¹ä¸­çš„ä»»ä½•å±æ€§</td><td align="center">//book[@*]</td><td align="center">é€‰å–æ‰€æœ‰å¸¦æœ‰å±æ€§çš„ book å…ƒç´ ã€‚</td></tr></tbody></table><h3 id="é€‰å–å¤šä¸ªè·¯å¾„"><a href="#é€‰å–å¤šä¸ªè·¯å¾„" class="headerlink" title="é€‰å–å¤šä¸ªè·¯å¾„"></a>é€‰å–å¤šä¸ªè·¯å¾„</h3><p>é€šè¿‡åœ¨è·¯å¾„è¡¨è¾¾å¼ä¸­ä½¿ç”¨â€œ|â€è¿ç®—ç¬¦ï¼Œå¯ä»¥é€‰å–è‹¥å¹²ä¸ªè·¯å¾„ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š<br>**//bookstore/book | //book/title**ï¼ˆé€‰å–æ‰€æœ‰ book å…ƒç´ ä»¥åŠ book å…ƒç´ ä¸‹æ‰€æœ‰çš„ title å…ƒç´ ï¼‰</p><h3 id="XPathè¿ç®—ç¬¦"><a href="#XPathè¿ç®—ç¬¦" class="headerlink" title="XPathè¿ç®—ç¬¦"></a>XPathè¿ç®—ç¬¦</h3><table><thead><tr><th align="center">è¿ç®—ç¬¦</th><th align="center">æè¿°</th><th align="center">å®ä¾‹</th><th align="center">è¿”å›å€¼</th></tr></thead><tbody><tr><td align="center">|</td><td align="center">è®¡ç®—ä¸¤ä¸ªèŠ‚ç‚¹é›†</td><td align="center">//book | //cd</td><td align="center">è¿”å›æ‰€æœ‰æ‹¥æœ‰ book å’Œ cd å…ƒç´ çš„èŠ‚ç‚¹é›†</td></tr><tr><td align="center">+</td><td align="center">åŠ æ³•</td><td align="center">6 + 4</td><td align="center">10</td></tr><tr><td align="center">-</td><td align="center">å‡æ³•</td><td align="center">6 - 4</td><td align="center">2</td></tr><tr><td align="center">*</td><td align="center">ä¹˜æ³•</td><td align="center">6 * 4</td><td align="center">24</td></tr><tr><td align="center">div</td><td align="center">é™¤æ³•</td><td align="center">8 div 4</td><td align="center">2</td></tr><tr><td align="center">=</td><td align="center">ç­‰äº</td><td align="center">price=9.80</td><td align="center">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å›falseã€‚</td></tr><tr><td align="center">!=</td><td align="center">ä¸ç­‰äº</td><td align="center">price!=9.80</td><td align="center">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">&lt;</td><td align="center">å°äº</td><td align="center">price&lt;9.80</td><td align="center">å¦‚æœpriceæ˜¯ 9.00ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">&lt;=</td><td align="center">å°äºæˆ–ç­‰äº</td><td align="center">price&lt;=9.80</td><td align="center">å¦‚æœ price æ˜¯ 9.00ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">&gt;</td><td align="center">å¤§äº</td><td align="center">price&gt;9.80</td><td align="center">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">&gt;=</td><td align="center">å¤§äºæˆ–ç­‰äº</td><td align="center">price&gt;=9.80</td><td align="center">å¦‚æœ price æ˜¯ 9.90ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.70ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">or</td><td align="center">æˆ–</td><td align="center">price=9.80 orprice=9.70</td><td align="center">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 9.50ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">and</td><td align="center">ä¸</td><td align="center">price&gt;9.00 andprice&lt;9.90</td><td align="center">å¦‚æœ price æ˜¯ 9.80ï¼Œåˆ™è¿”å› trueã€‚å¦‚æœ price æ˜¯ 8.50ï¼Œåˆ™è¿”å› falseã€‚</td></tr><tr><td align="center">mod</td><td align="center">è®¡ç®—é™¤æ³•çš„ä½™æ•°</td><td align="center">5 mod 2</td><td align="center">1</td></tr></tbody></table><h1 id="lxml"><a href="#lxml" class="headerlink" title="lxml"></a>lxml</h1><h2 id="ä»€ä¹ˆæ˜¯lxml"><a href="#ä»€ä¹ˆæ˜¯lxml" class="headerlink" title="ä»€ä¹ˆæ˜¯lxml"></a>ä»€ä¹ˆæ˜¯lxml</h2><p>lxml æ˜¯ ä¸€ä¸ª HTML/XML çš„è§£æå™¨ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯å¦‚ä½•è§£æå’Œæå– HTML/XML æ•°æ®ã€‚lxml å’Œæ­£åˆ™ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”¨ C å®ç°çš„ï¼Œæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„ Python HTML/XML è§£æå™¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¹‹å‰å­¦ä¹ çš„ XPath è¯­æ³•ï¼Œæ¥å¿«é€Ÿçš„å®šä½ç‰¹å®šå…ƒç´ ä»¥åŠèŠ‚ç‚¹ä¿¡æ¯ã€‚è¿™é‡Œé™„ä¸Š<a href="http://lxml.de/index.html">å®˜æ–¹æ–‡æ¡£</a></p><h3 id="å…ˆæ¥è¯´ä¸€ä¸ªå‘"><a href="#å…ˆæ¥è¯´ä¸€ä¸ªå‘" class="headerlink" title="å…ˆæ¥è¯´ä¸€ä¸ªå‘"></a>å…ˆæ¥è¯´ä¸€ä¸ªå‘</h3><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨lxmlåº“é‡Œçš„etreeæ–¹æ³•ï¼Œæˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨lxmlåº“çš„æ—¶å€™è¢«å‘çš„è›®æƒ¨ï¼Œç”±äºæˆ‘è£…çš„æ˜¯ç‰ˆæœ¬è¾ƒæ–°çš„lxmlåº“ï¼ˆ4.4.1ï¼‰ï¼Œè€ç‰ˆæœ¬çš„å¯¼å…¥æ–¹æ³•æ˜¯<code>from lxml import etree</code>ï¼Œå—¯ï¼Œæœä¸å…¶ç„¶æŠ¥é”™äº†ã€‚ç„¶åå°±æ˜¯å»æ‰¾ç­”æ¡ˆï¼Œæœ€åå‘ç°åœ¨æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬é‡Œï¼Œetreeè¢«å°è£…åˆ°lxmlä¸‹çš„htmlåº“é‡Œè¾¹äº†ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·å¯¼å…¥ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> htmletree <span class="token operator">=</span> html<span class="token punctuation">.</span>etree</code></pre><h2 id="å¤§è‡´æµç¨‹"><a href="#å¤§è‡´æµç¨‹" class="headerlink" title="å¤§è‡´æµç¨‹"></a>å¤§è‡´æµç¨‹</h2><p>ä½¿ç”¨requestsåº“å’Œlxmlåº“è¿›è¡Œçˆ¬è™«ä¸€èˆ¬åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li><p>å¯¼åº“ï¼Œè®¾ç½®è¯·æ±‚å¤´ï¼Œåˆ©ç”¨requestsåº“å‘ç½‘é¡µå‘é€è¯·æ±‚ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªresponseå¯¹è±¡</p></li><li><p>åˆ©ç”¨etreeå¯¹responseå¯¹è±¡è¿›è¡Œè§£æï¼Œå¾—åˆ°ä¸€ä¸ªlxml.etree._Elementå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥ä½¿ç”¨xpathè¯­æ³•è¿›è¡Œæå–ä¿¡æ¯</p></li><li><p>åˆ©ç”¨xpathè¯­æ³•å¯¹lxml.etree._Elementå¯¹è±¡è¿›è¡Œä¿¡æ¯æå–</p></li><li><p>å°†æå–çš„ä¿¡æ¯è¿›è¡Œå¤„ç†</p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>è¿™é‡Œåˆ©ç”¨requestsåº“å’Œlxmlåº“æ¥çˆ¬å–è±†ç“£ç½‘ç»å…¸çš„ç”µå½±æ’åå‰10çš„ç”µå½±ä¿¡æ¯ï¼š</p></li><li><p>å¯¼å…¥ç›¸å…³æ¨¡å—ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> htmletree <span class="token operator">=</span> html<span class="token punctuation">.</span>etree</code></pre></li><li><p>è®¾ç½®ä¸€äº›å‚æ•°</p><pre class=" language-python"><code class="language-python">headers <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 "</span>               <span class="token string">"(KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36"</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;#è¯·æ±‚å¤´</span>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/chart"</span><span class="token comment" spellcheck="true">#ç›®æ ‡é“¾æ¥</span>movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#ç”¨äºä¿å­˜ç”µå½±ä¿¡æ¯</span></code></pre></li><li><p>requestsåº“è¯·æ±‚</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># å‘æŒ‡å®šé¡µæ•°å‘èµ·è¯·æ±‚ï¼Œå¹¶è¿”å›resopnseå¯¹è±¡</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span></code></pre></li><li><p>etreeå¯¹responseå¯¹è±¡è¿›è¡Œè§£æ</p><pre class=" language-python"><code class="language-python">html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>tables <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//table"</span><span class="token punctuation">)</span></code></pre></li><li><p>ç”¨xpathæå–ä¿¡æ¯å¹¶ä¿å­˜</p><pre class=" language-python"><code class="language-python"><span class="token keyword">for</span> table <span class="token keyword">in</span> tables<span class="token punctuation">:</span> detail_herf <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="nbg"]/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> name <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//a[@class='nbg']/@title"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> post_url <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//img/@src"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//span[@class='rating_nums']/text()"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> movie <span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>     <span class="token string">"href"</span><span class="token punctuation">:</span> detail_herf<span class="token punctuation">,</span><span class="token comment" spellcheck="true">#è¯¦æƒ…é“¾æ¥</span>     <span class="token string">"name"</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span><span class="token comment" spellcheck="true">#ç”µå½±å</span>     <span class="token string">"post_url"</span><span class="token punctuation">:</span> post_url<span class="token punctuation">,</span><span class="token comment" spellcheck="true">#æµ·æŠ¥é“¾æ¥</span>     <span class="token string">"nums"</span><span class="token punctuation">:</span> nums<span class="token comment" spellcheck="true">#è¯„åˆ†</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span> movies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie<span class="token punctuation">)</span></code></pre><p>è¿è¡Œï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594696787504.jpg"><br>æœ€åï¼Œå†è´´ä¸€ä¸‹å®Œæ•´ä»£ç ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># çˆ¬å–è±†ç“£ç”µå½±ç»å…¸å½±ç‰‡æ’å</span><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> htmletree <span class="token operator">=</span> html<span class="token punctuation">.</span>etreeheaders <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 "</span>               <span class="token string">"(KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36"</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/chart"</span>movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>n <span class="token operator">=</span> <span class="token number">1</span><span class="token comment" spellcheck="true"># å‘æŒ‡å®šé¡µæ•°å‘èµ·è¯·æ±‚ï¼Œå¹¶è¿”å›resopnseå¯¹è±¡</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>tables <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//table"</span><span class="token punctuation">)</span><span class="token keyword">for</span> table <span class="token keyword">in</span> tables<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#è¿™ä¸ªåœ°æ–¹å¯ä»¥å€ŸåŠ©å‰é¢ä»‹ç»çš„è°·æ­Œæµè§ˆå™¨æ’ä»¶æ¥æ£€æŸ¥åŒ¹é…æ˜¯å¦æ­£ç¡®</span> detail_herf <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="nbg"]/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> name <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//a[@class='nbg']/@title"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> post_url <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//img/@src"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> table<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">".//span[@class='rating_nums']/text()"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> movie <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>     <span class="token string">"href"</span><span class="token punctuation">:</span> detail_herf<span class="token punctuation">,</span>     <span class="token string">"name"</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span>     <span class="token string">"post_url"</span><span class="token punctuation">:</span> post_url<span class="token punctuation">,</span>     <span class="token string">"nums"</span><span class="token punctuation">:</span> nums <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span> movies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie<span class="token punctuation">)</span></code></pre><h1 id="æ€»ç»“ä¸€ä¸‹"><a href="#æ€»ç»“ä¸€ä¸‹" class="headerlink" title="æ€»ç»“ä¸€ä¸‹"></a>æ€»ç»“ä¸€ä¸‹</h1><p>å—¯ï¼Œæ€»çš„çœ‹æ¥ï¼Œå†™ä¸ªå°çˆ¬è™«å…¶å®æ˜¯å¾ˆç®€å•çš„ï¼Œxpathè¯­æ³•ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä½†ä»…æŒæ¡è¿™äº›æ˜¯ä¸å¤Ÿçš„ï¼Œæ— æ³•å†™å‡ºå¾ˆdiaoçš„çˆ¬è™«ï¼Œè¿˜æœ‰è›®å¤šä¸œè¥¿è¦å­¦ä¹ ï¼</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonçˆ¬è™«ï¼ˆ3ï¼‰â€”â€”cookieä¸requestsåº“</title>
      <link href="2020/07/05/python-spyder-3/"/>
      <url>2020/07/05/python-spyder-3/</url>
      
        <content type="html"><![CDATA[<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>åœ¨ç½‘ç«™ä¸­ï¼Œhttpè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å³ä½¿ç¬¬ä¸€æ¬¡å’ŒæœåŠ¡å™¨è¿æ¥åå¹¶ä¸”ç™»å½•æˆåŠŸåï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶ä¸èƒ½çŸ¥é“å½“å‰è¯·æ±‚æ˜¯å“ªä¸ªç”¨æˆ·ã€‚cookie çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ¬¡ç™»å½•åæœåŠ¡å™¨è¿”å›ä¸€äº›æ•°æ®ï¼ˆcookieï¼‰ç»™æµè§ˆå™¨ï¼Œç„¶åæµè§ˆå™¨ä¿å­˜åœ¨æœ¬åœ°ï¼Œå½“è¯¥ç”¨æˆ·å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨çš„æŠŠä¸Šæ¬¡è¯·æ±‚å­˜å‚¨çš„ cookie æ•°æ®è‡ªåŠ¨çš„æºå¸¦ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡æµè§ˆå™¨æºå¸¦çš„æ•°æ®å°±èƒ½åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å“ªä¸ªäº†ã€‚cookie å­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å­˜å‚¨å¤§å°ï¼Œä½†ä¸€èˆ¬ä¸è¶…è¿‡ 4KBã€‚å› æ­¤ä½¿ç”¨ cookie åªèƒ½å­˜å‚¨ä¸€äº›å°é‡çš„æ•°æ®ã€‚<br>cookieçš„ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ï¼š<br><code>Set-Cookie: NAME=VALUEï¼›Expires/Max-age=DATEï¼›Path=PATHï¼›Domain=DOMAIN_NAMEï¼› SECURE</code><br>å‚æ•°çš„æè¿°å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th align="center">å‚æ•°å</th><th align="center">å‚æ•°æè¿°</th></tr></thead><tbody><tr><td align="center">NAME</td><td align="center">cookieçš„åå­—</td></tr><tr><td align="center">VALUE</td><td align="center">cookieçš„å€¼</td></tr><tr><td align="center">Expires</td><td align="center">cookieçš„è¿‡æœŸæ—¶é—´</td></tr><tr><td align="center">Path</td><td align="center">cookieä½œç”¨çš„è·¯å¾„</td></tr><tr><td align="center">Domain</td><td align="center">cookieä½œç”¨çš„åŸŸå</td></tr><tr><td align="center">SECURE</td><td align="center">æ˜¯å¦åªåœ¨httpsåè®®ä¸‹èµ·ä½œç”¨</td></tr></tbody></table><p>æµè§ˆå™¨ä¿å­˜äº†cookieï¼Œåé¢æ¯æ¬¡è®¿é—®æ—¶å°±æ–¹ä¾¿ï¼Œå¦‚æœè¦ç”¨ä»£ç æ¥å‘é‚£äº›éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„ï¼ˆè¿›è¡Œæ›´å¤šæ“ä½œï¼‰ç½‘ç«™ï¼Œå°±éœ€è¦æŠŠcookieä¿¡æ¯ä¼ ç»™ç›®æ ‡æœåŠ¡å™¨ï¼Œç™»å½•è¯´ç™½äº†ä¹Ÿå°±æ˜¯è¦æœ‰cookieä¿¡æ¯ã€‚è¦è·å–cookieä¿¡æ¯ï¼Œé¦–å…ˆç¬¬ä¸€æƒ³æ³•å°±æ˜¯ç›´æ¥å»ç½‘ç«™ä¸Šç™»å½•ï¼Œç„¶åæŒ‰F12ï¼Œå°±èƒ½æ‰¾åˆ°cookieä¿¡æ¯ï¼Œä»¥äººäººç½‘ï¼ˆè®¿é—®æ¼”å‘˜å¤§é¹ä¸»é¡µï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼‰ä¸ºä¾‹å­ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parse#å…ˆæ³¨é‡Šæ‰cookieheaders=&#123;'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)\         AppleWebKit/537.36 (KHTML, like Gecko) \         Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.58',         # 'Cookie': 'ick_login=0ddad9f3-7fa0-4787-b916-5248ea8bb154; anonymid=kca04u42-rmbvi0; depovince=GW; _r01_=1; JSESSIONID=abchsJm52fkNjfdE5xImx; taihe_bi_sdk_uid=15a8a286885699bb6771e6212cc23aa5; taihe_bi_sdk_session=d83833b4a0fb72a6a466205c9329e993; ick=07bea91b-c6d1-4955-ad33-0980db50a672; t=c2a3a8d10309229b0555eb589c8482575; societyguester=c2a3a8d10309229b0555eb589c8482575; id=974715915; xnsid=dd9ddee7; XNESSESSIONID=6c76a75ff812; WebOnLineNotice_974715915=1; ver=7.0; loginfrom=null; jebe_key=060c174f-c2df-4669-9a2c-584b47a0e4a8%7C032338e00e79b21248aaa07a19d3e44d%7C1594009812653%7C1%7C1594009810029; jebe_key=060c174f-c2df-4669-9a2c-584b47a0e4a8%7C032338e00e79b21248aaa07a19d3e44d%7C1594009812653%7C1%7C1594009810031; wp_fold=0; jebecookies=ba0612a2-0ce7-4a4d-95d1-1f71f38ee8ce|||||'    &#125;url="http://www.renren.com/880151247/profile"req = request.Request(url ,headers=headers)resp = request.urlopen(req)with open('result.html','w',encoding = 'utf-8') as f:    f.writelines(resp.read().decode('utf-8'))</code></pre><p>è¿è¡Œä»£ç ï¼Œä¼šç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€å®ƒï¼Œå‘ç°ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594010413908.jpg"><br>è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„é¡µé¢ï¼Œç„¶åå°†ä¸Šé¢çš„ä»£ç ä¸­cookieéƒ¨åˆ†å–æ¶ˆæ³¨é‡Šï¼Œå†è¿è¡Œï¼Œæ‰“å¼€result.htmlï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594010616018.jpg"><br>å¯ä»¥çœ‹åˆ°å‡ºç°äº†æˆ‘ä»¬æƒ³è¦çš„é¡µé¢ï¼è¿™å°±å¾ˆå¥½çš„ä½“ç°å‡ºcookieçš„ä½œç”¨ã€‚</p><h2 id="http-cookiejaræ¨¡å—"><a href="#http-cookiejaræ¨¡å—" class="headerlink" title="http.cookiejaræ¨¡å—"></a>http.cookiejaræ¨¡å—</h2><p>ä¸Šé¢ä»‹ç»äº†ä¸€ç§å¯è¡Œçš„æ–¹æ³•ï¼Œä¸è¿‡æˆ‘å†™çˆ¬è™«ä¸å°±æ˜¯ä¸ºäº†æé«˜æ•ˆç‡å˜›ï¼Œä½ è¿˜æ¯æ¬¡è®©æˆ‘æ‰‹åŠ¨å»å¤åˆ¶ç²˜è´´cookieä¿¡æ¯ï¼Ÿå†æƒ³æƒ³ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡è¯·æ±‚è·å¾—çŠ¶æ€ç ä¹‹ç±»çš„ç½‘ç«™ä¿¡æ¯ï¼Œcookieä¹Ÿèƒ½ç”¨åŒæ ·çš„æ–¹å¼è·å¾—å‘€ï¼Œé‚£ä¸å°±å®Œäº‹äº†ã€‚è¿™é‡Œæˆ‘ä»¬çš„http.cookiejaræ¨¡å—å°±é—ªäº®ç™»åœºäº†ï¼Œè¯¥æ¨¡å—ä¸»è¦çš„ç±»æœ‰ CookieJarã€FileCookieJarã€MozillaCookieJarã€LWPCookieJarã€‚è¿™å››ä¸ªç±»çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="center">ç±»å</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">CookieJar</td><td align="center">ç®¡ç† HTTP cookie å€¼ã€å­˜å‚¨ HTTP è¯·æ±‚ç”Ÿæˆçš„ cookieã€å‘ä¼ å‡ºçš„ HTTP è¯·æ±‚æ·»åŠ  cookie çš„å¯¹è±¡ã€‚æ•´ä¸ª cookie éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯¹ CookieJar å®ä¾‹è¿›è¡Œåƒåœ¾å›æ”¶å cookieä¹Ÿå°†ä¸¢å¤±ã€‚</td></tr><tr><td align="center">FileCookieJar (filename,delayload=None,policy=None)</td><td align="center">ä» CookieJar æ´¾ç”Ÿè€Œæ¥ï¼Œç”¨åˆ›å»º FileCookieJar å®ä¾‹ï¼Œæ£€ç´¢ cookie ä¿¡æ¯å¹¶å°† cookie å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ã€‚filename æ˜¯å­˜å‚¨cookieçš„æ–‡ä»¶åã€‚delayload ä¸º True æ—¶æ”¯æŒå»¶è¿Ÿè®¿é—®è®¿é—®æ–‡ä»¶ï¼Œå³åªæœ‰åœ¨éœ€è¦æ—¶æ‰è¯»å–æ–‡ä»¶æˆ–åœ¨æ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®ã€‚</td></tr><tr><td align="center">MozillaCookieJar (filename,delayload=None,policy=None)</td><td align="center">ä» FileCookieJar æ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸ Mozilla æµè§ˆå™¨ cookies.txt å…¼å®¹çš„ FileCookieJar å®ä¾‹ã€‚</td></tr><tr><td align="center">LWPCookieJar (filename,delayload=None,policy=None)</td><td align="center">ä» FileCookieJar æ´¾ç”Ÿè€Œæ¥ï¼Œåˆ›å»ºä¸ libwww-perl æ ‡å‡†çš„ Set-Cookie3 æ–‡ä»¶æ ¼å¼å…¼å®¹çš„ FileCookieJar å®ä¾‹ã€‚</td></tr></tbody></table><p>å†ç”¨è¯¥æ¨¡å—å®ç°è®¿é—®äººäººç½‘å¤§é¹çš„ä¸»é¡µï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parsefrom http.cookiejar import CookieJarheaders=&#123;'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)\         AppleWebKit/537.36 (KHTML, like Gecko) \         Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.58'    &#125;#åˆ›é€ ä¸€ä¸ªopenerdef get_opener():    cookjar=CookieJar()    handler=request.HTTPCookieProcessor(cookjar)    opener=request.build_opener(handler)    return opener#åˆ©ç”¨åˆ›é€ å¥½çš„openerå‘é€è¯·æ±‚ï¼Œè¯·æ±‚è¿”å›çš„æ•°æ®ä¸­å°±æœ‰cookieä¿¡æ¯ï¼Œä»–ä¼šä¿å­˜åˆ°cookiejarç±»ä¸­def save_cookie(opener):    login_url="http://www.renren.com/PLogin.do"    #è´¦å·å¯†ç ä¸èƒ½æ³„éœ²å•ŠğŸ˜‚ğŸ˜‚ğŸ˜‚    data=&#123;"email":"##########",          'password':"##########"        &#125;    res = request.Request(login_url,data= parse.urlencode(data).encode('utf8'),method='POST',headers=headers)    opener.open(res)#è®¿é—®å¤§é¹ä¸»é¡µdef get_profile(opener):    url="http://www.renren.com/880151247/profile"    res=request.Request(url,headers=headers)    resp=opener.open(res)    with open('result2.html','w',encoding = 'utf-8') as f:        f.writelines(resp.read().decode('utf-8'))if __name__=='__main__':    opener=get_opener()    save_cookie(opener)    get_profile(opener)</code></pre><p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594037026162.jpg"></p><h2 id="cookieçš„ä¿å­˜ä¸åŠ è½½"><a href="#cookieçš„ä¿å­˜ä¸åŠ è½½" class="headerlink" title="cookieçš„ä¿å­˜ä¸åŠ è½½"></a>cookieçš„ä¿å­˜ä¸åŠ è½½</h2><h3 id="ä¿å­˜åˆ°æœ¬åœ°"><a href="#ä¿å­˜åˆ°æœ¬åœ°" class="headerlink" title="ä¿å­˜åˆ°æœ¬åœ°"></a>ä¿å­˜åˆ°æœ¬åœ°</h3><p>ä¿å­˜ cookie åˆ°æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨ MozillaCookieJar çš„ save æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åã€‚è¿™é‡Œæˆ‘ä»¬å†ç”¨<strong><a href="http://httpbin.org/">http://httpbin.org</a></strong>è¿™ä¸ªç½‘ç«™æ¥æ¼”ç¤ºï¼Œè¯¥ç½‘ç«™å¯ä»¥è®©æˆ‘ä»¬è‡ªå®šä¹‰è¯¥ç½‘ç«™çš„cookieä¿¡æ¯ï¼Œè¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šå›¾ï¼›<br>ä¸»é¡µæ˜¯è¿™æ ·çš„ï¼Œå…ˆç‚¹å‡»cookieé€‰é¡¹:<br><img src="https://zmlzvt.coding-pages.com//post-images/1594041407808.jpg"><br>è·Ÿç€æ­¥éª¤æ¥ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594041429670.jpg"><br>è®¾ç½®å¥½åæ˜¯è¿™æ ·ï¼š<img src="https://zmlzvt.coding-pages.com//post-images/1594041443340.jpg"><br>å¦‚æœæƒ³é‡æ–°è®¾ç½®ï¼Œå¯ä»¥å…ˆæ¸…é™¤è¯¥ç½‘ç«™çš„cookieæ•°æ®å“¦ï¼Œæ€ä¹ˆæ¸…é™¤ç‚¹<a href="https://jingyan.baidu.com/article/09ea3ede592a34c0afde394e.html">å®ƒ</a></p><pre class=" language-py"><code class="language-py">from urllib import request,parsefrom http.cookiejar import MozillaCookieJarheaders=&#123;'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)\         AppleWebKit/537.36 (KHTML, like Gecko) \         Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.58'&#125;url="http://httpbin.org/cookies/set/python/spyder"cookiejar=MozillaCookieJar()handler=request.HTTPCookieProcessor(cookiejar)    opener=request.build_opener(handler)req=request.Request(url,headers=headers)opener.open(req)cookiejar.save('cookie.txt',ignore_discard=True,ignore_expires=True)#ç”±äºè¯¥ç½‘ç«™çš„cookieä¸ä¼šå¯èƒ½ä¼šè¿‡æœŸæˆ–è€…è¢«ä¸¢å¼ƒï¼Œæ‰€ä»¥è¿™é‡Œå¾—è®¾ç½®ä¸€ä¸‹å‚æ•°#ignore_discard çš„æ„æ€æ˜¯å³ä½¿ cookies å°†è¢«ä¸¢å¼ƒä¹Ÿå°†å®ƒä¿å­˜ä¸‹æ¥#ignore_expires çš„æ„æ€æ˜¯å¦‚æœ cookies å·²ç»è¿‡æœŸä¹Ÿå°†å®ƒä¿å­˜å¹¶ä¸”æ–‡ä»¶å·²å­˜åœ¨æ—¶å°†è¦†ç›–with open('cookie.txt','r') as f:    print(f.read())</code></pre><p>å¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº†cookie.txtæ–‡ä»¶ï¼Œé‡Œè¾¹å°±å­˜å‚¨ç€cookieä¿¡æ¯ï¼Œç»“æœå¦‚ä¸‹ï¼ˆå‡ºç°è¿™ç§æ ¼å¼åº”è¯¥æ˜¯saveæ–¹æ³•çš„é—®é¢˜ï¼‰ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594041878454.jpg"></p><h3 id="åŠ è½½cookieä¿¡æ¯"><a href="#åŠ è½½cookieä¿¡æ¯" class="headerlink" title="åŠ è½½cookieä¿¡æ¯"></a>åŠ è½½cookieä¿¡æ¯</h3><p>ç„¶åå†æ¥çœ‹çœ‹åŠ è½½cookieä¿¡æ¯ï¼Œè·Ÿä¸Šè¾¹å¾ˆç±»ä¼¼ï¼š</p><pre class=" language-py"><code class="language-py">headers=&#123;'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)\         AppleWebKit/537.36 (KHTML, like Gecko) \         Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.58'&#125;url="http://httpbin.org/cookies"cookiejar=MozillaCookieJar()cookiejar.load('cookie.txt',ignore_discard=True,ignore_expires=True)handler=request.HTTPCookieProcessor(cookiejar)    opener=request.build_opener(handler)req=request.Request(url,headers=headers)resp=opener.open(req)print(resp.read().decode())</code></pre><p>è¾“å‡ºï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594043291139.jpg"></p><h2 id="Requestsåº“"><a href="#Requestsåº“" class="headerlink" title="Requestsåº“"></a>Requestsåº“</h2><p>è™½ç„¶ Python çš„æ ‡å‡†åº“ä¸­ urllib æ¨¡å—å·²ç»åŒ…å«äº†å¹³å¸¸æˆ‘ä»¬ä½¿ç”¨çš„å¤§å¤šæ•°åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ APIä½¿ç”¨èµ·æ¥è®©äººæ„Ÿè§‰ä¸å¤ªå¥½ï¼Œè€Œ Requests å®£ä¼ æ˜¯ â€œHTTP for Humansâ€ï¼Œè¯´æ˜ä½¿ç”¨æ›´ç®€æ´æ–¹ä¾¿ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç”¨requestsåº“æ¥å®ç°å’ŒurllibåŒæ ·çš„åŠŸèƒ½</p><h3 id="å‘é€getè¯·æ±‚"><a href="#å‘é€getè¯·æ±‚" class="headerlink" title="å‘é€getè¯·æ±‚"></a>å‘é€getè¯·æ±‚</h3><p>requestsåº“å‘é€getè¯·æ±‚ç›´æ¥ä½¿ç”¨getæ–¹æ³•å³å¯ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªresponseå¯¹è±¡ï¼Œå¦‚æœæƒ³æ·»åŠ  headersï¼Œå¯ä»¥ä¼ å…¥ headers å‚æ•°æ¥å¢åŠ è¯·æ±‚å¤´ä¸­çš„ headers ä¿¡æ¯ã€‚å¦‚æœè¦å°†å‚æ•°æ”¾åœ¨ url ä¸­ä¼ é€’ï¼Œå¯ä»¥åˆ©ç”¨params å‚æ•°</p><pre class=" language-py"><code class="language-py">import requestsurl="https://www.baidu.com"headers=&#123;'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)\         AppleWebKit/537.36 (KHTML, like Gecko) \         Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.58'&#125;kw=&#123;'wd':'é«˜è€ƒ'&#125;# params æ˜¯ä¸€ä¸ªå­—å…¸æˆ–è€…å­—ç¬¦ä¸²çš„æŸ¥è¯¢å‚æ•°ï¼Œå­—å…¸è‡ªåŠ¨è½¬æ¢ä¸º url ç¼–ç ï¼Œä¸éœ€è¦urlencode()response = requests.get(url, params = kw, headers = headers)# æŸ¥çœ‹å“åº”å†…å®¹ï¼Œresponse.text è¿”å›çš„æ˜¯ Unicode æ ¼å¼çš„æ•°æ®(python ä¼šåˆ©ç”¨è‡ªå·±çŒœæµ‹çš„ç¼–ç æ–¹å¼è§£ç ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¹±ç çš„é—®é¢˜)print(response.text)# æŸ¥çœ‹å“åº”å¤´éƒ¨å­—ç¬¦ç¼–ç print(response.encoding)# python ä¼šæ ¹æ®ç½‘é¡µå†…å®¹æ¥å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ç¼–ç print(response.apparent_encoding)# å¦‚æœ response.text ä¹±ç äº†ï¼Œå¯ä»¥å…ˆè®¾ç½®response.encoding= response.apparent_encoding# æŸ¥çœ‹å“åº”å†…å®¹ï¼Œresponse.content è¿”å›çš„å­—èŠ‚æµ bytes æ•°æ®print(response.content)print(response.content .decode('utf-8'))# æŸ¥çœ‹å®Œæ•´ url åœ°å€print(response.url)# æŸ¥çœ‹å“åº”ç print(response.status_code)#å¦‚æœç½‘é¡µè¿”å›çš„æ˜¯ jsonï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ response.json()è½¬æ¢ä¸º dict æˆ–è€… listprint(response.json())</code></pre><h3 id="å‘é€-POST-è¯·æ±‚"><a href="#å‘é€-POST-è¯·æ±‚" class="headerlink" title="å‘é€ POST è¯·æ±‚"></a>å‘é€ POST è¯·æ±‚</h3><p>æœ€åŸºæœ¬çš„ POST è¯·æ±‚å¯ä»¥ä½¿ç”¨ post æ–¹æ³•ï¼Œä¼ å…¥ data æ•°æ®ï¼ˆè¿™æ—¶å€™å°±ä¸è¦å†ä½¿ç”¨ urlencode è¿›è¡Œç¼–ç äº†ï¼Œç›´æ¥ä¼ å…¥ä¸€ä¸ªå­—å…¸è¿›å»å°±å¯ä»¥äº†ï¼‰ã€‚è¿”å›çš„ä¹Ÿæ˜¯responseå¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œçš„æ“ä½œåŒä¸Šã€‚æ¯”å¦‚è¯·æ±‚æ‹‰å‹¾ç½‘çš„æ•°æ®çš„ä»£ç ï¼š</p><pre class=" language-py"><code class="language-py">import requestsparams = &#123;'px': 'default',          'city': 'åŒ—äº¬',          'needAddtionalResult': 'false'&#125;data = &#123;'first': 'true',        'pn': 1,        'kd': 'python'&#125;headers = &#123;'Referer': "https://www.lagou.com/jobs/list_python",           'Cookie': 'JSEIONID=ABAAABA9B2BCC46',           'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)'&#125;url = 'https://www.lagou.com/jobs/list_python#filterBox'response = requests.post(url,                         params=params,                         headers=headers,                         data=data,                         timeout=5)response.encoding = 'UTF-8'print(response.text)</code></pre><h3 id="ä½¿ç”¨ä»£ç†"><a href="#ä½¿ç”¨ä»£ç†" class="headerlink" title="ä½¿ç”¨ä»£ç†"></a>ä½¿ç”¨ä»£ç†</h3><p>ä½¿ç”¨ requests æ·»åŠ ä»£ç†ä¹Ÿéå¸¸ç®€å•ï¼Œåªè¦åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸­ï¼ˆæ¯”å¦‚ get æˆ–è€… postï¼‰ä¼ é€’ proxieså‚æ•°å³å¯ï¼ˆæŒ‚äº†ç§‘å­¦ä¸Šç½‘è½¯ä»¶çš„æœ€å¥½å…ˆå…³ä¸€ä¸‹ï¼Œæˆ‘å°±å› ä¸ºæ²¡å…³è¢«å‘æƒ¨äº†ï¼‰ï¼š</p><pre class=" language-py"><code class="language-py">import requestsurl = 'http://www.httpbin.org/ip'proxy = &#123;    'http': '161.35.110.112:3128'&#125;resp_1 = requests.get(url, timeout=5)print(resp_1.text)resp_2 = requests.get(url, proxies=proxy, timeout=5)print(resp_2.text)</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1594091758109.jpg"></p><h3 id="ä½¿ç”¨requests-sessionä¿å­˜cookie"><a href="#ä½¿ç”¨requests-sessionä¿å­˜cookie" class="headerlink" title="ä½¿ç”¨requests.sessionä¿å­˜cookie"></a>ä½¿ç”¨requests.sessionä¿å­˜cookie</h3><p>ä¹‹å‰ä½¿ç”¨ urllib åº“ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨ opener å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå¤šä¸ªè¯·æ±‚ä¹‹é—´æ˜¯å¯ä»¥å…±äº« cookie çš„ã€‚é‚£ä¹ˆå¦‚æœä½¿ç”¨ requestsï¼Œä¹Ÿè¦è¾¾åˆ°å…±äº« cookie çš„ç›®çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ requests åº“ç»™æˆ‘ä»¬æä¾›çš„ session å¯¹è±¡ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ session ä¸æ˜¯ web å¼€å‘ä¸­çš„é‚£ä¸ª sessionï¼Œè¿™ä¸ªåœ°æ–¹åªæ˜¯ä¸€ä¸ªä¼šè¯çš„å¯¹è±¡è€Œå·²ã€‚è¿˜æ˜¯ä»¥ç™»å½•äººäººç½‘ä¸ºä¾‹ï¼Œä½¿ç”¨ requests æ¥å®ç°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-py"><code class="language-py">import requestsurl = "http://www.renren.com/PLogin.do"data = &#123;"email": "970138074@qq.com", 'password': "pythonspider"&#125;headers = &#123;    'UserAgent': "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36"&#125;# ç™»å½•session = requests.session()session.post(url, data=data, headers=headers)# è®¿é—®å¤§é¹ä¸ªäººä¸­å¿ƒresp = session.get('http://www.renren.com/880151247/profile')print(resp.status_code)#è¾“å‡ºï¼š200</code></pre><h2 id="æ€»ç»“ä¸€ä¸‹"><a href="#æ€»ç»“ä¸€ä¸‹" class="headerlink" title="æ€»ç»“ä¸€ä¸‹"></a>æ€»ç»“ä¸€ä¸‹</h2><p>ä¸ªäººæ„Ÿè§‰ä½¿ç”¨æ–¹é¢ç¡®å®requestsåº“æ¯”èµ·urllibçš„APIæ¥å£è¦èˆ’é€‚è®¸å¤šï¼Œæ‰€ä»¥ä»¥åèƒ½ç”¨requestsä¿ºå°±ä¸ç”¨urllibğŸ¤£ğŸ¤£ğŸ¤£</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonçˆ¬è™«ï¼ˆ2ï¼‰â€”â€”urllibåº“</title>
      <link href="2020/07/02/python-spyder-2/"/>
      <url>2020/07/02/python-spyder-2/</url>
      
        <content type="html"><![CDATA[<h2 id="urllibåº“ç®€ä»‹"><a href="#urllibåº“ç®€ä»‹" class="headerlink" title="urllibåº“ç®€ä»‹"></a>urllibåº“ç®€ä»‹</h2><p>urllib åº“æ˜¯ Python ä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„ç½‘ç»œè¯·æ±‚åº“ã€‚å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºï¼Œå‘æŒ‡å®šçš„æœåŠ¡å™¨å‘ é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶å¯ä»¥ä¿å­˜æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚</p><h2 id="urlopenå‡½æ•°"><a href="#urlopenå‡½æ•°" class="headerlink" title="urlopenå‡½æ•°"></a>urlopenå‡½æ•°</h2><p>åœ¨python3çš„<code>urllib</code>åº“ä¸­ï¼Œæ‰€æœ‰å’Œç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ–¹æ³•ï¼Œéƒ½è¢«é›†æˆåˆ°<code>urllib.request</code>æ¨¡å—ä¸‹äº†ï¼Œè¯¥å‡½æ•°çš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹ï¼š</p><p><code>urllib.request.urlopen(url, data=None, [timeout, ]*, cafile=None, capath=None, cadefault=False, context=None)</code></p><p>å…¶ä¸­ï¼š</p><p><code>cafileã€capathã€cadefault</code> å‚æ•°ï¼šç”¨äºå®ç°å¯ä¿¡ä»»çš„ CA è¯ä¹¦çš„ HTTP è¯·æ±‚ã€‚ï¼ˆåŸºæœ¬ä¸Šå¾ˆå°‘ç”¨ï¼‰</p><p><code>context</code> å‚æ•°ï¼šå®ç° SSL åŠ å¯†ä¼ è¾“ã€‚ï¼ˆåŸºæœ¬ä¸Šå¾ˆå°‘ç”¨ï¼‰</p><p>æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å…³æ³¨å‰é¢å‡ ä¸ªå‚æ•°å°±å¯ä»¥äº†ï¼š</p><ul><li>URLï¼šæ‰€è¯·æ±‚çš„URL</li><li>dataï¼šè¯·æ±‚çš„dataï¼Œå¦‚æœè®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œè¯·æ±‚ä¼šå˜ä¸ºpostè¯·æ±‚</li><li>è¿”å›å€¼ï¼šè¿”å›å€¼æ˜¯ä¸€ä¸ªhttp.client.HTTPResponseå¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»æ–‡ä»¶å¥æŸ„å¯¹è±¡ï¼Œå®ƒä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š<ol><li>read(size):è¿”å›æŒ‡å®šå­—èŠ‚çš„æ•°ç›®ï¼Œé»˜è®¤ä¸ºå…¨éƒ¨ </li><li>readline()ï¼šè¿”å›ä¸€è¡Œ </li><li>readlines()ï¼šç”¨åˆ—è¡¨è¿”å›å…¨éƒ¨è¡Œ </li><li>getcode()ï¼šè¿”å›çŠ¶æ€ç ï¼Œ<code>resp.getcode()</code>ç­‰ä»·äº <code>resp.status</code> </li><li>getheaders()ï¼šè¿”å›å“åº”å¤´</li></ol></li></ul><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> urllib <span class="token keyword">import</span> requesturl<span class="token operator">=</span><span class="token string">"http://www.baidu.com"</span>resp<span class="token operator">=</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œä¸Šé¢çš„ç¨‹åºï¼Œå°±ä¼šæ‰“å°å‡ºç™¾åº¦é¦–é¡µçš„htmlæºä»£ç ï¼Œè§ä¸‹å›¾ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593685333801.png"></p><h2 id="request-urlretrieveå‡½æ•°"><a href="#request-urlretrieveå‡½æ•°" class="headerlink" title="request.urlretrieveå‡½æ•°"></a>request.urlretrieveå‡½æ•°</h2><p>è¿™ä¸ªæ–‡ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ç½‘é¡µä¸Šçš„æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œå°±æ¯”å¦‚ä¿å­˜ç™¾åº¦é¦–é¡µï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> urllib <span class="token keyword">import</span> requesturl<span class="token operator">=</span><span class="token string">"http://www.baidu.com"</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token string">'baidu.html'</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œä»£ç åï¼Œå°±ä¼šåœ¨ä»£ç æ–‡ä»¶åŒç›®å½•ä¸‹ç”Ÿæˆæˆ‘ä»¬æ‰€å‘½åçš„æ–‡ä»¶ï¼Œå¦‚å›¾ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593685309150.png"><br>åŒç†ï¼Œä¹Ÿå¯ä»¥ç”¨æ­¤æ–¹æ³•ä¸‹è½½å›¾ç‰‡ï¼Œä»¥ä¸‹è½½ä¸€å¼ ç‹è€…è£è€€éŸ©ä¿¡çš„å›¾ç‰‡ä¸ºä¾‹ï¼š</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> urllib <span class="token keyword">import</span> request<span class="token comment" spellcheck="true">#å›¾ç‰‡é“¾æ¥åªéœ€åœ¨ç½‘é¡µä¸­é¼ æ ‡å³é”®é€‰æ‹©å¤åˆ¶å›¾åƒé“¾æ¥å³å¯</span>url<span class="token operator">=</span><span class="token string">"https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1107967462,1249145194&amp;fm=26&amp;gp=0.jpg"</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token string">"éŸ©ä¿¡.jpg"</span><span class="token punctuation">)</span></code></pre><p>è¿è¡Œåï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°æ‰€ä¸‹è½½çš„å›¾ç‰‡ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593685278665.png"><br>æ‰“å¼€çœ‹ä¸€ä¸‹ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593685038035.jpg#pic_centor" alt="Alt"></p><h2 id="parse-urlencodeå‡½æ•°å’Œparse-parse-qså‡½æ•°"><a href="#parse-urlencodeå‡½æ•°å’Œparse-parse-qså‡½æ•°" class="headerlink" title="parse.urlencodeå‡½æ•°å’Œparse.parse_qså‡½æ•°"></a>parse.urlencodeå‡½æ•°å’Œparse.parse_qså‡½æ•°</h2><p>ç”¨æµè§ˆå™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœ url ä¸­åŒ…å«äº†ä¸­æ–‡æˆ–è€…å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬è¿›è¡Œç¼–ç ã€‚è€Œå¦‚æœä½¿ç”¨ä»£ç å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨çš„è¿›è¡Œç¼–ç ï¼Œè¿™æ—¶å€™å°±åº”è¯¥ä½¿ç”¨ urlencode å‡½æ•°æ¥å®ç°ã€‚urlencode å¯ä»¥æŠŠå­—å…¸æ•°æ®è½¬æ¢ä¸º URL ç¼–ç çš„æ•°æ®ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import parsedic1 = &#123;'name': 'å¼ ä¸‰','age' : '18','slogan' : "Hello world"&#125;dic2=parse.urlencode(dic1)print(dic2)#è¾“å‡ºå¦‚ä¸‹ï¼šname=%E5%BC%A0%E4%B8%89&age=18&slogan=Hello+world</code></pre><p>å¦‚æœä¸ç»è¿‡ç¼–ç ï¼Œå°±ç”¨urlopenæ–¹æ³•çš„è¯ï¼Œä¼šæŠ¥é”™ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parseresp = request.urlopen('http://www.baidu.com/s?wd=åˆ˜å¾·å')#æŠ¥é”™å¦‚ä¸‹ï¼šUnicodeEncodeError: 'ascii' codec can't encode characters in position 30-32: ordinal not in range(128)</code></pre><p>ç¼–ç ä¹‹åå°±å¯ä»¥äº†ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parseparms = &#123;'wd':'åˆ˜å¾·å'&#125;url = 'http://www.baidu.com/s'query_string = parse.urlencode(parms)print(query_string)url = url+'?'+query_stringresp = request.urlopen(url)print(resp.getcode())#è¾“å‡ºå¦‚ä¸‹ï¼šwd=%E5%88%98%E5%BE%B7%E5%8D%8E200</code></pre><p>parse.parse_qså‡½æ•°å°±æ˜¯å°†ç¼–ç åçš„æ•°æ®å†è½¬å˜å›æ¥çš„å‡½æ•°ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import parsedic1 = &#123;'name': 'å¼ ä¸‰','age' : '18','slogan' : "Hello world"&#125;dic2=parse.urlencode(dic1)print(dic2)print(parse.parse_qs(dic2))#è¾“å‡ºå¦‚ä¸‹ï¼šname=%E5%BC%A0%E4%B8%89&age=18&slogan=Hello+world&#123;'name': ['å¼ ä¸‰'], 'age': ['18'], 'slogan': ['Hello world']&#125;#æ³¨æ„è¿”å›çš„æ•°æ®ç±»å‹</code></pre><h2 id="parse-urlparse-å’Œ-parse-urlsplit-å‡½æ•°"><a href="#parse-urlparse-å’Œ-parse-urlsplit-å‡½æ•°" class="headerlink" title="parse.urlparse å’Œ parse.urlsplit å‡½æ•°"></a>parse.urlparse å’Œ parse.urlsplit å‡½æ•°</h2><p>æœ‰æ—¶å€™æ‹¿åˆ°ä¸€ä¸ª urlï¼Œæƒ³è¦å¯¹è¿™ä¸ª url ä¸­çš„å„ä¸ªç»„æˆéƒ¨åˆ†è¿›è¡Œåˆ†å‰²ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨<br>urlparse æˆ–è€…æ˜¯ urlsplit æ¥è¿›è¡Œåˆ†å‰²ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parseurl = 'http://www.baidu.com/s?username=zhiliao'result1 = parse.urlsplit(url)result2 = parse.urlparse(url)print(result1)print(result2)</code></pre><p>ç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593771183471.jpg"><br>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼šurlparse å’Œ urlsplit åŸºæœ¬ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å”¯ä¸€ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œurlparse é‡Œé¢å¤šäº†ä¸€ä¸ª params å±æ€§ï¼Œè€Œ urlsplit æ²¡æœ‰è¿™ä¸ª params å±æ€§ã€‚å¦‚æœå°†ä¸Šé¢ä»£ç çš„urlæ¢ä¸€ä¸‹å°±èƒ½çœ‹å‡ºåŒºåˆ«ï¼š</p><pre class=" language-py"><code class="language-py">from urllib import request,parseurl = 'http://www.baidu.com/s;hello?wd=python&username=abc#1'result1 = parse.urlsplit(url)result2 = parse.urlparse(url)print(result1)print(result2)</code></pre><p>ç»“æœï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593773675938.jpg"><br>ä¸è¿‡paramså±æ€§å¾ˆå°‘ç”¨åˆ°ï¼Œæ‰€ä»¥è¿™ä¸¤ç§æ–¹æ³•åŸºæœ¬å¯ä»¥è§†ä¸ºç›¸åŒ</p><h2 id="ProxyHandler-å¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰"><a href="#ProxyHandler-å¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰" class="headerlink" title="ProxyHandler å¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰"></a>ProxyHandler å¤„ç†å™¨ï¼ˆä»£ç†è®¾ç½®ï¼‰</h2><p>å¾ˆå¤šç½‘ç«™ä¼šæ£€æµ‹æŸä¸€æ®µæ—¶é—´æŸä¸ª IP çš„è®¿é—®æ¬¡æ•°(é€šè¿‡æµé‡ç»Ÿè®¡ï¼Œç³»ç»Ÿæ—¥å¿—ç­‰)ï¼Œå¦‚æœè®¿é—®æ¬¡æ•°å¤šçš„ä¸åƒæ­£å¸¸äººï¼Œå®ƒä¼šç¦æ­¢è¿™ä¸ª IP çš„è®¿é—®ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›ä»£ç†æœåŠ¡å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ¢ä¸€ä¸ªä»£ç†ï¼Œå°±ç®— IP è¢«ç¦æ­¢ï¼Œä¾ç„¶å¯ä»¥æ¢ä¸ª IP ç»§ç»­çˆ¬å–ã€‚urllib ä¸­é€šè¿‡ ProxyHandler æ¥è®¾ç½®ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸‹é¢ä»£ç è¯´æ˜å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰ openeræ¥ä½¿ç”¨ä»£ç†ï¼š</p><pre class=" language-py"><code class="language-py">import urlliburl = 'http://httpbin.org/ip'headers = &#123;'User-Agent':"Mozilla/5.0 (Macintosh; U; Mac OS X Mach-O; enUS; rv:2.0a) Gecko/20040614 Firefox/3.0.0 "&#125;req = urllib.request.Request(url,headers=headers)resp = urllib.request.urlopen(req,timeout = 5)print(resp.read().decode())handler = urllib.request.ProxyHandler(&#123;'http':'163.204.240.95:9999'&#125;)opener = urllib.request.build_opener(handler)resp = opener.open(url)print(resp.read().decode())</code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1593787948833.jpg"><br>å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬çš„å‘ç›®æ ‡æœåŠ¡å™¨å‘é€è¯·æ±‚çš„ipåœ°å€å·²ç»å˜äº†ï¼Œè¿™æ ·å°±èƒ½æœ‰æ•ˆé˜²æ­¢ç›®æ ‡æœåŠ¡å™¨å°æˆ‘ä»¬ipè€Œå¯¼è‡´çˆ¬è™«æ— æ³•å®Œæ•´è¿è¡Œã€‚</p><blockquote><p>ps:è¿™ä¸ªç½‘å€ï¼š<a href="http://httpbin.org/ip%EF%BC%8C%E8%83%BD%E5%B8%AE%E6%88%91%E4%BB%AC%E5%BF%AB%E9%80%9F%E6%9F%A5%E8%AF%A2%E6%88%91%E4%BB%AC%E7%9A%84ip%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BF%9D%E5%AD%98%E4%B8%8B%E6%9D%A5%E4%BD%BF%E7%94%A8%E5%93%A6">http://httpbin.org/ipï¼Œèƒ½å¸®æˆ‘ä»¬å¿«é€ŸæŸ¥è¯¢æˆ‘ä»¬çš„ipåœ°å€ï¼Œå¯ä»¥ä¿å­˜ä¸‹æ¥ä½¿ç”¨å“¦</a><br>å¸¸è§çš„ä»£ç†è·å–å¯ä»¥ç‚¹<a href="http://www.kuaidaili.com/">è¿™é‡Œ</a>å»çœ‹çœ‹ï¼Œå¯ä»¥ä½¿ç”¨å…è´¹çš„ä»£ç†ï¼Œå½“ç„¶ä½“éªŒè‚¯å®šæ²¡æœ‰ä»˜è´¹çš„ä»£ç†æ¥å¾—å¥½ã€‚</p></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å°æ€»ç»“ä¸€ä¸‹ï¼Œç”¨urllibåº“åŸºæœ¬ä¸Šå°±å¯ä»¥å†™ä¸€äº›æ¯”è¾ƒç®€å•çš„çˆ¬è™«äº†ï¼Œä½†è¿™é‡Œæˆ‘ä»¬æƒ³è±¡ä¸­çš„é‚£ç§å¼ºå¤§çš„çˆ¬è™«è¿˜æ˜¯æœ‰äº›å·®è·ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»§ç»­å­¦ä¹ å‘€ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonçˆ¬è™«ï¼ˆ1ï¼‰â€”â€”å‰ç½®çŸ¥è¯†</title>
      <link href="2020/07/02/python-spyder-1/"/>
      <url>2020/07/02/python-spyder-1/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯çˆ¬è™«"><a href="#ä»€ä¹ˆæ˜¯çˆ¬è™«" class="headerlink" title="ä»€ä¹ˆæ˜¯çˆ¬è™«"></a>ä»€ä¹ˆæ˜¯çˆ¬è™«</h3><ul><li>é€šä¿—ç†è§£ï¼šçˆ¬è™«æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿäººç±»è¯·æ±‚ç½‘ç«™è¡Œä¸ºçš„ç¨‹åºã€‚å¯ä»¥è‡ªåŠ¨è¯·æ±‚ç½‘é¡µã€å¹¶æ•°æ®æŠ“å– ä¸‹æ¥ï¼Œç„¶åä½¿ç”¨ä¸€å®šçš„è§„åˆ™æå–æœ‰ä»·å€¼çš„æ•°æ®ã€‚</li><li>ä¸“ä¸šä»‹ç»å¯å‚è€ƒï¼š<a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/5162711?fr=aladdin">ç™¾åº¦ç™¾ç§‘</a><h3 id="ä»€ä¹ˆæ˜¯-http-å’Œ-https-åè®®"><a href="#ä»€ä¹ˆæ˜¯-http-å’Œ-https-åè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯ http å’Œ https åè®®"></a>ä»€ä¹ˆæ˜¯ http å’Œ https åè®®</h3></li><li>HTTP åè®®ï¼šå…¨ç§°æ˜¯ HyperText Transfer Protocolï¼Œä¸­æ–‡æ„æ€æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œ æ˜¯ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶ HTML é¡µé¢çš„æ–¹æ³•ã€‚æœåŠ¡å™¨ç«¯å£å·æ˜¯ 80 ç«¯å£ã€‚</li><li>HTTPS åè®®ï¼šæ˜¯ HTTP åè®®çš„åŠ å¯†ç‰ˆæœ¬ï¼Œåœ¨ HTTP ä¸‹åŠ å…¥äº† SSL å±‚ã€‚ï¼ˆæ•°æ®ä¼ è¾“æ›´åŠ å®‰ å…¨ï¼‰æœåŠ¡å™¨ç«¯å£å·æ˜¯ 443 ç«¯å£ã€‚<h3 id="åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ª-http-è¯·æ±‚çš„è¿‡ç¨‹"><a href="#åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ª-http-è¯·æ±‚çš„è¿‡ç¨‹" class="headerlink" title="åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ª http è¯·æ±‚çš„è¿‡ç¨‹"></a>åœ¨æµè§ˆå™¨ä¸­å‘é€ä¸€ä¸ª http è¯·æ±‚çš„è¿‡ç¨‹</h3></li></ul><ol><li>å½“ç”¨æˆ·åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥ä¸€ä¸ª URL å¹¶æŒ‰å›è½¦é”®ä¹‹åï¼Œæµè§ˆå™¨ä¼šå‘ HTTP æœåŠ¡å™¨ å‘é€ HTTP è¯·æ±‚ã€‚HTTP è¯·æ±‚ä¸»è¦åˆ†ä¸ºâ€œGetâ€å’Œâ€œPostâ€ä¸¤ç§æ–¹æ³•ã€‚ </li><li>å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è¾“å…¥ URL <a href="http://www.baidu.com/">http://www.baidu.com</a> çš„æ—¶å€™ï¼Œæµè§ˆå™¨å‘é€ä¸€ä¸ª Request è¯· æ±‚å»è·å– <a href="http://www.baidu.com/">http://www.baidu.com</a> çš„ html æ–‡ä»¶ï¼ŒæœåŠ¡å™¨æŠŠ Response æ–‡ä»¶å¯¹è±¡å‘é€å›ç»™ æµè§ˆå™¨ã€‚</li><li>æµè§ˆå™¨åˆ†æ Response ä¸­çš„ HTMLï¼Œå‘ç°å…¶ä¸­å¼•ç”¨äº†å¾ˆå¤šå…¶ä»–æ–‡ä»¶ï¼Œæ¯”å¦‚ Images æ–‡ä»¶ï¼Œ CSS æ–‡ä»¶ï¼ŒJS æ–‡ä»¶ã€‚ æµè§ˆå™¨ä¼šè‡ªåŠ¨å†æ¬¡å‘é€ Request å»è·å–å›¾ç‰‡ï¼ŒCSS æ–‡ä»¶ï¼Œæˆ–è€… JS æ–‡ä»¶ã€‚ </li><li>å½“æ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¸‹è½½æˆåŠŸåï¼Œç½‘é¡µä¼šæ ¹æ® HTML è¯­æ³•ç»“æ„ï¼Œå®Œæ•´çš„æ˜¾ç¤ºå‡ºæ¥äº†ã€‚<h3 id="url-è¯¦è§£"><a href="#url-è¯¦è§£" class="headerlink" title="url è¯¦è§£"></a>url è¯¦è§£</h3>URL æ˜¯ Uniform Resource Locator çš„ç®€å†™ï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚ä¸€ä¸ª URL ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š scheme://host:port/path/?query-string=xxx&amp;query-string=xxx#anchor </li></ol><ul><li><strong>scheme</strong>ï¼šä»£è¡¨çš„æ˜¯è®¿é—®çš„åè®®ï¼Œä¸€èˆ¬ä¸º http æˆ–è€… https ä»¥åŠ ftp ç­‰ã€‚ </li><li><strong>host</strong>ï¼šä¸»æœºåï¼ŒåŸŸåï¼Œæ¯”å¦‚ <a href="http://www.baidu.com./">www.baidu.comã€‚</a> </li><li><strong>port</strong>ï¼šç«¯å£å·ã€‚å½“ä½ è®¿é—®ä¸€ä¸ªç½‘ç«™çš„æ—¶å€™ï¼Œæµè§ˆå™¨é»˜è®¤ä½¿ç”¨ 80 ç«¯å£ã€‚ </li><li><strong>path</strong>ï¼šæŸ¥æ‰¾è·¯å¾„ã€‚æ¯”å¦‚ï¼š<a href="http://www.jianshu.com/trending/now%EF%BC%8C%E5%90%8E%E9%9D%A2%E7%9A%84">www.jianshu.com/trending/nowï¼Œåé¢çš„</a> trending/now å°±æ˜¯ pathã€‚ </li><li><strong>query-string</strong>ï¼šæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š<a href="http://www.baidu.com/s?wd=python%EF%BC%8C%E5%90%8E%E9%9D%A2%E7%9A%84">www.baidu.com/s?wd=pythonï¼Œåé¢çš„</a> wd=python å°±æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ </li><li><strong>anchor</strong>ï¼šé”šç‚¹ï¼Œåå°ä¸€èˆ¬ä¸ç”¨ç®¡ï¼Œå‰ç«¯ç”¨æ¥åšé¡µé¢å®šä½çš„ã€‚(å°±ç›¸å½“äºä¸€ä¸ªé¡µé¢ä¸­æœ‰ç›® å½•ï¼Œç›®å½•çš„è·³è½¬å°±æ˜¯é”šç‚¹çš„ä½œç”¨) åœ¨æµè§ˆå™¨ä¸­è¯·æ±‚ä¸€ä¸ª urlï¼Œæµè§ˆå™¨ä¼šå¯¹è¿™ä¸ª url è¿›è¡Œä¸€ä¸ªç¼–ç ã€‚é™¤è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œéƒ¨åˆ†ç¬¦å· å¤–ï¼Œå…¶ä»–çš„å…¨éƒ¨ä½¿ç”¨ç™¾åˆ†å·+åå…­è¿›åˆ¶ç å€¼è¿›è¡Œç¼–ç ã€‚<h3 id="å¸¸è§è¯·æ±‚æ–¹æ³•"><a href="#å¸¸è§è¯·æ±‚æ–¹æ³•" class="headerlink" title="å¸¸è§è¯·æ±‚æ–¹æ³•"></a>å¸¸è§è¯·æ±‚æ–¹æ³•</h3>åœ¨ Http åè®®ä¸­ï¼Œå®šä¹‰äº†å…«ç§è¯·æ±‚æ–¹æ³•ã€‚è¿™é‡Œä»‹ç»ä¸¤ç§å¸¸ç”¨çš„è¯·æ±‚æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ get è¯·æ±‚å’Œ post è¯·æ±‚ã€‚ </li><li><strong>get è¯·æ±‚</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªä»æœåŠ¡å™¨è·å–æ•°æ®ä¸‹æ¥ï¼Œå¹¶ä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿä»»ä½•å½±å“ çš„æ—¶å€™ä¼šä½¿ç”¨ get è¯·æ±‚ã€‚ </li><li><strong>post è¯·æ±‚</strong>ï¼šå‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼ˆç™»å½•ï¼‰ã€ä¸Šä¼ æ–‡ä»¶ç­‰ï¼Œä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„æ—¶å€™ ä¼šä½¿ç”¨ post è¯·æ±‚ã€‚ ä»¥ä¸Šæ˜¯åœ¨ç½‘ç«™å¼€å‘ä¸­å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•ã€‚å¹¶ä¸”ä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¼šéµå¾ªä½¿ç”¨çš„åŸåˆ™ã€‚ä½†æ˜¯æœ‰çš„ ç½‘ç«™å’ŒæœåŠ¡å™¨ä¸ºäº†åšåçˆ¬è™«æœºåˆ¶ï¼Œä¹Ÿç»å¸¸ä¼šä¸æŒ‰å¸¸ç†å‡ºç‰Œï¼Œæœ‰å¯èƒ½ä¸€ä¸ªåº”è¯¥ä½¿ç”¨ get æ–¹ æ³•çš„è¯·æ±‚å°±ä¸€å®šè¦æ”¹æˆ post è¯·æ±‚ï¼Œè¿™ä¸ªè¦è§†æƒ…å†µè€Œå®šã€‚</li><li>æ›´å¤šçš„è¯·æ±‚ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://www.runoob.com/http/http-methods.html">èœé¸Ÿæ•™ç¨‹</a><h3 id="å¸¸è§å“åº”çŠ¶æ€ç "><a href="#å¸¸è§å“åº”çŠ¶æ€ç " class="headerlink" title="å¸¸è§å“åº”çŠ¶æ€ç "></a>å¸¸è§å“åº”çŠ¶æ€ç </h3></li><li>200ï¼šè¯·æ±‚æ­£å¸¸ï¼ŒæœåŠ¡å™¨æ­£å¸¸çš„è¿”å›æ•°æ®ã€‚ </li><li>301ï¼šæ°¸ä¹…é‡å®šå‘ã€‚æ¯”å¦‚åœ¨è®¿é—® <a href="http://www.jingdong.com/">www.jingdong.com</a> çš„æ—¶å€™ä¼šé‡å®šå‘åˆ° <a href="http://www.jd.com./">www.jd.comã€‚</a></li><li>302ï¼šä¸´æ—¶é‡å®šå‘ã€‚æ¯”å¦‚åœ¨è®¿é—®ä¸€ä¸ªéœ€è¦ç™»å½•çš„é¡µé¢çš„æ—¶å€™ï¼Œè€Œæ­¤æ—¶æ²¡æœ‰ç™»å½•ï¼Œé‚£ä¹ˆå°± ä¼šé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚ </li><li>400ï¼šè¯·æ±‚çš„ url åœ¨æœåŠ¡å™¨ä¸Šæ‰¾ä¸åˆ°ã€‚æ¢å¥è¯è¯´å°±æ˜¯è¯·æ±‚ url é”™è¯¯ã€‚ </li><li>403ï¼šæœåŠ¡å™¨æ‹’ç»è®¿é—®ï¼Œæƒé™ä¸å¤Ÿã€‚ </li><li>500ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚å¯èƒ½æ˜¯æœåŠ¡å™¨å‡ºç° bug äº†ã€‚<h3 id="è¯·æ±‚å¤´å¸¸è§å‚æ•°"><a href="#è¯·æ±‚å¤´å¸¸è§å‚æ•°" class="headerlink" title="è¯·æ±‚å¤´å¸¸è§å‚æ•°"></a>è¯·æ±‚å¤´å¸¸è§å‚æ•°</h3>åœ¨ http åè®®ä¸­ï¼Œå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ•°æ®åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŠŠæ•°æ®æ”¾åœ¨ url ä¸­ï¼Œç¬¬ äºŒä¸ªæ˜¯æŠŠæ•°æ®æ”¾åœ¨ body ä¸­ï¼ˆåœ¨ post è¯·æ±‚ä¸­ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå°±æ˜¯æŠŠæ•°æ®æ”¾åœ¨ head ä¸­ã€‚ è¿™é‡Œä»‹ç»åœ¨ç½‘ç»œçˆ¬è™«ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€äº›è¯·æ±‚å¤´å‚æ•°ï¼š </li><li><strong>User-Agent</strong>ï¼šæµè§ˆå™¨åç§°ã€‚è¿™ä¸ªåœ¨ç½‘ç»œçˆ¬è™«ä¸­ç»å¸¸ä¼šè¢«ä½¿ç”¨åˆ°ã€‚è¯·æ±‚ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œ æœåŠ¡å™¨é€šè¿‡è¿™ä¸ªå‚æ•°å°±å¯ä»¥çŸ¥é“è¿™ä¸ªè¯·æ±‚æ˜¯ç”±å“ªç§æµè§ˆå™¨å‘é€çš„ã€‚å¦‚æœæˆ‘ä»¬æ˜¯é€šè¿‡çˆ¬è™« å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ User-Agent å°±æ˜¯ Pythonï¼Œè¿™å¯¹äºé‚£äº›æœ‰åçˆ¬è™«æœºåˆ¶çš„ç½‘ç«™æ¥è¯´ï¼Œ å¯ä»¥è½»æ˜“çš„åˆ¤æ–­ä½ è¿™ä¸ªè¯·æ±‚æ˜¯çˆ¬è™«ã€‚å› æ­¤æˆ‘ä»¬è¦ç»å¸¸è®¾ç½®è¿™ä¸ªå€¼ä¸ºä¸€äº›æµè§ˆå™¨çš„å€¼ï¼Œæ¥ ä¼ªè£…æˆ‘ä»¬çš„çˆ¬è™«ã€‚ </li><li><strong>Referer</strong>ï¼šè¡¨æ˜å½“å‰è¿™ä¸ªè¯·æ±‚æ˜¯ä»å“ªä¸ª url è¿‡æ¥çš„ã€‚è¿™ä¸ªä¸€èˆ¬ä¹Ÿå¯ä»¥ç”¨æ¥åšåçˆ¬è™«æŠ€æœ¯ã€‚ å¦‚æœä¸æ˜¯ä»æŒ‡å®šé¡µé¢è¿‡æ¥çš„ï¼Œé‚£ä¹ˆå°±ä¸åšç›¸å…³çš„å“åº”ã€‚ </li><li><strong>Cookie</strong>ï¼šhttp åè®®æ˜¯æ— çŠ¶æ€çš„ã€‚ä¹Ÿå°±æ˜¯åŒä¸€ä¸ªäººå‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ²¡æœ‰èƒ½åŠ›çŸ¥é“ è¿™ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€ä¸ªäººã€‚å› æ­¤è¿™æ—¶å€™å°±ç”¨ cookie æ¥åšæ ‡è¯†ã€‚ä¸€èˆ¬å¦‚æœæƒ³è¦åšç™» å½•åæ‰èƒ½è®¿é—®çš„ç½‘ç«™ï¼Œé‚£ä¹ˆå°±éœ€è¦å‘é€ cookie ä¿¡æ¯äº†ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonå­¦ä¹ ç¬”è®°â€”â€”numpyï¼ˆ2ï¼‰</title>
      <link href="2020/06/16/numpy-2/"/>
      <url>2020/06/16/numpy-2/</url>
      
        <content type="html"><![CDATA[<p>ç»§ç»­æ¥å­¦ä¹ numpyï¼š</p><h2 id="ä¸€ã€ç´¢å¼•å’Œåˆ‡ç‰‡"><a href="#ä¸€ã€ç´¢å¼•å’Œåˆ‡ç‰‡" class="headerlink" title="ä¸€ã€ç´¢å¼•å’Œåˆ‡ç‰‡"></a>ä¸€ã€ç´¢å¼•å’Œåˆ‡ç‰‡</h2><p>å‰é¢å­¦äº†ç”¨numpyæ¥åˆ›å»ºå„ç§å„æ ·çš„æ•°ç»„ï¼Œè¿™äº›æ•°ç»„éƒ½æ˜¯<code>ndarray</code>å¯¹è±¡ï¼Œéƒ½æ”¯æŒç´¢å¼•å’Œåˆ‡ç‰‡æ“ä½œã€‚<code>ndarray</code>å¯¹è±¡çš„ç´¢å¼•ä¸pythonä¸­çš„<code>list</code>åŸºæœ¬ä¸€è‡´ï¼š</p><pre class=" language-py"><code class="language-py">>>> import numpy as np>>> a=np.arange(1,6,1)>>> aarray([1, 2, 3, 4, 5])>>> a[0]#ä¹Ÿæ˜¯ä»0å¼€å§‹ç´¢å¼•1>>> a[4]5#å†çœ‹äºŒç»´æ•°ç»„ç´¢å¼•>>> aa=np.array([[1,2,3],[4,5,6],[7,8,9]])>>> aaarray([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]]) >>> aa[0,0]1>>> aa[2,2]9</code></pre><p>æ›´é«˜ç»´åº¦æ•°ç»„å…ƒç´ çš„ç´¢å¼•å’Œä¸Šè¿°æ–¹å¼å¤§åŒå°å¼‚ï¼Œå†æ¥çœ‹åˆ‡ç‰‡ï¼Œå…ˆç”¨å’Œåˆ—è¡¨ä¸€æ ·çš„æ–¹æ³•æ¥è¯•è¯•ï¼š</p><pre class=" language-py"><code class="language-py">>>> b=np.arange(0,10,1)>>> barray([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])>>> b[4:]array([4, 5, 6, 7, 8, 9])>>> b[0:4]array([0, 1, 2, 3])>>> b[5:-1]array([5, 6, 7, 8])>>> b[0:5:2]array([0, 2, 4])</code></pre><p>å¯ä»¥å‘ç°ï¼Œè¿™ç§æ–¹æ³•æ˜¯å®Œå…¨å¯è¡Œçš„ï¼Œè¿˜å¯ä»¥åˆ©ç”¨pythonå†…ç½®å‡½æ•°<code>slice</code>è¿›è¡Œåˆ‡ç‰‡ï¼š</p><pre class=" language-py"><code class="language-py">>>> b[slice(1,8,2)]#å–å‡ºbä¸­ä»ç´¢å¼•1å¼€å§‹åˆ°ç´¢å¼•8çš„å…ƒç´ ï¼Œé—´éš”ä¸º2array([1, 3, 5, 7])</code></pre><p>çœ‹å®Œäº†ä¸€ç»´æ•°ç»„ï¼Œå†æ¥çœ‹çœ‹äºŒç»´æ•°ç»„å…ƒç´ çš„åˆ‡ç‰‡,äºŒç»´æ•°ç»„é‡Œè¾¹æˆ‘ä»¬ç»å¸¸æœ‰å–ä¸€æ•´åˆ—æˆ–è€…ä¸€æ•´è¡Œçš„éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨<code>...</code>å’Œ<code>:</code>æ¥è¿›è¡Œåˆ‡ç‰‡ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><pre class=" language-py"><code class="language-py">>>> bb=np.array([[1,2,3],[4,5,6],[7,8,9]])>>> bbarray([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]])>>> bb[...,0]#å–æ•°ç»„bbé‡Œç¬¬ä¸€åˆ—å…ƒç´ array([1, 4, 7])>>> bb[:,0]#è·Ÿbb[...,0]ä½œç”¨ç›¸åŒarray([1, 4, 7])>>> bb[1,...]#å–æ•°ç»„bbé‡Œç¬¬ä¸€è¡Œå…ƒç´ array([4, 5, 6])>>> bb[1,:]#è·Ÿbb[1,...]ä½œç”¨ç›¸åŒarray([4, 5, 6])#è¿˜å¯ä»¥å–å‡ åˆ—æˆ–è€…å‡ è¡Œå…ƒç´ >>> bb[:,0:2]#å–ç¬¬0åˆ—å’Œç¬¬1åˆ—å…¨éƒ¨å…ƒç´ array([[1, 2],       [4, 5],       [7, 8]])>>> bb[0:2,:]#å–ç¬¬0è¡Œå’Œç¬¬1è¡Œçš„å…¨éƒ¨å…ƒç´ array([[1, 2, 3],       [4, 5, 6]])>>> bb[0:2,1:3]#å–ç¬¬0è¡Œå’Œç¬¬1è¡Œä¸Šç¬¬1åˆ—å’Œç¬¬2åˆ—çš„å…ƒç´ array([[2, 3],       [5, 6]])>>> bb[:]#å–å…¨éƒ¨å…ƒç´ array([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]])</code></pre><h2 id="äºŒã€æ•°ç»„å˜å½¢"><a href="#äºŒã€æ•°ç»„å˜å½¢" class="headerlink" title="äºŒã€æ•°ç»„å˜å½¢"></a>äºŒã€æ•°ç»„å˜å½¢</h2><p>numpyé‡Œé¢çš„æ•°ç»„ï¼Œè¿˜å¯ä»¥è¿›è¡Œå˜å½¢æ“ä½œï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ“ä½œï¼š</p><h3 id="1-æ”¹å˜æ•°ç»„å½¢çŠ¶"><a href="#1-æ”¹å˜æ•°ç»„å½¢çŠ¶" class="headerlink" title="1.æ”¹å˜æ•°ç»„å½¢çŠ¶"></a>1.æ”¹å˜æ•°ç»„å½¢çŠ¶</h3><p>åœ¨numpyä¸­ï¼Œå°è£…äº†reshapeå‡½æ•°æ¥å¯¹æ•°ç»„è¿›è¡Œå˜å½¢æ“ä½œï¼Œå®ƒä¸€å…±æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š<code>numpy.reshape(arr, newshape, order=&#39;C&#39;)</code>ï¼Œå„ä¸ªå‚æ•°çš„æè¿°å¦‚ä¸‹ï¼š<br>|å‚æ•°|æè¿°|<br>|:-:|:-:|<br>|arr|éœ€è¦ä¿®æ”¹å½¢çŠ¶çš„æ•°ç»„|<br>|reshape|ä¿®æ”¹åæ•°ç»„çš„å½¢çŠ¶ï¼Œä¼ å…¥çš„åº”è¯¥æ˜¯æ•´æ•°æˆ–è€…æ•´æ•°æ•°ç»„,è€Œä¸”æ€»çš„å…ƒç´ æ•°é‡åº”è¯¥ä¸arrä¸€è‡´|<br>|order|â€™Câ€™ â€“ æŒ‰è¡Œï¼Œâ€™Fâ€™ â€“ æŒ‰åˆ—ï¼Œâ€™Aâ€™ â€“ åŸé¡ºåºï¼Œâ€™kâ€™ â€“ å…ƒç´ åœ¨å†…å­˜ä¸­çš„å‡ºç°é¡ºåº|<br>æ¥çœ‹ä¸€ä¸‹ä¾‹å­ï¼š</p><pre class=" language-py"><code class="language-py">>>> a1=np.arange(1,10,1)>>> a1array([1, 2, 3, 4, 5, 6, 7, 8, 9])>>> a2=np.reshape(a1,[3,3])>>> a2array([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]])>>> a3=np.reshape(a1,[3,3],order='F')>>> a3array([[1, 4, 7],       [2, 5, 8],       [3, 6, 9]])>>> a4=np.reshape(a1,[3,3],order='A')>>> a4array([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]])</code></pre><p>ä¹Ÿå¯ä»¥ä½¿ç”¨a1.reshape()æ¥è¿›è¡Œæ•°ç»„å˜å½¢ï¼Œè·Ÿä¸Šé¢çš„æ•ˆæœä¸€æ ·</p><pre class=" language-py"><code class="language-py">>>> a6=a1.reshape([3,3])>>> a6array([[1, 2, 3],       [4, 5, 6],       [7, 8, 9]])</code></pre><h3 id="2-è½¬ç½®"><a href="#2-è½¬ç½®" class="headerlink" title="2.è½¬ç½®"></a>2.è½¬ç½®</h3><p>çŸ©é˜µè½¬ç½®æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li><strong>transposeå‡½æ•°</strong></li><li><strong>ndarray.T</strong><br>äºŒè€…åŸºæœ¬ä¸Šç­‰ä»·ï¼Œæ¥çœ‹ä¸ªä¾‹å­ï¼š<pre class=" language-py"><code class="language-py">>>> b1=np.arange(1,9,1).reshape([2,4])>>> b1array([[1, 2, 3, 4],     [5, 6, 7, 8]])>>> b2=np.transpose(b1)>>> b2array([[1, 5],     [2, 6],     [3, 7],     [4, 8]])>>> b3=b1.T>>> b3array([[1, 5],     [2, 6],     [3, 7],     [4, 8]])</code></pre><h3 id="3-å¹¿æ’­ï¼ˆbroadcostï¼‰"><a href="#3-å¹¿æ’­ï¼ˆbroadcostï¼‰" class="headerlink" title="3.å¹¿æ’­ï¼ˆbroadcostï¼‰"></a>3.å¹¿æ’­ï¼ˆbroadcostï¼‰</h3>æˆ‘ä»¬çŸ¥é“ï¼ŒçŸ©é˜µè¿ç®—é€šå¸¸å¯¹çŸ©é˜µçš„ç»´åº¦æœ‰è¦æ±‚ï¼Œæ‰€ä»¥numpyé‡Œè¾¹ç”¨å¹¿æ’­æœºåˆ¶æ¥ä½¿çŸ©é˜µæ»¡è¶³ç»´åº¦è¦æ±‚ã€‚å½“è¿ç®—ä¸­çš„ 2 ä¸ªæ•°ç»„çš„å½¢çŠ¶ä¸åŒæ—¶ï¼Œnumpy å°†è‡ªåŠ¨è§¦å‘å¹¿æ’­æœºåˆ¶ã€‚å¦‚ï¼š<pre class=" language-py"><code class="language-py">>>> import numpy as np>>> a=np.array([[0,0,0],[1,1,1],[2,2,2],[3,3,3]])>>> aarray([[0, 0, 0],     [1, 1, 1],     [2, 2, 2],     [3, 3, 3]])>>> b=np.array([1,2,3])>>> a+barray([[1, 2, 3],     [2, 3, 4],     [3, 4, 5],     [4, 5, 6]]</code></pre>å¹¿æ’­æœºåˆ¶å†…å®¹è¾ƒå¤šï¼Œè¿™é‡Œåªç®€å•ä»‹ç»ï¼Œè¯¦ç»†å­¦ä¹ å¯å‚è€ƒ<a href="https://www.cnblogs.com/jiaxin359/p/9021726.html">è¿™ç¯‡åšå®¢</a><h2 id="ä¸‰ã€é€šç”¨å‡½æ•°"><a href="#ä¸‰ã€é€šç”¨å‡½æ•°" class="headerlink" title="ä¸‰ã€é€šç”¨å‡½æ•°"></a>ä¸‰ã€é€šç”¨å‡½æ•°</h2>é€šç”¨å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºufuncï¼Œæ˜¯ä¸€ç§åœ¨ndarrayæ•°æ®ä¸­è¿›è¡Œ<strong>é€å…ƒç´ æ“ä½œ</strong>çš„å‡½æ•°ã€‚æŸäº›ç®€å•å‡½æ•°æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡é‡æ•°å€¼ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªæ ‡é‡æ•°å€¼ï¼Œè€Œé€šç”¨å‡½æ•°å°±æ˜¯å¯¹è¿™äº›ç®€å•å‡½æ•°çš„å‘é‡åŒ–å°è£…<h3 id="3-1ä¸€å…ƒé€šç”¨å‡½æ•°"><a href="#3-1ä¸€å…ƒé€šç”¨å‡½æ•°" class="headerlink" title="3.1ä¸€å…ƒé€šç”¨å‡½æ•°"></a>3.1ä¸€å…ƒé€šç”¨å‡½æ•°</h3>æœ‰å¾ˆå¤šufuncæ˜¯ç®€å•çš„é€å…ƒç´ è½¬æ¢ï¼Œæ¯”å¦‚<code>sqrt</code>æˆ–è€…<code>exp</code>å‡½æ•°ï¼š<pre class=" language-py"><code class="language-py">>>> arr=np.arange(10)>>> arrarray([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])>>> np.sqrt(arr)array([0.        , 1.        , 1.41421356, 1.73205081, 2.        ,     2.23606798, 2.44948974, 2.64575131, 2.82842712, 3.        ])>>> np.exp(arr)array([1.00000000e+00, 2.71828183e+00, 7.38905610e+00, 2.00855369e+01,     5.45981500e+01, 1.48413159e+02, 4.03428793e+02, 1.09663316e+03,     2.98095799e+03, 8.10308393e+03])</code></pre>è¿™ç±»å‡½æ•°æˆ‘ä»¬æŠŠå®ƒç§°ä¸ºä¸€å…ƒé€šç”¨å‡½æ•°ï¼Œåœ¨è¿™é‡Œåˆ—ä¸¾ä¸€äº›å¸¸è§çš„ä¸€å…ƒé€šç”¨å‡½æ•°ï¼š<table><thead><tr><th align="center">å‡½æ•°å</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">absã€fabs</td><td align="center">é€å…ƒç´ çš„è®¡ç®—æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–è€…å¤æ•°çš„ç»å¯¹å€¼</td></tr><tr><td align="center">sqrt</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹æ ¹ï¼ˆä¸$arr^{0.5}$ç­‰ä»·ï¼‰</td></tr><tr><td align="center">square</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹ï¼ˆä¸$arr^2$ç­‰ä»·ï¼‰</td></tr><tr><td align="center">exp</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ä»¥è‡ªç„¶åº•æ•°ä¸ºåº•çš„æŒ‡æ•°å€¼$e^2$</td></tr><tr><td align="center">logã€log10ã€log2ã€log1p</td><td align="center">åˆ†åˆ«å¯¹åº”ï¼šè‡ªç„¶å¯¹æ•°ï¼ˆeä¸ºåº•ï¼‰ã€å¯¹æ•°10ä¸ºåº•ã€å¯¹æ•°2ä¸ºåº•ã€$log(1+x)$</td></tr><tr><td align="center">sign</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ç¬¦å·å€¼ï¼š1ï¼ˆè¡¨ç¤ºæ­£æ•°ï¼‰ã€0è¡¨ç¤ºæ•°å­—0ã€-1è¡¨ç¤ºå¤æ•°</td></tr><tr><td align="center">ceil</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å‘ä¸Šå–æ•´ï¼ˆå¤§äºç­‰äºç»™å®šæ•°å­—çš„æœ€å°æ•´æ•°ï¼‰</td></tr><tr><td align="center">floor</td><td align="center">è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å‘ä¸‹å–æ•´ï¼ˆå°äºç­‰äºç»™å®šæ•°å­—çš„æœ€å¤§æ•´æ•°ï¼‰</td></tr><tr><td align="center">rint</td><td align="center">å°†æ¯ä¸ªå…ƒç´ ä¿ç•™æ•´æ•°ä½ï¼Œå¹¶ä¿æŒdtype</td></tr><tr><td align="center">modf</td><td align="center">å°†æ¯ä¸ªå…ƒç´ çš„æ•´æ•°ä½å’Œå°æ•°ä½åˆ†å¼€ï¼Œå¹¶æŒ‰æ•°ç»„å½¢å¼è¿”å›</td></tr><tr><td align="center">isnan</td><td align="center">åˆ¤æ–­å„ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯NANï¼ˆä¸æ˜¯ä¸€ä¸ªæ•°å€¼ï¼‰å¹¶è¿”å›å¸ƒå°”å€¼æ•°ç»„</td></tr><tr><td align="center">isfiniteã€isinf</td><td align="center">åˆ¤æ–­æ•°ç»„ä¸­å„å…ƒç´ æ˜¯å¦æœ‰é™ã€æ˜¯å¦æ— é™ï¼Œå¹¶è¿”å›å¸ƒå°”å€¼æ•°ç»„</td></tr><tr><td align="center">cosã€coshã€sinã€sinhã€tanã€tanh</td><td align="center">å¸¸è§„çš„åŒæ›²ä¸‰è§’å‡½æ•°</td></tr><tr><td align="center">arccosã€arccoshã€arcsinã€arcsinhã€arctanã€arctanh</td><td align="center">åä¸‰è§’å‡½æ•°</td></tr><tr><td align="center">logical_not</td><td align="center">å¯¹æ•°ç»„çš„å…ƒç´ æŒ‰ä½å–åï¼ˆä¸-arrç­‰ä»·ï¼‰</td></tr></tbody></table><h3 id="3-2äºŒå…ƒé€šç”¨å‡½æ•°"><a href="#3-2äºŒå…ƒé€šç”¨å‡½æ•°" class="headerlink" title="3.2äºŒå…ƒé€šç”¨å‡½æ•°"></a>3.2äºŒå…ƒé€šç”¨å‡½æ•°</h3>è¿˜æœ‰ä¸€äº›é€šç”¨å‡½æ•°ï¼Œæ¯”å¦‚addæˆ–è€…maximumåˆ™ä¼šæ¥æ”¶ä¸¤ä¸ªæ•°ç»„å¹¶è¿”å›ä¸€ä¸ªæ•°ç»„ä½œä¸ºç»“æœï¼Œå› æ­¤æˆä¸ºäºŒå…ƒé€šç”¨å‡½æ•°ï¼Œåœ¨è¿™åˆ—ä¸¾ä¸€äº›ï¼š<table><thead><tr><th align="center">å‡½æ•°å</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">add</td><td align="center">å°†æ•°ç»„çš„å¯¹åº”å…ƒç´ ç›¸åŠ </td></tr><tr><td align="center">subtract</td><td align="center">åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­ï¼Œå°†ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­åŒ…å«çš„å…ƒç´ å»é™¤</td></tr><tr><td align="center">multiply</td><td align="center">å°†æ•°ç»„çš„å¯¹åº”å…ƒç´ ç›¸ä¹˜</td></tr><tr><td align="center">devideã€floor_devide</td><td align="center">é™¤æˆ–æ•´é™¤ï¼ˆæ”¾å¼ƒä½™æ•°ï¼‰</td></tr><tr><td align="center">power</td><td align="center">å°†ç¬¬äºŒä¸ªæ•°ç»„çš„å…ƒç´ ä½œä¸ºç¬¬ä¸€ä¸ªæ•°ç»„å¯¹åº”å…ƒç´ çš„å¹‚æ¬¡æ–¹</td></tr><tr><td align="center">maximumã€fmax</td><td align="center">é€ä¸ªå…ƒç´ è®¡ç®—æœ€å¤§å€¼ï¼Œfmaxä¼šå¿½ç•¥NaN</td></tr><tr><td align="center">minimumã€fmin</td><td align="center">é€ä¸ªå…ƒç´ è®¡ç®—æœ€å°å€¼ï¼Œfminä¼šå¿½ç•¥NaN</td></tr><tr><td align="center">mod</td><td align="center">æŒ‰å…ƒç´ çš„æ±‚æ¨¡è®¡ç®—ï¼ˆå³æ±‚é™¤æ³•çš„ä½™æ•°ï¼‰</td></tr><tr><td align="center">copysign</td><td align="center">å°†ç¬¬ä¸€ä¸ªæ•°ç»„çš„ç¬¦å·å€¼æ”¹ä¸ºç¬¬äºŒä¸ªæ•°ç»„çš„ç¬¦å·å€¼</td></tr><tr><td align="center">greaterã€greater_equalã€lessã€less_equalã€equalã€not_equal</td><td align="center">è¿›è¡Œé€ä¸ªå…ƒç´ çš„æ¯”è¾ƒï¼Œè¿”å›å¸ƒå°”å€¼æ•°ç»„ï¼ˆåˆ†åˆ«ä¸æ•°å­¦æ“ä½œç¬¦<code>&gt;,&gt;=,&lt;,&lt;=,==,!=</code>å¯¹åº”æ•ˆæœä¸€è‡´ï¼‰</td></tr><tr><td align="center">logical_andã€logical_orã€logical_xor</td><td align="center">è¿›è¡Œé€ä¸ªå…ƒç´ çš„é€»è¾‘æ“ä½œï¼Œä¸é€»è¾‘æ“ä½œ`&amp;,</td></tr></tbody></table></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonå­¦ä¹ ç¬”è®°â€”â€”numpyï¼ˆ1ï¼‰</title>
      <link href="2020/06/14/numpy-1/"/>
      <url>2020/06/14/numpy-1/</url>
      
        <content type="html"><![CDATA[<p>å­¦è¿‡pythonçš„äººåº”è¯¥éƒ½æ¥è§¦è¿‡<a href="https://baike.baidu.com/item/numpy/5678437?fr=aladdin"><strong>numpy</strong></a>è¿™ä¸ªæœ‰åçš„ç¬¬ä¸‰æ–¹åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ”¯æŒå¤§é‡çš„ç»´åº¦æ•°ç»„ä¸çŸ©é˜µè¿ç®—ï¼Œæ­¤å¤–ä¹Ÿé’ˆå¯¹æ•°ç»„è¿ç®—æä¾›å¤§é‡çš„æ•°å­¦å‡½æ•°åº“ã€‚</p><h1 id="1-å®‰è£…numpy"><a href="#1-å®‰è£…numpy" class="headerlink" title="1.å®‰è£…numpy"></a>1.å®‰è£…numpy</h1><p>å®‰è£…æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><ul><li>pipå®‰è£…ï¼šç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œé”®å…¥<code>pip install numpy</code>å³å¯ï¼Œå¦‚æœé‡åˆ°å®‰è£…é€Ÿåº¦è¿‡æ…¢çš„æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘åˆ°æ¸…åé•œåƒæºä¸‹è½½å®‰è£…ã€‚</li><li>condaå®‰è£…ï¼Œåœ¨anaconda powershellé‡Œè¾“å…¥<code>conda install numpy</code>,é€Ÿåº¦æ…¢ä¹Ÿå¯ä»¥æ¢æºã€‚<br>æˆ‘è¿™é‡Œå·²ç»å®‰è£…å¥½äº†ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š<br><img src="https://zmlzvt.coding-pages.com//post-images/1592147524509.jpg"><br>æ‰“å¼€idleéªŒè¯ä¸€ä¸‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š<pre class=" language-py"><code class="language-py">>>> import numpy as np>>> np.__version__#æ‰“å°ç‰ˆæœ¬ä¿¡æ¯'1.16.5'>>> np.ones(5)#ç”Ÿæˆå€¼å…¨ä¸º1çš„æ•°ç»„array([1., 1., 1., 1., 1.])</code></pre>æ­£ç¡®ç”Ÿæˆäº†æ•°ç»„ï¼Œè¯´æ˜numpyå®‰è£…æˆåŠŸ<h1 id="2-åŸºç¡€æ“ä½œ"><a href="#2-åŸºç¡€æ“ä½œ" class="headerlink" title="2. åŸºç¡€æ“ä½œ"></a>2. åŸºç¡€æ“ä½œ</h1><h2 id="2-1é€šè¿‡ç»´åº¦åˆ›å»ºæ•°ç»„"><a href="#2-1é€šè¿‡ç»´åº¦åˆ›å»ºæ•°ç»„" class="headerlink" title="2.1é€šè¿‡ç»´åº¦åˆ›å»ºæ•°ç»„"></a>2.1é€šè¿‡ç»´åº¦åˆ›å»ºæ•°ç»„</h2>å…ˆçœ‹ç”±æŒ‡å®šç»´åº¦æ¥åˆ›å»ºæ•°ç»„çš„æ–¹æ³•ï¼š<pre class=" language-py"><code class="language-py">>>> a=np.array([1,2,3])#åˆ›å»ºä¸€ç»´æ•°ç»„>>> aarray([1, 2, 3]ï¼‰>>> b=np.array([[1,2,3],[4,5,6]])#åˆ›å»ºäºŒç»´æ•°ç»„ï¼Œé«˜ç»´åº¦åŒç†>>> barray([[1, 2, 3],     [4, 5, 6]])>>> np.zeros([3,3])#ç”ŸæˆæŒ‡å®šç»´åº¦çš„å€¼å…¨ä¸º0çš„æ•°ç»„array([[0., 0., 0.],     [0., 0., 0.],     [0., 0., 0.]])>>> np.ones([3,3])##ç”ŸæˆæŒ‡å®šç»´åº¦çš„å€¼å…¨ä¸º1çš„æ•°ç»„array([[1., 1., 1.],     [1., 1., 1.],     [1., 1., 1.]])>>> np.empty([3,3])#ç”ŸæˆæŒ‡å®šç»´åº¦çš„å€¼ä¸ºéšæœºæ•°çš„æ•°ç»„array([[1., 1., 1.],     [1., 1., 1.],     [1., 1., 1.]])>>> np.empty_like(b)#ç”Ÿæˆå’Œbæ•°ç»„åŒç»´åº¦çš„å€¼ä¸ºéšæœºæ•°çš„æ•°ç»„array([[0, 0, 0],     [0, 0, 0]])</code></pre>åœ¨å®é™…æ“ä½œä¸­ï¼Œé€šè¿‡ç”Ÿæˆaï¼Œbæ•°ç»„çš„æ–¹å¼æ¥åˆ›å»ºé«˜ç»´åº¦æ•°ç»„æ—¶ä¼šæ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨<code>np.ones</code>æˆ–<code>np.zeros</code>æ¥ç”ŸæˆæŒ‡å®šç»´åº¦çš„æ•°ç»„ï¼Œç„¶åå¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œä¿®æ”¹ã€‚<h2 id="2-2é€šè¿‡æ•°å€¼èŒƒå›´åˆ›å»ºæ•°ç»„"><a href="#2-2é€šè¿‡æ•°å€¼èŒƒå›´åˆ›å»ºæ•°ç»„" class="headerlink" title="2.2é€šè¿‡æ•°å€¼èŒƒå›´åˆ›å»ºæ•°ç»„"></a>2.2é€šè¿‡æ•°å€¼èŒƒå›´åˆ›å»ºæ•°ç»„</h2><h3 id="2-2-1ç­‰å·®æ•°åˆ—"><a href="#2-2-1ç­‰å·®æ•°åˆ—" class="headerlink" title="2.2.1ç­‰å·®æ•°åˆ—"></a>2.2.1ç­‰å·®æ•°åˆ—</h3>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ•°å€¼èŒƒå›´æ¥åˆ›å»ºæ•°ç»„ï¼Œæ¯”å¦‚ç°åœ¨éœ€è¦ä¸€ä¸ªä»1åˆ°100çš„å…¬å·®ä¸º2çš„ç­‰å·®æ•°åˆ—ï¼Œé€šè¿‡å‰é¢çš„æ–¹æ³•ä¹Ÿå¯ä»¥åˆ›å»ºï¼ˆå…ˆç”ŸæˆæŒ‡å®šç»´åº¦çš„0æ•°ç»„ï¼Œå†åˆ©ç”¨å¾ªç¯è¿›è¡Œèµ‹å€¼ï¼‰ï¼Œè¿™æ ·ä¼šæ˜¾å¾—æ¯”è¾ƒç¹çï¼Œå¯ä»¥ä½¿ç”¨<code>arange</code>å‡½æ•°ï¼š<pre class=" language-py"><code class="language-py">#ä»¥ç”Ÿæˆ1åˆ°20çš„å…¬å·®ä¸º2çš„ç­‰å·®æ•°åˆ—ä¸ºä¾‹>>> np.arange(1,20,2)#array([ 1,  3,  5,  7,  9, 11, 13, 15, 17, 19])>>> np.arange(start=1,stop=20,step=2)#è¯¦ç»†å†™æ³•array([ 1,  3,  5,  7,  9, 11, 13, 15, 17, 19])>>> np.arange(1,20,1)array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,     18, 19])</code></pre><code>arange</code>å‡½æ•°ä¸­éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡æ˜¯èµ·å§‹ç‚¹ã€ç»ˆæ­¢ç‚¹å’Œæ­¥é•¿ï¼Œå¯ä»¥çœ‹å‡ºï¼šå³ä½¿æ­¥é•¿è®¾ç½®ä¸º1ï¼Œè¾“å‡ºçš„æ•°ç»„ä¹Ÿæ˜¯ä¸åŒ…æ‹¬ç»ˆæ­¢ç‚¹çš„ï¼Œæ‰€ä»¥<code>arange</code>å‡½æ•°çš„è¾“å…¥å¯ä»¥çœ‹åšä¸€ä¸ªå·¦é—­å³å¼€åŒºé—´ï¼Œå¦‚æœæƒ³è¦åŒ…æ‹¬ç»ˆæ­¢ç‚¹ï¼Œå¯ä»¥è®©ç»ˆæ­¢ç‚¹å¢å¤§ä¸€ä¸ªæ­¥é•¿ã€‚</li></ul><p>é™¤äº†<code>arange</code>å‡½æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>linspace</code>å‡½æ•°ä¹Ÿå¯ä»¥ç”Ÿæˆç­‰å·®æ•°åˆ—ï¼š</p><pre class=" language-py"><code class="language-py">#ä»¥ç”Ÿæˆ1åˆ°10çš„å…¬å·®ä¸º1çš„ç­‰å·®æ•°åˆ—ä¸ºä¾‹>>> np.linspace(1,10,10)array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])>>> np.linspace(start=1,stop=10,num=10)#è¯¦ç»†å†™æ³•array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])>>> np.linspace(1,10,10,endpoint=False)array([1. , 1.9, 2.8, 3.7, 4.6, 5.5, 6.4, 7.3, 8.2, 9.1])</code></pre><p><code>linspace</code>å‡½æ•°ä¸­éœ€è¦è‡³å°‘ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºèµ·å§‹ç‚¹ã€ç»ˆæ­¢ç‚¹å’Œè¦ç”Ÿæˆçš„ç­‰é—´è·ç‚¹çš„æ•°é‡ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>endpoint</code>ï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º<code>True</code>ï¼Œè¡¨ç¤ºé»˜è®¤åŒ…æ‹¬ç»ˆæ­¢ç‚¹ï¼Œæ­¤æ—¶å¯å°†è¾“å…¥ç†è§£ä¸ºä¸€ä¸ªé—­åŒºé—´ï¼Œå°†å…¶è®¾ç½®ä¸º<code>False</code>åï¼Œè¾“å…¥åˆå˜æˆäº†ä¸€ä¸ªå·¦é—­å³å¼€åŒºé—´ã€‚</p><h3 id="2-2-2ç­‰æ¯”æ•°åˆ—"><a href="#2-2-2ç­‰æ¯”æ•°åˆ—" class="headerlink" title="2.2.2ç­‰æ¯”æ•°åˆ—"></a>2.2.2ç­‰æ¯”æ•°åˆ—</h3><p><code>numpy</code>åŒæ ·æœ‰å‡½æ•°æ¥åˆ›å»ºæ»¡è¶³éœ€è¦çš„ç­‰æ¯”æ•°åˆ—ï¼Œå‡½æ•°åå­—å«<code>logspace</code>ï¼Œè¯¥å‡½æ•°æœ‰<code>start</code>ã€<code>stop</code>ã€<code>num</code>ã€<code>endpoint</code>ã€<code>base</code>äº”ä¸ªå‚æ•°ï¼Œ<br>|å‚æ•°   |æè¿°|<br>|:-: | :-: |<br>|start       |è¡¨ç¤ºæ‰€ç”Ÿæˆæ•°åˆ—çš„èµ·å§‹å€¼ä¸º${base}^{start}$            |<br>|stop        |è¡¨ç¤ºæ‰€ç”Ÿæˆæ•°åˆ—çš„ç»ˆæ­¢å€¼ä¸º$base^{stop}$          |<br>|num        |è¦ç”Ÿæˆçš„ç­‰æ­¥é•¿çš„æ ·æœ¬æ•°é‡ï¼Œé»˜è®¤ä¸º50|<br>|endpoint|è¯¥å€¼ä¸º True æ—¶ï¼Œæ•°åˆ—ä¸­ä¸­åŒ…å«$base^{stop}$ å€¼ï¼Œåä¹‹ä¸åŒ…å«ï¼Œé»˜è®¤æ˜¯Trueã€‚|<br>|base|    å¯¹æ•° log çš„åº•æ•°ï¼Œé»˜è®¤å€¼ä¸º10|<br>å®ä¾‹å¦‚ä¸‹ï¼š</p><pre class=" language-py"><code class="language-py">#ç”Ÿæˆ1åˆ°10000çš„ç­‰å·®æ•°åˆ—>>> np.logspace(0,4,5)array([1.e+00, 1.e+01, 1.e+02, 1.e+03, 1.e+04])>>> np.logspace(0,4,5,endpoint=False)array([1.00000000e+00, 6.30957344e+00, 3.98107171e+01, 2.51188643e+02,       1.58489319e+03]#ç”Ÿæˆ1åˆ°128çš„ç­‰å·®æ•°åˆ—>>> np.logspace(0,7,8,base=2)array([  1.,   2.,   4.,   8.,  16.,  32.,  64., 128.])</code></pre><h2 id="2-3æ•°æ®ç±»å‹"><a href="#2-3æ•°æ®ç±»å‹" class="headerlink" title="2.3æ•°æ®ç±»å‹"></a>2.3æ•°æ®ç±»å‹</h2><p>åœ¨ä¸Šè¿°çš„å„ç§å‡½æ•°ä¸­ï¼Œå…¶å®éƒ½è¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼Œåå­—ä¸º<code>dtype</code>ï¼Œå®ƒå¯ä»¥ç”¨æ¥æŒ‡å®šæ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><pre class=" language-py"><code class="language-py">>>> c=np.array([1,2,3,4])>>> carray([1, 2, 3, 4])>>> c.dtypedtype('int32')>>> d=np.array([1,2,3,4],dtype='float32')>>> darray([1., 2., 3., 4.], dtype=float32)</code></pre><p>è¿™é‡Œå†é™„ä¸Šnumpyé‡Œçš„æ•°æ®ç±»å‹è¡¨ï¼ˆè½¬è½½äº<a href="https://www.runoob.com/numpy/numpy-dtype.html">èœé¸Ÿæ•™ç¨‹</a>ï¼‰ï¼š<br>|åç§°|    æè¿°|<br>|:-:|:-:|<br>|bool_    |å¸ƒå°”å‹æ•°æ®ç±»å‹ï¼ˆTrue æˆ–è€… Falseï¼‰<br>|int_    |é»˜è®¤çš„æ•´æ•°ç±»å‹ï¼ˆç±»ä¼¼äº C è¯­è¨€ä¸­çš„ longï¼Œint32 æˆ– int64ï¼‰<br>|intc    |ä¸ C çš„ int ç±»å‹ä¸€æ ·ï¼Œä¸€èˆ¬æ˜¯ int32 æˆ– int 64<br>|intp    |ç”¨äºç´¢å¼•çš„æ•´æ•°ç±»å‹ï¼ˆç±»ä¼¼äº C çš„ ssize_tï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä»ç„¶æ˜¯ int32 æˆ– int64ï¼‰<br>|int8    |å­—èŠ‚ï¼ˆ-128 to 127ï¼‰<br>|int16    |æ•´æ•°ï¼ˆ-32768 to 32767ï¼‰<br>|int32    |æ•´æ•°ï¼ˆ-2147483648 to 2147483647ï¼‰<br>|int64    |æ•´æ•°ï¼ˆ-9223372036854775808 to 9223372036854775807ï¼‰<br>|uint8    |æ— ç¬¦å·æ•´æ•°ï¼ˆ0 to 255ï¼‰<br>|uint16    |æ— ç¬¦å·æ•´æ•°ï¼ˆ0 to 65535ï¼‰<br>|uint32    |æ— ç¬¦å·æ•´æ•°ï¼ˆ0 to 4294967295ï¼‰<br>|uint64    |æ— ç¬¦å·æ•´æ•°ï¼ˆ0 to 18446744073709551615ï¼‰<br>|float_    |float64 ç±»å‹çš„ç®€å†™<br>|float16    |åŠç²¾åº¦æµ®ç‚¹æ•°ï¼ŒåŒ…æ‹¬ï¼š1 ä¸ªç¬¦å·ä½ï¼Œ5 ä¸ªæŒ‡æ•°ä½ï¼Œ10 ä¸ªå°¾æ•°ä½<br>|float32    |å•ç²¾åº¦æµ®ç‚¹æ•°ï¼ŒåŒ…æ‹¬ï¼š1 ä¸ªç¬¦å·ä½ï¼Œ8 ä¸ªæŒ‡æ•°ä½ï¼Œ23 ä¸ªå°¾æ•°ä½<br>|float64    |åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ŒåŒ…æ‹¬ï¼š1 ä¸ªç¬¦å·ä½ï¼Œ11 ä¸ªæŒ‡æ•°ä½ï¼Œ52 ä¸ªå°¾æ•°ä½<br>|complex_    |complex128 ç±»å‹çš„ç®€å†™ï¼Œå³ 128 ä½å¤æ•°<br>|complex64    |å¤æ•°ï¼Œè¡¨ç¤ºåŒ 32 ä½æµ®ç‚¹æ•°ï¼ˆå®æ•°éƒ¨åˆ†å’Œè™šæ•°éƒ¨åˆ†ï¼‰<br>|complex128    |å¤æ•°ï¼Œè¡¨ç¤ºåŒ 64 ä½æµ®ç‚¹æ•°ï¼ˆå®æ•°éƒ¨åˆ†å’Œè™šæ•°éƒ¨åˆ†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§èšç±»æ¨¡å‹</title>
      <link href="2020/03/27/julei/"/>
      <url>2020/03/27/julei/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ¥å†™å†™æ•°å­¦å»ºæ¨¡ä¸­çš„èšç±»æ¨¡å‹ï¼Œè¿˜æ˜¯åˆ†ä¸ºå‡ ä¸ªç‰ˆå—æ¥å†™</p><h2 id="1-èšç±»æ¨¡å‹ç®€ä»‹"><a href="#1-èšç±»æ¨¡å‹ç®€ä»‹" class="headerlink" title="1.èšç±»æ¨¡å‹ç®€ä»‹"></a>1.èšç±»æ¨¡å‹ç®€ä»‹</h2><p>ä¿—è¯è¯´ï¼šâ€œç‰©ä»¥ç±»èšï¼Œäººä»¥ç¾¤åˆ†â€ï¼Œæ‰€è°“çš„èšç±»ï¼Œå°±æ˜¯å°†æ ·æœ¬åˆ’åˆ†ä¸ºç”±ç±»ä¼¼çš„å¯¹è±¡ç»„æˆçš„å¤šä¸ªç±»çš„è¿‡ç¨‹ã€‚èšç±»ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ å‡†ç¡®åœ°åœ¨æ¯ä¸ªç±»ä¸­å•ç‹¬ä½¿ç”¨ç»Ÿè®¡æ¨¡å‹è¿›è¡Œä¼°è®¡ï¼Œåˆ†ææˆ–è€…é¢„æµ‹ï¼›ä¹Ÿå¯ä»¥ç ”ç©¶ä¸åŒç±»ä¹‹é—´çš„å·®å¼‚ã€‚èšç±»ç®—æ³•å¸¸è§çš„æœ‰<strong>K-meansèšç±»ç®—æ³•ï¼Œç³»ç»Ÿèšç±»ç®—æ³•ï¼Œ<a href="https://baike.baidu.com/item/DBSCAN/4864716?fr=aladdin">DBSCAN</a>ç®—æ³•</strong></p><h2 id="2-K-meansèšç±»ç®—æ³•"><a href="#2-K-meansèšç±»ç®—æ³•" class="headerlink" title="2.K-meansèšç±»ç®—æ³•"></a>2.K-meansèšç±»ç®—æ³•</h2><h4 id="a-ç®—æ³•æµç¨‹ï¼š"><a href="#a-ç®—æ³•æµç¨‹ï¼š" class="headerlink" title="a.ç®—æ³•æµç¨‹ï¼š"></a>a.ç®—æ³•æµç¨‹ï¼š</h4><ul><li>æŒ‡å®šéœ€è¦åˆ’åˆ†çš„ç°‡çš„ä¸ªæ•°ï¼Œå³Kå€¼ï¼ˆç±»çš„ä¸ªæ•°ï¼‰ï¼›</li><li>éšæœºçš„é€‰æ‹©Kä¸ªæ•°æ®å¯¹è±¡ä½œä¸ºåˆå§‹çš„èšç±»ä¸­å¿ƒï¼›</li><li>è®¡ç®—å…¶ä½™çš„å„ä¸ªæ•°æ®å¯¹è±¡åˆ°è¿™Kä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ï¼ŒæŠŠæ•°æ®å¯¹è±¡åˆ’åˆ†åˆ°è·ç¦»å®ƒæœ€è¿‘çš„é‚£ä¸ªä¸­å¿ƒæ‰€åœ¨çš„ç°‡ä¸­ï¼›</li><li>è°ƒæ•´æ–°ç±»å¹¶è®¡ç®—å‡ºæ–°çš„èšç±»ä¸­å¿ƒï¼›</li><li>å¾ªç¯ç¬¬ä¸‰å’Œç¬¬å››æ­¥ï¼Œç›´åˆ°èšç±»ä¸­å¿ƒä¸å†å‘ç”Ÿå˜åŒ–ï¼Œèšç±»ç»“æŸã€‚</li></ul><h4 id="b-ç®—æ³•è¯„ä»·ä¸æ”¹è¿›ï¼š"><a href="#b-ç®—æ³•è¯„ä»·ä¸æ”¹è¿›ï¼š" class="headerlink" title="b.ç®—æ³•è¯„ä»·ä¸æ”¹è¿›ï¼š"></a>b.ç®—æ³•è¯„ä»·ä¸æ”¹è¿›ï¼š</h4><ul><li>ä¼˜ç‚¹ï¼šç®—æ³•ç®€å•è¿…é€Ÿï¼Œå¤„ç†å¤§é‡æ•°æ®çš„æ—¶å€™ï¼Œè¯¥ç®—æ³•æ•ˆç‡è¾ƒé«˜ï¼›</li><li>ç¼ºç‚¹ï¼šè¦æ±‚æå‰ç»™å‡ºè¦åˆ†æˆçš„ç±»æ•°Kï¼›å¯¹åˆå€¼ã€å­¤ç«‹ç‚¹æ•°æ®æ•æ„Ÿï¼›</li><li>è§£å†³åŠæ³•ï¼šä½¿ç”¨K-means++ç®—æ³•å¯ä»¥è§£å†³Kå‡å€¼ç®—æ³•å¯¹åˆå€¼å’Œå­¤ç«‹æ•°æ®æ•æ„Ÿçš„é—®é¢˜ï¼›</li><li>K-means++ç®—æ³•åŸºæœ¬åŸåˆ™ï¼šé€‰æ‹©åˆå§‹èšç±»ä¸­å¿ƒæ—¶è¦ä¿è¯èšç±»ä¸­å¿ƒä¹‹é—´çš„è·ç¦»å°½å¯èƒ½è¿œï¼›</li><li>K-means++ç®—æ³•çš„å®ç°ï¼šå¯¹åŸK-meansç®—æ³•çš„ç¬¬ä¸€æ­¥è¿›è¡Œä¼˜åŒ–ï¼Œå…ˆéšæœºé€‰æ‹©ä¸€ä¸ªèšç±»ä¸­å¿ƒï¼Œç„¶åè®¡ç®—å„ä¸ªæ•°æ®ç‚¹åˆ°è¿™ä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ï¼Œè·ç¦»è¶Šè¿œè¢«é€‰åšèšç±»ä¸­å¿ƒçš„æ¦‚ç‡è¶Šå¤§ï¼Œæœ€åç”¨è½®ç›˜æ³•ï¼ˆä¾æ®æ¦‚ç‡å¤§å°æŠ½é€‰ï¼‰æ¥é€‰å–ä¸‹ä¸€ä¸ªèšç±»ä¸­å¿ƒï¼Œç„¶åé‡å¤è¿™ä¸€æ“ä½œï¼Œç›´è‡³é€‰å‡ºKä¸ªèšç±»ä¸­å¿ƒã€‚</li></ul><h4 id="c-ä¸¾ä¾‹å®ç°"><a href="#c-ä¸¾ä¾‹å®ç°" class="headerlink" title="c.ä¸¾ä¾‹å®ç°"></a>c.ä¸¾ä¾‹å®ç°</h4><p>åœ¨è¿™æˆ‘ä»¬ä½¿ç”¨<a href="https://baike.baidu.com/item/spss/2351375?fr=aladdin">SPSS</a>è½¯ä»¶æ¥å®ç°Kå‡å€¼èšç±»ï¼ŒSPSSé»˜è®¤ä½¿ç”¨K-means++ç®—æ³•ï¼š</p><ol><li>æ‰“å¼€<a href="https://baike.baidu.com/item/spss/2351375?fr=aladdin">SPSS</a>ï¼Œå¯¼å…¥è¦ç”¨äºèšç±»çš„æ•°æ®ï¼Œæˆ‘è¿™é‡Œæ˜¯ç›´æ¥é€‰æ‹©çš„500ç»„æ•°æ®ï¼ˆæ•°æ®æ˜¯æˆ‘2020ç¾èµ›cé¢˜å¯¹è¯„è®ºæ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿæå–å¾—åˆ°çš„ï¼Œåˆ†åˆ«ä¸ºæ¶ˆæè¯å¾—åˆ†ã€ä¸­æ€§è¯å¾—åˆ†ã€ç§¯æè¯å¾—åˆ†ã€å¤åˆè¯å¾—åˆ†ï¼‰ç²˜è´´è¿›å»<br><img src="https://img-blog.csdnimg.cn/20200326190637565.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>æ¥ä¸‹æ¥æ“ä½œå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20200326191149603.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>ç„¶åè®¾ç½®å¦‚ä¸‹ï¼Œè®¾ç½®å®Œæ¯•åç‚¹å‡»<strong>ç¡®å®š</strong>ï¼Œç³»ç»Ÿå°±å¼€å§‹èšç±»äº†ï¼š<br><img src="https://img-blog.csdnimg.cn/20200326192324788.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>èšç±»ç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20200326192942116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200326192830192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><h4 id="d-æ³¨æ„äº‹é¡¹ï¼š"><a href="#d-æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="d.æ³¨æ„äº‹é¡¹ï¼š"></a>d.æ³¨æ„äº‹é¡¹ï¼š</h4><p>å¦‚æœæ•°æ®çš„é‡çº²ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè®¡ç®—è·ç¦»å°±æ²¡æœ‰æ„ä¹‰äº†ï¼Œæˆ‘ä»¬å¾—å…ˆå°†æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ“ä½œå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20200326200856623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200326200915398.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="3-ç³»ç»Ÿï¼ˆå±‚æ¬¡ï¼‰èšç±»ç®—æ³•ï¼š"><a href="#3-ç³»ç»Ÿï¼ˆå±‚æ¬¡ï¼‰èšç±»ç®—æ³•ï¼š" class="headerlink" title="3.ç³»ç»Ÿï¼ˆå±‚æ¬¡ï¼‰èšç±»ç®—æ³•ï¼š"></a>3.ç³»ç»Ÿï¼ˆå±‚æ¬¡ï¼‰èšç±»ç®—æ³•ï¼š</h2><h4 id="a-ç®—æ³•æµç¨‹"><a href="#a-ç®—æ³•æµç¨‹" class="headerlink" title="a.ç®—æ³•æµç¨‹"></a>a.ç®—æ³•æµç¨‹</h4><ul><li>å°†æ¯ä¸ªå¯¹è±¡çœ‹ä½œä¸€ç±»ï¼Œè®¡ç®—ä¸¤ä¸¤ä¹‹é—´çš„æœ€å°è·ç¦»ï¼›</li><li>å°†è·ç¦»æœ€å°çš„ä¸¤ä¸ªç±»åˆå¹¶æˆä¸€ä¸ªæ–°ç±»ï¼›</li><li>é‡æ–°è®¡ç®—æ–°ç±»ä¸æ‰€æœ‰ç±»ä¹‹é—´çš„è·ç¦»ï¼›</li><li>é‡å¤äºŒä¸‰ä¸¤æ­¥ï¼Œç›´åˆ°æ‰€æœ‰ç±»æœ€ååˆå¹¶æˆä¸€ç±»ï¼Œèšç±»ç»“æŸã€‚</li></ul><h4 id="b-SPSSå®ç°ï¼š"><a href="#b-SPSSå®ç°ï¼š" class="headerlink" title="b.SPSSå®ç°ï¼š"></a>b.<a href="https://baike.baidu.com/item/spss/2351375?fr=aladdin">SPSS</a>å®ç°ï¼š</h4><p><img src="https://img-blog.csdnimg.cn/20200326203721645.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODU3ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»“æœä¼šå¾—åˆ°ä¸€å¼ è°±ç³»å›¾ï¼Œç”±äºå›¾ç‰‡å¤ªé•¿æˆ‘å°±ä¸å±•ç¤ºäº†ï¼Œæ ¹æ®è°±ç³»å›¾æˆ‘ä»¬å¯ä»¥è‡ªå·±å†³å®šå°†æ•°æ®åˆ†ä¸ºå‡ ç±»ã€‚</p><h2 id="4-DBSCANç®—æ³•ï¼š"><a href="#4-DBSCANç®—æ³•ï¼š" class="headerlink" title="4.DBSCANç®—æ³•ï¼š"></a>4.<a href="https://baike.baidu.com/item/DBSCAN/4864716?fr=aladdin">DBSCAN</a>ç®—æ³•ï¼š</h2><p>è¯¥ç®—æ³•æ˜¯ä¸€ç§åŸºäºå¯†åº¦çš„èšç±»ç®—æ³•ï¼Œèšç±»å‰ä¸éœ€è¦é¢„å…ˆæŒ‡å®šèšç±»çš„ä¸ªæ•°ï¼Œç”Ÿæˆç°‡çš„ä¸ªæ•°ä¸å®šï¼ˆç”±æ•°æ®å†³å®šï¼‰ã€‚è¯¥ç®—æ³•åˆ©ç”¨åŸºäºå¯†åº¦çš„èšç±»çš„æ¦‚å¿µï¼Œå³è¦æ±‚èšç±»ç©ºé—´ä¸­çš„ä¸€å®šåŒºåŸŸå†…æ‰€åŒ…å«å¯¹è±¡ï¼ˆç‚¹æˆ–å…¶ä»–ç©ºé—´å¯¹è±¡ï¼‰çš„æ•°ç›®ä¸å°äºæŸä¸€ç»™å®šé˜ˆå€¼ã€‚è¯¥æ–¹æ³•èƒ½åœ¨å…·æœ‰å™ªå£°çš„ç©ºé—´æ•°æ®åº“ä¸­å‘ç°ä»»æ„å½¢çŠ¶çš„ç°‡ï¼Œå¯å°†å¯†åº¦è¶³å¤Ÿå¤§çš„ç›¸é‚»åŒºåŸŸè¿æ¥ï¼Œèƒ½æœ‰æ•ˆå¤„ç†å¼‚å¸¸æ•°æ®ã€‚ï¼ˆè¯´ç™½äº†å°±æ˜¯ï¼šæŒ¨æˆ‘è¿‘çš„å°±æ˜¯æˆ‘çš„å…„å¼Ÿï¼Œæˆ‘å…„å¼Ÿçš„å…„å¼Ÿï¼Œå°±æ˜¯æˆ‘çš„å…„å¼Ÿï¼‰</p><h4 id="a-åŸºæœ¬æ¦‚å¿µï¼š"><a href="#a-åŸºæœ¬æ¦‚å¿µï¼š" class="headerlink" title="a.åŸºæœ¬æ¦‚å¿µï¼š"></a>a.åŸºæœ¬æ¦‚å¿µï¼š</h4><p>DBSCANç®—æ³•å°†æ•°æ®åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li>æ ¸å¿ƒç‚¹ï¼šåœ¨åŠå¾„Epså†…å«æœ‰ä¸å°‘äºMinPtsæ•°ç›®çš„ç‚¹ï¼›</li><li>è¾¹ç•Œç‚¹ï¼šåœ¨åŠå¾„Epså†…ç‚¹çš„æ•°é‡å°äºMinPtsï¼Œä½†æ˜¯è½åœ¨æ ¸å¿ƒç‚¹çš„é‚»åŸŸå†…ï¼›</li><li>å™ªéŸ³ç‚¹ï¼šæ—¢ä¸æ˜¯æ ¸å¿ƒç‚¹ä¹Ÿä¸æ˜¯è¾¹ç•Œç‚¹çš„ç‚¹ã€‚</li></ul><h4 id="b-ä¼˜ç¼ºç‚¹ï¼š"><a href="#b-ä¼˜ç¼ºç‚¹ï¼š" class="headerlink" title="b.ä¼˜ç¼ºç‚¹ï¼š"></a>b.ä¼˜ç¼ºç‚¹ï¼š</h4><p> <strong>1. ä¼˜ç‚¹ï¼š</strong></p><ul><li>åŸºäºå¯†åº¦å®šä¹‰ï¼Œèƒ½å¤Ÿå¤„ç†ä»»æ„å½¢çŠ¶å’Œå¤§å°çš„ç°‡ï¼›</li><li>å¯åœ¨èšç±»çš„åŒæ—¶å‘ç°å¼‚å¸¸ç‚¹ï¼›</li><li>ä¸éœ€è¦æŒ‡å®šè¦åˆ’åˆ†çš„ç°‡çš„ä¸ªæ•°</li></ul><p> <strong>2.</strong> </p><ul><li>å¯¹äºè¾“å…¥å‚æ•°$\xi$å’ŒMinPtsæ•æ„Ÿï¼Œç¡®å®šå‚æ•°å›°éš¾ï¼›</li><li>åœ¨è¯¥ç®—æ³•ä¸­ï¼Œå˜é‡$\xi$å’ŒMinPtsæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå½“èšç±»çš„å¯†åº¦ä¸å‡åŒ€æ—¶ï¼Œèšç±»è·ç¦»ç›¸å·®å¾ˆå¤§æ—¶ï¼Œèšç±»è´¨é‡å·®ï¼›</li><li>å½“æ•°æ®é‡å¤§æ—¶ï¼Œè®¡ç®—å¯†åº¦å•å…ƒçš„è®¡ç®—å¤æ‚åº¦å¤§</li></ul><h2 id="4-å¯è§†åŒ–ï¼š"><a href="#4-å¯è§†åŒ–ï¼š" class="headerlink" title="4.å¯è§†åŒ–ï¼š"></a>4.å¯è§†åŒ–ï¼š</h2><ol><li>K-meansèšç±»ç®—æ³•å¯è§†åŒ–ï¼Œ<a href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/">æˆ³æˆ‘</a></li><li>DBSCANç®—æ³•å¯è§†åŒ–ï¼Œ<a href="https://www.naftaliharris.com/blog/visualizing-dbscan-clustering/">æˆ³æˆ‘</a></li></ol><h2 id="5-æ€»ç»“ï¼š"><a href="#5-æ€»ç»“ï¼š" class="headerlink" title="5.æ€»ç»“ï¼š"></a>5.æ€»ç»“ï¼š</h2><p>èšç±»ç®—æ³•åœ¨æ•°å­¦å»ºæ¨¡ä¸­åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œè¿™æ¬¡2020ç¾èµ›æˆ‘ä»¬é˜Ÿä¼è¿˜ç”¨åˆ°äº†ç³»ç»Ÿèšç±»ç®—æ³•æ¥å¯¹è¯„è®ºè¿›è¡Œåˆ†ç±»è¯„çº§ï¼Œè¿™å‡ ç§ç®—æ³•çš„ä¼˜ç¼ºç‚¹éƒ½å¾ˆæ˜æ˜¾ï¼Œå°½é‡æ ¹æ®å®é™…æƒ…å†µæ¥åˆç†ä½¿ç”¨ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ¨¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fisherçº¿æ€§åˆ¤åˆ«+KNNåˆ†ç±»</title>
      <link href="2020/03/27/fisher/"/>
      <url>2020/03/27/fisher/</url>
      
        <content type="html"><![CDATA[<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><ul><li><p>pycharmä¸“ä¸šç‰ˆ2019.3.3</p></li><li><p>python3.7.4</p></li><li><p>å¤–éƒ¨åº“ï¼šnumpy=1.16.5ï¼›sklearn=0.21.3ï¼›matplotlib=3.3.1ï¼›openpyxl=3.0.0</p></li></ul><h3 id="åŸç†ç®€ä»‹"><a href="#åŸç†ç®€ä»‹" class="headerlink" title="åŸç†ç®€ä»‹"></a>åŸç†ç®€ä»‹</h3><p>å°†ä¸€ä¸ªä¸€ä¸ªå¤æ‚çš„é«˜ç»´åˆ†ç±»é—®é¢˜ï¼Œå…ˆé€šè¿‡fisherçº¿æ€§åˆ¤åˆ«åˆ†æè¿›è¡Œé™ç»´ï¼Œé™åˆ°ä½çº¬ä¹‹åï¼Œå†é€šè¿‡KNNç®—æ³•è¿›è¡Œåˆ†ç±»</p><h3 id="ä¸€äº›è®¡ç®—å…¬å¼"><a href="#ä¸€äº›è®¡ç®—å…¬å¼" class="headerlink" title="ä¸€äº›è®¡ç®—å…¬å¼"></a>ä¸€äº›è®¡ç®—å…¬å¼</h3><h4 id="åœ¨nç»´Xç©ºé—´"><a href="#åœ¨nç»´Xç©ºé—´" class="headerlink" title="åœ¨nç»´Xç©ºé—´"></a>åœ¨nç»´Xç©ºé—´</h4><ul><li>å„ç±»æ ·æœ¬å‡å€¼å‘é‡$\mu_{i}$:</li></ul><p>$$<br>\mu_{i}=\dfrac{1}{N_{i}}\sum_{x_{j}\in\Omega_{i}}x_{j},i=1,2<br>$$</p><ul><li>å„ç±»ç±»å†…ç¦»æ•£åº¦çŸ©é˜µ$S_{i}$:</li></ul><p>$$<br>S_{i}=\sum_{x_{j}\in\Omega_{i}}\left( x_{j}-\mu_{i}\right) \left( x_{j}-\mu_{i}\right) ^{T},i=1,2<br>$$</p><ul><li>æ€»ç±»å†…ç¦»æ•£åº¦çŸ©é˜µ$S_{w}$:</li></ul><p>$$<br>S_{w}=\sum_{x_{j}\in \Omega_{i}}S_{i},i=1,2<br>$$</p><ul><li>äºŒåˆ†ç±»æƒ…å†µä¸‹æ ·æœ¬ç±»é—´ç¦»æ•£åº¦çŸ©é˜µ$S_{b}$:</li></ul><p>$$<br>S_{b}=(\mu_{1}-\mu_{2})(\mu_{1}-\mu_{2})^{T}<br>$$</p><ul><li>å¤šåˆ†ç±»æƒ…å†µä¸‹çš„æ ·æœ¬ç±»é—´ç¦»æ•£åº¦çŸ©é˜µ$S_b$:<br>$$<br>S_b=\sum_{i=1,2,â€¦c}{N_i}(\mu_i-\mu)(\mu_i-\mu)^{T}<br>$$<br>å…¶ä¸­$\mu$æ˜¯æ‰€æœ‰æ ·æœ¬çš„å‡å€¼</li></ul><h4 id="Yç©ºé—´"><a href="#Yç©ºé—´" class="headerlink" title="Yç©ºé—´"></a>Yç©ºé—´</h4><ul><li>å„ç±»æ ·æœ¬å‡å€¼$\overline{\mu_{i}}$:</li></ul><p>$$<br>\overline{\mu_{i}}=\dfrac{1}{N_{i}}\sum_{y_{j}\in \psi_{i}}y_{j},i=1,2<br>$$</p><ul><li><p>å„ç±»å†…ç¦»æ•£åº¦$\overline{S^2_{i}}$:<br>$$<br>\overline{S_{i}}^{2}=\sum_{y_{j}\in \psi_{i}}\left( y_{j}-\overline\mu_{i}\right)^{2},i=1,2<br>$$</p></li><li><p>äºŒåˆ†ç±»æƒ…å†µä¸‹é™åˆ°ä¸€ç»´æœ€ä½³æŠ•å½±æ–¹å‘$\omega^*$:<br>$$<br>\omega^*=S_\omega^-1(\mu_{1}-\mu_{2})<br>$$</p></li></ul><ul><li><p>é™åˆ°äºŒç»´çš„æœ€ä½³æŠ•å½±æ–¹å‘${\omega}^*$:</p><p>$$<br>S_{w}^{-1}S_{b}\omega^*=\lambda\omega^*                              ï¼ˆ9ï¼‰<br>$$</p><p>æ ¹æ®å¼å­(9)è®¡ç®—å‡ºç‰¹å¾å€¼$\lambda$ï¼Œå–æœ€å¤§çš„å‰ä¸¤ä¸ªç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå°†å…¶ç»„åˆåœ¨ä¸€èµ·ï¼Œå³ä¸ºæ‰€æ±‚çš„æœ€ä½³æŠ•å½±æ–¹å‘ï¼Œå¼(9)ä¸­çš„$S_b$ç”±å¼(5)è®¡ç®—å¾—æ¥</p></li></ul><h4 id="è¯„ä»·æŒ‡æ ‡"><a href="#è¯„ä»·æŒ‡æ ‡" class="headerlink" title="è¯„ä»·æŒ‡æ ‡"></a>è¯„ä»·æŒ‡æ ‡</h4><ul><li><p>æ€»ä½“åˆ†ç±»ç²¾åº¦OAï¼š<br>$$<br>\frac{æ‰€æœ‰åˆ¤æ–­æ­£ç¡®çš„æ ·æœ¬æ•°}{æ‰€æœ‰æµ‹è¯•æ ·æœ¬æ•°}\times100%<br>$$</p></li><li><p>ç±»åˆ«åˆ†ç±»ç²¾åº¦AA:<br>$$<br>\frac{æŸä¸€ç±»ä¸­åˆ¤æ–­æ­£ç¡®çš„æ ·æœ¬æ•°}{è¯¥ç±»å‚ä¸æµ‹è¯•çš„æ ·æœ¬æ•°}\times100%<br>$$</p></li><li><p>kappaç³»æ•°:<br>$$<br>\frac{OA-pe}{1-pe}<br>$$</p></li><li><p>pe:<br>$$<br>\frac{\sum{(æŸç±»å‚ä¸æµ‹è¯•çš„æ ·æœ¬æ•°\times{è¢«åˆ¤æ–­ä¸ºè¯¥ç±»çš„æµ‹è¯•æ ·æœ¬æ•°})}}{æ‰€æœ‰çš„æµ‹è¯•æ ·æœ¬æ•°^2}<br>$$</p></li></ul><h3 id="æ•°æ®æ ‡å‡†åŒ–"><a href="#æ•°æ®æ ‡å‡†åŒ–" class="headerlink" title="æ•°æ®æ ‡å‡†åŒ–"></a>æ•°æ®æ ‡å‡†åŒ–</h3><p>ç”±äºä¸¤ç§æ•°æ®é›†ä¸­ç‰¹å¾çš„é‡çº²éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥ä¸ºäº†æ¶ˆé™¤é‡çº²ï¼Œå°†æ¯ä¸ªç‰¹å¾çš„æ•°å€¼é™¤ä»¥è¯¥ç‰¹å¾ä¸­çš„æœ€å¤§å€¼å³å¯ï¼Œè¿™æ ·å°†æ‰€æœ‰ç‰¹å¾æ•°å€¼æ˜ å°„åˆ°äº†åŒºé—´[0,1]ä¹‹é—´</p><h3 id="åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†"><a href="#åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†" class="headerlink" title="åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†"></a>åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</h3><p>åˆ©ç”¨sklearnåŒ…ä¸­çš„train_test_splitå‡½æ•°è¿›è¡Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†ï¼Œå…¶ä¸­è®­ç»ƒé›†å æ¯”40%ï¼Œæµ‹è¯•é›†å æ¯”60%ã€‚</p><p>å…¶ä¸­train_test_splitå‡½æ•°çš„ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š</p><pre class=" language-python"><code class="language-python">X_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>train_data<span class="token punctuation">,</span>train_target<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><p><strong>train_dataï¼š</strong>æ‰€è¦åˆ’åˆ†çš„æ ·æœ¬ç‰¹å¾é›†</p></li><li><p><strong>train_targetï¼š</strong>æ‰€è¦åˆ’åˆ†çš„æ ·æœ¬ç»“æœé›†</p></li><li><p><strong>test_sizeï¼š</strong>æµ‹è¯•æ ·æœ¬å æ¯”ï¼Œå¦‚æœæ˜¯æ•´æ•°çš„è¯å°±æ˜¯æ ·æœ¬çš„æ•°é‡</p></li><li><p><strong>random_stateï¼š</strong>æ˜¯éšæœºæ•°çš„ç§å­</p></li><li><p><strong>éšæœºç§å­ï¼š</strong>å…¶å®å°±æ˜¯è¯¥ç»„éšæœºæ•°çš„ç¼–å·ï¼Œåœ¨éœ€è¦é‡å¤è¯•éªŒçš„æ—¶å€™ï¼Œä¿è¯å¾—åˆ°ä¸€ç»„ä¸€æ ·çš„éšæœºæ•°</p></li></ul><p>é€šè¿‡è¯¥å‡½æ•°ï¼Œåªè¦æ¯æ¬¡ä¼ å…¥ä¸åŒçš„éšæœºç§å­ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸åŒçš„è®­ç»ƒé›†ã€æµ‹è¯•é›†</p><h3 id="åˆ†ç±»ç­–ç•¥"><a href="#åˆ†ç±»ç­–ç•¥" class="headerlink" title="åˆ†ç±»ç­–ç•¥"></a>åˆ†ç±»ç­–ç•¥</h3><ol><li><p>sonaræ•°æ®é›†</p><p>sonaræ•°æ®é›†ä¸ºä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œåªéœ€è¦è®¡ç®—å‡ºæœ€ä¼˜æŠ•å½±æ–¹å‘ï¼ŒæŠ•å½±åï¼š</p><ul><li>æ–¹æ¡ˆä¸€ï¼šå°†æ ·æœ¬é™åˆ°ä¸€ç»´ï¼Œè®¡ç®—å‡ºå†³ç­–ç‚¹ï¼Œå†è¿›è¡Œåˆ†ç±»</li><li>æ–¹æ¡ˆäºŒï¼šå°†æ ·æœ¬é™åˆ°2ç»´ï¼Œé€šè¿‡KNNç®—æ³•è¿›è¡Œåˆ†ç±»</li></ul></li><li><p>irisæ•°æ®é›†</p><p>irisæ•°æ®é›†ä¸ºä¸€ä¸ªä¸‰åˆ†ç±»é—®é¢˜</p><ul><li><p>æ–¹æ¡ˆä¸€ï¼šå¯ä»¥å°†å…¶è½¬åŒ–ä¸ºä¸‰ä¸ªäºŒåˆ†ç±»é—®é¢˜è¿›è¡Œåˆ†ç±»ï¼Œå…·ä½“åˆ†ç±»æ€è·¯å¦‚ä¸‹ï¼š</p><pre class=" language-mermaid"><code class="language-mermaid">graph TB       start[æµ‹è¯•æ ·æœ¬] --é€šè¿‡ç¬¬1,2ç±»æ ·æœ¬çš„å†³ç­–å‡½æ•°--> input[æ ·æœ¬å…¨è¢«æ ‡è®°ä¸º0æˆ–è€…1]       input --é€šè¿‡ç¬¬1,3ç±»æ ·æœ¬çš„å†³ç­–å‡½æ•°--> conditionA&#123;æ ·æœ¬æ˜¯å¦è¢«æ ‡è®°ä¸º0&#125;       conditionA -- YES --> printA[å°†æ ‡è®°ä¸º0çš„æ ·æœ¬åˆ†ä¸ºç¬¬ä¸€ç±»]       conditionA -- NO --> inputB[äºŒä¸‰ä¸¤ç±»æ•°æ®]       inputB --é€šè¿‡ç¬¬2,3ç±»æ ·æœ¬çš„å†³ç­–å‡½æ•°--> conditionB&#123;æ ·æœ¬æ˜¯å¦è¢«æ ‡è®°ä¸º1&#125;       conditionB --YES--> printB[å°†æ ‡è®°ä¸º1çš„æ ·æœ¬åˆ†ä¸ºç¬¬äºŒç±»]       conditionB --NO--> printC[å°†æ ‡è®°ä¸º2çš„æ ·æœ¬åˆ†ä¸ºç¬¬ä¸‰ç±»] </code></pre></li><li><p>æ–¹æ¡ˆäºŒï¼šå°†æ ·æœ¬é™åˆ°äºŒç»´ï¼Œå†é€šè¿‡KNNç®—æ³•è¿›è¡Œåˆ†ç±»</p></li></ul></li></ol><h3 id="Kå€¼çš„é€‰æ‹©"><a href="#Kå€¼çš„é€‰æ‹©" class="headerlink" title="Kå€¼çš„é€‰æ‹©"></a>Kå€¼çš„é€‰æ‹©</h3><p>KNNåˆ†ç±»ç®—æ³•ä¸­ï¼Œéœ€è¦æˆ‘ä»¬æå‰æŒ‡å®škçš„å€¼ï¼Œæœ¬æ¬¡è¯•éªŒçš„kå€¼é€‰å–è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>å…ˆæ„å»ºå¥½åˆ†ç±»å™¨</p></li><li><p>å¯¹äºirisæ•°æ®é›†ï¼Œkåˆ†åˆ«å–å€¼ä¸º$4,5,7,8,10,11,13,14,16,17,19,20,22,23$ï¼Œæ±‚å‡ºå¯¹åº”çš„OAå€¼ï¼Œå–æœ€å¤§çš„OAå€¼å¯¹åº”çš„kå€¼ä¸ºæœ€ç»ˆçš„kå€¼</p></li><li><p>å¯¹äºsonaræ•°æ®é›†ï¼Œkåˆ†åˆ«å–å€¼ä¸º$3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35$ï¼Œæ±‚å‡ºå¯¹åº”çš„OAå€¼ï¼Œå–æœ€å¤§çš„OAå€¼å¯¹åº”çš„kå€¼ä¸ºæœ€ç»ˆçš„kå€¼</p></li></ul><p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>sonarï¼š</li></ul><img src="k_OA_sonar.jpg"  /><ul><li>irisï¼š</li></ul><img src="k_OA.jpg"  /><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œä¸¤æ•°æ®é›†éƒ½å–<strong>k=5</strong>åˆ†ç±»æ•ˆæœæœ€å¥½</p><h3 id="åˆ†ç±»ç»“æœå±•ç¤º"><a href="#åˆ†ç±»ç»“æœå±•ç¤º" class="headerlink" title="åˆ†ç±»ç»“æœå±•ç¤º"></a>åˆ†ç±»ç»“æœå±•ç¤º</h3><h4 id="sonaræ•°æ®é›†"><a href="#sonaræ•°æ®é›†" class="headerlink" title="sonaræ•°æ®é›†"></a>sonaræ•°æ®é›†</h4><ol><li><p><strong>åˆ†ç±»æ–¹æ¡ˆ1ï¼š</strong></p><table><thead><tr><th align="center">è¯•éªŒæ¬¡æ•°</th><th align="center">æ•´ä½“åˆ†ç±»ç²¾åº¦OA</th><th align="center">kappaç³»æ•°</th><th align="center">ç¬¬ä¸€ç±»ç±»åˆ«åˆ†ç±»ç²¾åº¦AA</th><th align="center">ç¬¬äºŒç±»ç±»åˆ«åˆ†ç±»ç²¾åº¦AA</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">0.603</td><td align="center">0.213</td><td align="center">0.678</td><td align="center">0.537</td></tr><tr><td align="center">2</td><td align="center">0.690</td><td align="center">0.370</td><td align="center">0.559</td><td align="center">0.806</td></tr><tr><td align="center">3</td><td align="center">0.690</td><td align="center">0.380</td><td align="center">0.695</td><td align="center">0.687</td></tr><tr><td align="center">4</td><td align="center">0.587</td><td align="center">0.171</td><td align="center">0.559</td><td align="center">0.612</td></tr><tr><td align="center">5</td><td align="center">0.690</td><td align="center">0.385</td><td align="center">0.763</td><td align="center">0.627</td></tr><tr><td align="center">6</td><td align="center">0.698</td><td align="center">0.389</td><td align="center">0.610</td><td align="center">0.776</td></tr><tr><td align="center">7</td><td align="center">0.675</td><td align="center">0.355</td><td align="center">0.763</td><td align="center">0.597</td></tr><tr><td align="center">8</td><td align="center">0.683</td><td align="center">0.371</td><td align="center">0.780</td><td align="center">0.597</td></tr><tr><td align="center">9</td><td align="center">0.706</td><td align="center">0.410</td><td align="center">0.678</td><td align="center">0.731</td></tr><tr><td align="center">10</td><td align="center">0.690</td><td align="center">0.383</td><td align="center">0.729</td><td align="center">0.657</td></tr><tr><td align="center">11</td><td align="center">0.643</td><td align="center">0.284</td><td align="center">0.627</td><td align="center">0.657</td></tr><tr><td align="center">12</td><td align="center">0.730</td><td align="center">0.467</td><td align="center">0.847</td><td align="center">0.627</td></tr><tr><td align="center">13</td><td align="center">0.643</td><td align="center">0.279</td><td align="center">0.576</td><td align="center">0.701</td></tr><tr><td align="center">14</td><td align="center">0.683</td><td align="center">0.353</td><td align="center">0.542</td><td align="center">0.806</td></tr><tr><td align="center">15</td><td align="center">0.675</td><td align="center">0.351</td><td align="center">0.712</td><td align="center">0.642</td></tr><tr><td align="center">16</td><td align="center">0.603</td><td align="center">0.198</td><td align="center">0.525</td><td align="center">0.672</td></tr><tr><td align="center">17</td><td align="center">0.794</td><td align="center">0.589</td><td align="center">0.847</td><td align="center">0.746</td></tr><tr><td align="center">18</td><td align="center">0.611</td><td align="center">0.223</td><td align="center">0.627</td><td align="center">0.597</td></tr><tr><td align="center">19</td><td align="center">0.627</td><td align="center">0.246</td><td align="center">0.542</td><td align="center">0.701</td></tr><tr><td align="center">20</td><td align="center">0.778</td><td align="center">0.551</td><td align="center">0.712</td><td align="center">0.836</td></tr><tr><td align="center">21</td><td align="center">0.675</td><td align="center">0.358</td><td align="center">0.797</td><td align="center">0.567</td></tr><tr><td align="center">22</td><td align="center">0.683</td><td align="center">0.365</td><td align="center">0.695</td><td align="center">0.672</td></tr><tr><td align="center">23</td><td align="center">0.754</td><td align="center">0.500</td><td align="center">0.644</td><td align="center">0.851</td></tr><tr><td align="center">24</td><td align="center">0.738</td><td align="center">0.475</td><td align="center">0.729</td><td align="center">0.746</td></tr><tr><td align="center">25</td><td align="center">0.730</td><td align="center">0.460</td><td align="center">0.746</td><td align="center">0.716</td></tr><tr><td align="center">26</td><td align="center">0.667</td><td align="center">0.335</td><td align="center">0.695</td><td align="center">0.642</td></tr><tr><td align="center">27</td><td align="center">0.667</td><td align="center">0.333</td><td align="center">0.678</td><td align="center">0.657</td></tr><tr><td align="center">28</td><td align="center">0.706</td><td align="center">0.417</td><td align="center">0.780</td><td align="center">0.642</td></tr><tr><td align="center">29</td><td align="center">0.754</td><td align="center">0.508</td><td align="center">0.780</td><td align="center">0.731</td></tr><tr><td align="center">30</td><td align="center">0.730</td><td align="center">0.462</td><td align="center">0.780</td><td align="center">0.687</td></tr><tr><td align="center"><strong>å¹³å‡å€¼</strong></td><td align="center"><strong>0.687</strong></td><td align="center"><strong>0.373</strong></td><td align="center"><strong>0.690</strong></td><td align="center"><strong>0.684</strong></td></tr></tbody></table></li></ol><ol start="2"><li><p><strong>åˆ†ç±»æ–¹æ¡ˆ2ï¼š</strong></p><table><thead><tr><th align="center">è¯•éªŒæ¬¡æ•°</th><th align="center">æ•´ä½“åˆ†ç±»ç²¾åº¦OA</th><th align="center"><strong>kappaç³»æ•°</strong></th><th align="center">ç¬¬ä¸€ç±»ç±»åˆ«åˆ†ç±»ç²¾åº¦AA</th><th align="center">ç¬¬äºŒç±»ç±»åˆ«åˆ†ç±»ç²¾åº¦AA</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">0.627</td><td align="center">0.252</td><td align="center">0.610</td><td align="center">0.642</td></tr><tr><td align="center">2</td><td align="center">0.603</td><td align="center">0.205</td><td align="center">0.593</td><td align="center">0.612</td></tr><tr><td align="center">3</td><td align="center">0.754</td><td align="center">0.505</td><td align="center">0.729</td><td align="center">0.776</td></tr><tr><td align="center">4</td><td align="center">0.643</td><td align="center">0.278</td><td align="center">0.559</td><td align="center">0.716</td></tr><tr><td align="center">5</td><td align="center">0.548</td><td align="center">0.087</td><td align="center">0.475</td><td align="center">0.612</td></tr><tr><td align="center">6</td><td align="center">0.683</td><td align="center">0.361</td><td align="center">0.644</td><td align="center">0.716</td></tr><tr><td align="center">7</td><td align="center">0.683</td><td align="center">0.361</td><td align="center">0.644</td><td align="center">0.716</td></tr><tr><td align="center">8</td><td align="center">0.690</td><td align="center">0.377</td><td align="center">0.644</td><td align="center">0.731</td></tr><tr><td align="center">9</td><td align="center">0.603</td><td align="center">0.200</td><td align="center">0.542</td><td align="center">0.657</td></tr><tr><td align="center">10</td><td align="center">0.690</td><td align="center">0.379</td><td align="center">0.678</td><td align="center">0.701</td></tr><tr><td align="center">11</td><td align="center">0.683</td><td align="center">0.361</td><td align="center">0.644</td><td align="center">0.716</td></tr><tr><td align="center">12</td><td align="center">0.508</td><td align="center">0.014</td><td align="center">0.492</td><td align="center">0.522</td></tr><tr><td align="center">13</td><td align="center">0.683</td><td align="center">0.361</td><td align="center">0.644</td><td align="center">0.716</td></tr><tr><td align="center">14</td><td align="center">0.595</td><td align="center">0.186</td><td align="center">0.559</td><td align="center">0.627</td></tr><tr><td align="center">15</td><td align="center">0.556</td><td align="center">0.108</td><td align="center">0.525</td><td align="center">0.582</td></tr><tr><td align="center">16</td><td align="center">0.627</td><td align="center">0.256</td><td align="center">0.661</td><td align="center">0.597</td></tr><tr><td align="center">17</td><td align="center">0.587</td><td align="center">0.170</td><td align="center">0.542</td><td align="center">0.627</td></tr><tr><td align="center">18</td><td align="center">0.683</td><td align="center">0.363</td><td align="center">0.661</td><td align="center">0.701</td></tr><tr><td align="center">19</td><td align="center">0.690</td><td align="center">0.379</td><td align="center">0.678</td><td align="center">0.701</td></tr><tr><td align="center">20</td><td align="center">0.563</td><td align="center">0.112</td><td align="center">0.424</td><td align="center">0.687</td></tr><tr><td align="center">21</td><td align="center">0.746</td><td align="center">0.484</td><td align="center">0.627</td><td align="center">0.851</td></tr><tr><td align="center">22</td><td align="center">0.571</td><td align="center">0.138</td><td align="center">0.525</td><td align="center">0.612</td></tr><tr><td align="center">23</td><td align="center">0.651</td><td align="center">0.297</td><td align="center">0.610</td><td align="center">0.687</td></tr><tr><td align="center">24</td><td align="center">0.595</td><td align="center">0.190</td><td align="center">0.593</td><td align="center">0.597</td></tr><tr><td align="center">25</td><td align="center">0.675</td><td align="center">0.341</td><td align="center">0.576</td><td align="center">0.761</td></tr><tr><td align="center">26</td><td align="center">0.603</td><td align="center">0.198</td><td align="center">0.525</td><td align="center">0.672</td></tr><tr><td align="center">27</td><td align="center">0.635</td><td align="center">0.261</td><td align="center">0.542</td><td align="center">0.716</td></tr><tr><td align="center">28</td><td align="center">0.587</td><td align="center">0.173</td><td align="center">0.576</td><td align="center">0.597</td></tr><tr><td align="center">29</td><td align="center">0.667</td><td align="center">0.331</td><td align="center">0.644</td><td align="center">0.687</td></tr><tr><td align="center">30</td><td align="center">0.611</td><td align="center">0.214</td><td align="center">0.525</td><td align="center">0.687</td></tr><tr><td align="center"><strong>å¹³å‡å€¼</strong></td><td align="center"><strong>0.635</strong></td><td align="center"><strong>0.365</strong></td><td align="center"><strong>0.590</strong></td><td align="center"><strong>0.674</strong></td></tr></tbody></table></li></ol><h4 id="irisæ•°æ®é›†"><a href="#irisæ•°æ®é›†" class="headerlink" title="irisæ•°æ®é›†"></a>irisæ•°æ®é›†</h4><ol><li><p><strong>åˆ†ç±»æ–¹æ¡ˆ1ï¼š</strong></p><table><thead><tr><th align="center">å®éªŒæ¬¡æ•°</th><th align="center">æ•´ä½“åˆ†ç±»ç²¾åº¦OA</th><th align="center">kappaç³»æ•°</th><th align="center">ç±»åˆ«åˆ†ç±»ç²¾åº¦AAï¼ˆä¾æ¬¡ä¸ºç¬¬1ï¼Œ2ï¼Œ3ç±»ï¼‰</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.767     0.933</td></tr><tr><td align="center">2</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00     0.800     0.933</td></tr><tr><td align="center">3</td><td align="center">0.833</td><td align="center">0.750</td><td align="center">1.00     0.800     0.700</td></tr><tr><td align="center">4</td><td align="center">0.956</td><td align="center">0.933</td><td align="center">1.00     0.900     0.967</td></tr><tr><td align="center">5</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00     0.900     0.867</td></tr><tr><td align="center">6</td><td align="center">0.967</td><td align="center">0.950</td><td align="center">1.00     0.900     1.000</td></tr><tr><td align="center">7</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.800     0.900</td></tr><tr><td align="center">8</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00     0.900     0.933</td></tr><tr><td align="center">9</td><td align="center">0.933</td><td align="center">0.900</td><td align="center">1.00     0.967     0.833</td></tr><tr><td align="center">10</td><td align="center">0.956</td><td align="center">0.933</td><td align="center">1.00     0.933     0.933</td></tr><tr><td align="center">11</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.833     0.867</td></tr><tr><td align="center">12</td><td align="center">0.822</td><td align="center">0.733</td><td align="center">1.00     0.667     0.800</td></tr><tr><td align="center">13</td><td align="center">0.833</td><td align="center">0.75</td><td align="center">1.00     0.800     0.700</td></tr><tr><td align="center">14</td><td align="center">0.967</td><td align="center">0.950</td><td align="center">1.00     0.933     0.967</td></tr><tr><td align="center">15</td><td align="center">0.878</td><td align="center">0.817</td><td align="center">1.00     0.633     1.000</td></tr><tr><td align="center">16</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00     0.933     0.833</td></tr><tr><td align="center">17</td><td align="center">0.644</td><td align="center">0.467</td><td align="center">1.00     0.433     0.500</td></tr><tr><td align="center">18</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.833     0.867</td></tr><tr><td align="center">19</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.867     0.833</td></tr><tr><td align="center">20</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00     0.867     0.800</td></tr><tr><td align="center">21</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.900     0.800</td></tr><tr><td align="center">22</td><td align="center">0.900</td><td align="center">0.850</td><td align="center">1.00     0.833     0.867</td></tr><tr><td align="center">23</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00     0.967     0.767</td></tr><tr><td align="center">24</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00     0.833     1.000</td></tr><tr><td align="center">25</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00     0.967     0.867</td></tr><tr><td align="center">26</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">0.97     0.867     0.933</td></tr><tr><td align="center">27</td><td align="center">0.956</td><td align="center">0.933</td><td align="center">1.00     0.900     0.967</td></tr><tr><td align="center">28</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00     0.900     0.867</td></tr><tr><td align="center">29</td><td align="center">0.956</td><td align="center">0.933</td><td align="center">1.00     0.933     0.933</td></tr><tr><td align="center">30</td><td align="center">0.878</td><td align="center">0.817</td><td align="center">1.00     0.767     0.867</td></tr><tr><td align="center"><strong>å¹³å‡å€¼</strong></td><td align="center"><strong>0.904</strong></td><td align="center"><strong>0.856</strong></td><td align="center"><strong>0.999       0.844       0.868</strong></td></tr></tbody></table></li></ol><ol start="2"><li><p><strong>åˆ†ç±»æ–¹æ¡ˆäºŒ</strong>ï¼š</p><table><thead><tr><th align="center">è¯•éªŒæ¬¡æ•°</th><th align="center">æ•´ä½“åˆ†ç±»ç²¾åº¦OA</th><th align="center">kappaç³»æ•°</th><th align="center">ç±»åˆ«åˆ†ç±»ç²¾åº¦AAï¼ˆä¾æ¬¡ä¸ºç¬¬1ï¼Œ2ï¼Œ3ç±»ï¼‰</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.900   0.867</td></tr><tr><td align="center">2</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.933  0.833</td></tr><tr><td align="center">3</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.900   0.767</td></tr><tr><td align="center">4</td><td align="center">0.933</td><td align="center">0.9</td><td align="center">1.00    0.900    0.900</td></tr><tr><td align="center">5</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00   0.933   0.800</td></tr><tr><td align="center">6</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.933   0.833</td></tr><tr><td align="center">7</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00    0.933   0.900</td></tr><tr><td align="center">8</td><td align="center">0.9</td><td align="center">0.85</td><td align="center">1.00    0.867   0.833</td></tr><tr><td align="center">9</td><td align="center">0.9</td><td align="center">0.85</td><td align="center">1.00    0.867   0.833</td></tr><tr><td align="center">10</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.900    0.767</td></tr><tr><td align="center">11</td><td align="center">0.933</td><td align="center">0.9</td><td align="center">1.00    0.967   0.833</td></tr><tr><td align="center">12</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.833   0.833</td></tr><tr><td align="center">13</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.900   0.767</td></tr><tr><td align="center">14</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.900   0.867</td></tr><tr><td align="center">15</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.867   0.900</td></tr><tr><td align="center">16</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00    0.900   0.833</td></tr><tr><td align="center">17</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00    0.867    0.867</td></tr><tr><td align="center">18</td><td align="center">0.867</td><td align="center">0.8</td><td align="center">1.00    0.867    0.733</td></tr><tr><td align="center">19</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00    0.967    0.867</td></tr><tr><td align="center">20</td><td align="center">0.9</td><td align="center">0.85</td><td align="center">1.00    0.833    0.867</td></tr><tr><td align="center">21</td><td align="center">0.956</td><td align="center">0.933</td><td align="center">1.00    0.933    0.933</td></tr><tr><td align="center">22</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.933    0.733</td></tr><tr><td align="center">23</td><td align="center">0.922</td><td align="center">0.883</td><td align="center">1.00    0.933   0.833</td></tr><tr><td align="center">24</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00    0.900    0.933</td></tr><tr><td align="center">25</td><td align="center">0.9</td><td align="center">0.85</td><td align="center">1.00    0.967   0.733</td></tr><tr><td align="center">26</td><td align="center">0.867</td><td align="center">0.8</td><td align="center">1.00    0.867   0.733</td></tr><tr><td align="center">27</td><td align="center">0.889</td><td align="center">0.833</td><td align="center">1.00    0.833   0.833</td></tr><tr><td align="center">28</td><td align="center">0.911</td><td align="center">0.867</td><td align="center">1.00    0.900   0.833</td></tr><tr><td align="center">29</td><td align="center">0.944</td><td align="center">0.917</td><td align="center">1.00    0.967  0.867</td></tr><tr><td align="center">30</td><td align="center">0.867</td><td align="center">0.8</td><td align="center">1.00    0.800     0.800</td></tr><tr><td align="center"><strong>å¹³å‡å€¼</strong></td><td align="center"><strong>0.910</strong></td><td align="center"><strong>0.886</strong></td><td align="center"><strong>1.00    0.900  0.831</strong></td></tr></tbody></table></li></ol><h3 id="ç»“æœåˆ†æ"><a href="#ç»“æœåˆ†æ" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h3><ol><li><p>sonar</p><p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œsonaræ•°æ®é›†çš„åˆ†ç±»ç²¾åº¦å¹¶ä¸ç†æƒ³ï¼Œåˆ†ç±»æ–¹æ¡ˆä¸€åªæœ‰68.7%ï¼Œåˆ†ç±»æ–¹æ¡ˆäºŒä¸º63.5%ï¼Œkappaç³»æ•°ä¹Ÿåªæœ‰0.373ã€0.365ï¼Œè¿™è¯´æ˜åˆ†ç±»æ•ˆæœè¾ƒä¸ºä¸€èˆ¬ï¼Œä¸ªäººè®¤ä¸ºåˆ†ç±»æ•ˆæœä¸€èˆ¬çš„åŸå› å¦‚ä¸‹ï¼š</p><p>sonaræ•°æ®é›†çš„ç»´åº¦è¾ƒé«˜ï¼Œè¶³è¶³æœ‰60ç»´ï¼Œè€Œæˆ‘ä»¬ç›´æ¥å°†å…¶é™åˆ°äº†è¾ƒä½çš„ç»´åº¦ï¼Œé™ç»´çš„è¿‡ç¨‹ä¸­é¿å…ä¸äº†æœ‰æ•ˆä¿¡æ¯çš„æŸå¤±ï¼Œæœ‰å¯èƒ½æ˜¯å› ä¸ºæœ‰æ•ˆä¿¡æ¯æŸå¤±è¿‡å¤šï¼Œå¯¼è‡´åˆ†ç±»æ•ˆæœä¸ç†æƒ³ã€‚</p><p>å¯è¡Œçš„æ”¹è¿›æ–¹æ³•æ˜¯é™æˆä¸ç®—å¤ªä½çš„ç»´åº¦è¿›è¡Œåˆ†ç±»ã€‚</p></li><li><p>irisæ•°æ®é›†</p><p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸‰åˆ†ç±»çš„å‡†ç¡®ç‡æ–¹æ¡ˆä¸€è¾¾åˆ°äº†90.4%ï¼Œæ–¹æ¡ˆäºŒä¸º91.0%ï¼Œkappaç³»æ•°è¾¾åˆ°äº†0.856ã€0.886ï¼Œè¯´æ˜åˆ†ç±»æ•ˆæœå¾ˆå¥½ï¼Œä¸å®é™…æƒ…å†µå‡ ä¹å®Œå…¨ä¸€è‡´ã€‚</p><p>ç±»åˆ«åˆ†ç±»ç²¾åº¦ä¸­ç¬¬ä¸€ç±»çš„ç²¾åº¦æœ€é«˜ï¼ŒäºŒä¸‰ç±»ç¨ä½ä¸€ç‚¹ï¼Œå¯ä»¥çœ‹å‡ºï¼šç¬¬ä¸€ç±»é¸¢å°¾èŠ±åœ¨å››ä¸ªç‰¹å¾ä¸Šä¸å¦å¤–ä¸¤ç±»æœ‰è¾ƒä¸ºæ˜æ˜¾çš„å·®åˆ«ï¼Œå¾ˆå®¹æ˜“è·Ÿå¦å¤–ä¸¤ç±»åŒºåˆ†å¼€æ¥ï¼›è€Œç¬¬äºŒä¸‰ç±»å¯èƒ½æ˜¯åœ¨å››ä¸ªç‰¹å¾ä¸Šçš„å·®åˆ«æ²¡æœ‰ç‰¹åˆ«æ˜æ˜¾ï¼Œæ‰€ä»¥åˆ†ç±»ç²¾åº¦ä¼šæœ‰æ‰€ä¸‹é™ã€‚</p></li></ol><h3 id="ä»£ç å±•ç¤º"><a href="#ä»£ç å±•ç¤º" class="headerlink" title="ä»£ç å±•ç¤º"></a>ä»£ç å±•ç¤º</h3><h4 id="é¸¢å°¾èŠ±æ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºäºsklearnå†…éƒ¨å°è£…çš„æ•°æ®é›†ï¼‰"><a href="#é¸¢å°¾èŠ±æ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºäºsklearnå†…éƒ¨å°è£…çš„æ•°æ®é›†ï¼‰" class="headerlink" title="é¸¢å°¾èŠ±æ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºäºsklearnå†…éƒ¨å°è£…çš„æ•°æ®é›†ï¼‰"></a>é¸¢å°¾èŠ±æ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºäºsklearnå†…éƒ¨å°è£…çš„æ•°æ®é›†ï¼‰</h4><ol><li><strong>åˆ†ç±»æ–¹æ¡ˆä¸€ï¼š</strong></li></ol><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> random<span class="token comment" spellcheck="true"># è®¡ç®—å¹¶è¿”å›å‡å€¼å‘é‡</span><span class="token keyword">def</span> <span class="token function">junzhi</span><span class="token punctuation">(</span>iris<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token comment" spellcheck="true"># è®¡ç®—ç±»å†…ç¦»æ•£åº¦çŸ©é˜µS_i</span><span class="token keyword">def</span> <span class="token function">S_i</span><span class="token punctuation">(</span>iris<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>iris<span class="token punctuation">)</span>    b <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> b <span class="token operator">+</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token punctuation">(</span>iris<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>iris<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> b<span class="token comment" spellcheck="true"># è®¡ç®—ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_w</span><span class="token keyword">def</span> <span class="token function">S_w</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> iris2<span class="token punctuation">)</span><span class="token punctuation">:</span>    b_1 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>iris1<span class="token punctuation">)</span>    b_2 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>iris2<span class="token punctuation">)</span>    c <span class="token operator">=</span> b_1 <span class="token operator">+</span> b_2    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># åˆ’åˆ†è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„å‡½æ•°</span><span class="token keyword">def</span> <span class="token function">train_test</span><span class="token punctuation">(</span>iris<span class="token punctuation">,</span> target<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_iris<span class="token punctuation">,</span> test_iris<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span>\        train_test_split<span class="token punctuation">(</span>iris<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>num<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;'train_iris': train_iris, 'test_iris': test_iris, 'train_target': train_target, 'test_target': test_target&amp;#125;</span><span class="token comment" spellcheck="true"># è®¡ç®—å‡ºæœ€ä¼˜çš„æŠ•å½±æ–¹å‘å¹¶è®¡ç®—å‡ºå†³ç­–ç‚¹</span><span class="token keyword">def</span> <span class="token function">best_w</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> iris2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_iris1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_iris'</span><span class="token punctuation">]</span>    train_iris2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_iris'</span><span class="token punctuation">]</span>    s_0 <span class="token operator">=</span> S_w<span class="token punctuation">(</span>train_iris1<span class="token punctuation">,</span> train_iris2<span class="token punctuation">)</span>    best_w <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>s_0<span class="token punctuation">)</span><span class="token punctuation">,</span> junzhi<span class="token punctuation">(</span>train_iris1<span class="token punctuation">)</span> <span class="token operator">-</span> junzhi<span class="token punctuation">(</span>train_iris2<span class="token punctuation">)</span><span class="token punctuation">)</span>    y_0 <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>train_iris1<span class="token punctuation">,</span> best_w<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>train_iris2<span class="token punctuation">,</span> best_w<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(best_w)</span>    <span class="token keyword">return</span> best_w<span class="token punctuation">,</span> y_0<span class="token comment" spellcheck="true"># å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œåˆ†ç±»å¹¶è®¡ç®—ç›¸å…³è¯„ä»·æŒ‡æ ‡</span><span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(num)</span>    <span class="token comment" spellcheck="true">## è®­ç»ƒé›†å¾—åˆ°çš„æœ€ä½³æ–¹å‘å’Œå†³ç­–ç‚¹</span>    w_best12<span class="token punctuation">,</span>y0_12<span class="token operator">=</span>best_w<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> iris2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span>    w_best13<span class="token punctuation">,</span>y0_13<span class="token operator">=</span>best_w<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> iris3<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target3<span class="token punctuation">,</span> num<span class="token punctuation">)</span>    w_best23<span class="token punctuation">,</span>y0_23<span class="token operator">=</span>best_w<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span> iris3<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> target3<span class="token punctuation">,</span> num<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## æµ‹è¯•é›†</span>    test1<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test2<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test3<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris3<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test1<span class="token punctuation">,</span>test2<span class="token punctuation">,</span>test3<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## å½“å‰æµ‹è¯•é›†å¯¹åº”çš„æ ‡ç­¾</span>    test_target1<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target2<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target3<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris3<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target<span class="token operator">=</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test_target1<span class="token punctuation">,</span>test_target2<span class="token punctuation">,</span>test_target3<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test_target)</span>    <span class="token comment" spellcheck="true">## å­˜æ”¾é¢„æµ‹å¾—åˆ°çš„æ ‡ç­¾</span>    predict_target<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## å…ˆé€šè¿‡ç¬¬ä¸€äºŒç±»å†³ç­–å‡½æ•°</span>    y<span class="token operator">=</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test<span class="token punctuation">,</span>w_best12<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>y0_12 <span class="token operator">or</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>y0_12<span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">## å†é€šè¿‡ç¬¬ä¸€ä¸‰ç±»å†³ç­–å‡½æ•°</span>    y<span class="token operator">=</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test<span class="token punctuation">,</span>w_best13<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>y0_13 <span class="token operator">or</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>y0_13<span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span>    <span class="token comment" spellcheck="true">## å‰©ä½™çš„é€šè¿‡ç¬¬äºŒä¸‰ç±»å†³ç­–å‡½æ•°</span>    y<span class="token operator">=</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test<span class="token punctuation">,</span>w_best23<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>y0_23 <span class="token operator">or</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>y0_23<span class="token punctuation">:</span>                predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span>    <span class="token comment" spellcheck="true"># print(predict_target)</span>    <span class="token comment" spellcheck="true">## è®¡ç®—OAã€AAã€kappaç³»æ•°</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>    num_1<span class="token operator">=</span><span class="token number">0</span>    num_2<span class="token operator">=</span><span class="token number">0</span>    num_3<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬å®é™…åˆ†ç±»çš„æ•°é‡</span>    real_num_1<span class="token operator">=</span><span class="token number">0</span>    real_num_2<span class="token operator">=</span><span class="token number">0</span>    real_num_3<span class="token operator">=</span><span class="token number">0</span>     <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>        <span class="token keyword">if</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_1<span class="token operator">=</span>num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">elif</span> i<span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_2<span class="token operator">=</span>num_2<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_3<span class="token operator">=</span>num_3<span class="token operator">+</span><span class="token number">1</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡å®é™…çš„åˆ†ç±»æ•°é‡</span>        <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            real_num_1<span class="token operator">=</span>real_num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">elif</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            real_num_2<span class="token operator">=</span>real_num_2<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            real_num_3<span class="token operator">=</span>real_num_3<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(num_1)</span>    <span class="token comment" spellcheck="true">### è®¡ç®—ç›¸å…³æŒ‡æ ‡</span>    OA<span class="token operator">=</span><span class="token punctuation">(</span>num_1<span class="token operator">+</span>num_2<span class="token operator">+</span>num_3<span class="token punctuation">)</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_1<span class="token operator">=</span>num_1<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_2<span class="token operator">=</span>num_2<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_3<span class="token operator">=</span>num_3<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    pe<span class="token operator">=</span><span class="token punctuation">(</span>real_num_1<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span><span class="token operator">+</span>real_num_2<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span>\        <span class="token operator">+</span>real_num_3<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    kappa<span class="token operator">=</span><span class="token punctuation">(</span>OA<span class="token operator">-</span>pe<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>pe<span class="token punctuation">)</span>    <span class="token keyword">return</span> OA<span class="token punctuation">,</span><span class="token punctuation">[</span>AA_1<span class="token punctuation">,</span>AA_2<span class="token punctuation">,</span>AA_3<span class="token punctuation">]</span><span class="token punctuation">,</span>kappa<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># å¯¼å…¥æ•°æ®å¹¶å»é‡çº²</span>    data <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>    iris1 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    iris2 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    iris3 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    max_feature<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\        np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    iris1<span class="token operator">=</span>iris1<span class="token operator">/</span>max_feature    iris2<span class="token operator">=</span>iris2<span class="token operator">/</span>max_feature    iris3<span class="token operator">=</span>iris3<span class="token operator">/</span>max_feature    <span class="token comment" spellcheck="true"># å¯¼å…¥æ ‡ç­¾</span>    target1 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    target2 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    target3 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    <span class="token comment" spellcheck="true"># å­˜å‚¨ç›¸å…³çš„æŒ‡æ ‡å€¼</span>    OAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    AAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    kappas<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#éšæœºç»™å‡º30ä¸ªéšæœºç§å­ï¼Œç”¨äºtrain_testå‡½æ•°</span>    <span class="token comment" spellcheck="true"># nums=[703,5205,8248,4998,1027,8528,7063,6513,793,2805,1524,8985,3939,9000\</span>    <span class="token comment" spellcheck="true"># ,3796,3178,628,9359,582,265,5920,8866,7960,5090,5481,4928,526,8763,5333,6596]</span>    nums<span class="token operator">=</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>    j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">while</span> j<span class="token operator">&lt;</span><span class="token number">30</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            OAs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>AAs<span class="token punctuation">[</span>j<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>kappas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>classify<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>            j<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span>            k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            k<span class="token operator">+=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(OAs)</span>    temp<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> OAs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>            temp<span class="token operator">=</span>temp<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(AAs)</span>    <span class="token comment" spellcheck="true"># print(OAs)</span>    <span class="token comment" spellcheck="true"># print(kappas)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AAå€¼åˆ†åˆ«ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">,</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OAå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kappaå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>kappas<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><ol start="2"><li><strong>åˆ†ç±»æ–¹æ¡ˆäºŒ</strong>ï¼š</li></ol><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> random<span class="token comment" spellcheck="true"># è®¡ç®—å¹¶è¿”å›å‡å€¼å‘é‡</span><span class="token keyword">def</span> <span class="token function">junzhi</span><span class="token punctuation">(</span>iris<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token comment" spellcheck="true"># è®¡ç®—ç±»å†…ç¦»æ•£åº¦çŸ©é˜µS_i</span><span class="token keyword">def</span> <span class="token function">S_i</span><span class="token punctuation">(</span>iris<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>iris<span class="token punctuation">)</span>    b <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> b <span class="token operator">+</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token punctuation">(</span>iris<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>iris<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> b<span class="token comment" spellcheck="true"># è®¡ç®—æ€»ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_w</span><span class="token keyword">def</span> <span class="token function">S_w</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> iris2<span class="token punctuation">,</span> iris3<span class="token punctuation">)</span><span class="token punctuation">:</span>    b_1 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>iris1<span class="token punctuation">)</span>    b_2 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>iris2<span class="token punctuation">)</span>    b_3 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>iris3<span class="token punctuation">)</span>    c <span class="token operator">=</span> b_1 <span class="token operator">+</span> b_2 <span class="token operator">+</span> b_3    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># è®¡ç®—æ ·æœ¬ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_b</span><span class="token keyword">def</span> <span class="token function">S_b</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># æ±‚ç±»åˆ«å‡å€¼ä»¥åŠæ‰€æœ‰æ ·æœ¬çš„å‡å€¼</span>    mu_iris1 <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>iris1<span class="token punctuation">)</span>    mu_iris2 <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>iris2<span class="token punctuation">)</span>    mu_iris3 <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>iris3<span class="token punctuation">)</span>    mu <span class="token operator">=</span> <span class="token punctuation">(</span>mu_iris1<span class="token operator">+</span>mu_iris2<span class="token operator">+</span>mu_iris3<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span>    c<span class="token operator">=</span>iris1<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>mu_iris1<span class="token operator">-</span>mu<span class="token punctuation">,</span><span class="token punctuation">(</span>mu_iris1<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span> \      iris2<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>mu_iris2<span class="token operator">-</span>mu<span class="token punctuation">,</span><span class="token punctuation">(</span>mu_iris2<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span> \      iris3<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>mu_iris3<span class="token operator">-</span>mu<span class="token punctuation">,</span><span class="token punctuation">(</span>mu_iris3<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># åˆ’åˆ†è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„å‡½æ•°</span><span class="token keyword">def</span> <span class="token function">train_test</span><span class="token punctuation">(</span>iris<span class="token punctuation">,</span> target<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_iris<span class="token punctuation">,</span> test_iris<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span> \        train_test_split<span class="token punctuation">(</span>iris<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>num<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;'train_iris': train_iris, 'test_iris': test_iris, 'train_target': train_target, 'test_target': test_target&amp;#125;</span><span class="token comment" spellcheck="true"># è®¡ç®—å‡ºæœ€ä¼˜çš„æŠ•å½±æ–¹å‘(åˆ°2ç»´å¹³é¢)</span><span class="token keyword">def</span> <span class="token function">best_w</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_iris1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_iris'</span><span class="token punctuation">]</span>    train_iris2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_iris'</span><span class="token punctuation">]</span>    train_iris3 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>iris3<span class="token punctuation">,</span> target3<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_iris'</span><span class="token punctuation">]</span>    s_b <span class="token operator">=</span> S_b<span class="token punctuation">(</span>train_iris1<span class="token punctuation">,</span> train_iris2<span class="token punctuation">,</span> train_iris3<span class="token punctuation">)</span>    s_w <span class="token operator">=</span> S_w<span class="token punctuation">(</span>train_iris1<span class="token punctuation">,</span> train_iris2<span class="token punctuation">,</span> train_iris3<span class="token punctuation">)</span>    eigvalue<span class="token punctuation">,</span>eigvector<span class="token operator">=</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>eig<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>s_w<span class="token punctuation">)</span><span class="token punctuation">,</span>s_b<span class="token punctuation">)</span><span class="token punctuation">)</span>    eig<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>eigvalue<span class="token punctuation">,</span>eigvector<span class="token punctuation">)</span><span class="token punctuation">)</span>    eig<span class="token operator">=</span>eig<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>eig<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    best_w<span class="token operator">=</span>eig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> best_w<span class="token comment" spellcheck="true"># æ ¹æ®kå€¼è®¡ç®—ç‚¹ï¼Œå¹¶è¿”å›ç±»åˆ«</span><span class="token keyword">def</span> <span class="token function">knn</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test<span class="token punctuation">,</span>test_target<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>    dis<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dis<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>real<span class="token operator">-</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>real<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>real<span class="token operator">-</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>real<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(a.shape)</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(a)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">## è®¾ç½®ä¸€ä¸ªæ•°ç»„æ¥ç»Ÿè®¡å„ç±»çš„ä¸ªæ•°</span>    n<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> a<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">elif</span> a<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(n)</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>n<span class="token operator">==</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ç»™å®šå‚æ•°ï¼Œç”»å‡ºåˆ†ç±»ç»“æœå›¾</span><span class="token keyword">def</span> <span class="token function">ploty</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>predict_target<span class="token punctuation">,</span>real_num_1<span class="token punctuation">,</span>real_num_2<span class="token punctuation">,</span>real_num_3<span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>predict_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>real_num_1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>real_num_1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>a<span class="token punctuation">[</span>real_num_1<span class="token punctuation">:</span>real_num_1<span class="token operator">+</span>real_num_2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>real_num_1<span class="token punctuation">:</span>real_num_1<span class="token operator">+</span>real_num_2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># plt.scatter(a[real_num_2:real_num_2+real_num_3,0],a[real_num_2:real_num_2+real_num_3,0],color='green',marker='o')</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œåˆ†ç±»å¹¶è®¡ç®—ç›¸å…³è¯„ä»·æŒ‡æ ‡</span><span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(num)</span>    <span class="token comment" spellcheck="true">## è®­ç»ƒé›†å¾—åˆ°çš„æŠ•å½±æ–¹å‘</span>    w_best<span class="token operator">=</span>best_w<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## æµ‹è¯•é›†</span>    test1_iris<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test2_iris<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test3_iris<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris3<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_iris'</span><span class="token punctuation">]</span>    test_iris<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test1_iris<span class="token punctuation">,</span>test2_iris<span class="token punctuation">,</span>test3_iris<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## å°†æµ‹è¯•é›†æŒ‰ç…§æŠ•å½±æ–¹å‘æŠ•å½±</span>    test<span class="token operator">=</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test_iris<span class="token punctuation">,</span>w_best<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test.shape)</span>    <span class="token comment" spellcheck="true">## å½“å‰æµ‹è¯•é›†å¯¹åº”çš„æ ‡ç­¾</span>    test_target1<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target2<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target3<span class="token operator">=</span>train_test<span class="token punctuation">(</span>iris3<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target<span class="token operator">=</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test_target1<span class="token punctuation">,</span>test_target2<span class="token punctuation">,</span>test_target3<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test_target.shape)</span>    <span class="token comment" spellcheck="true">## å­˜æ”¾é¢„æµ‹å¾—åˆ°çš„æ ‡ç­¾</span>    predict_target<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># åˆ©ç”¨knnè¿›è¡Œåˆ†ç±»</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>knn<span class="token punctuation">(</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test<span class="token punctuation">,</span>test_target<span class="token punctuation">,</span>k<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(predict_target.shape)</span>    <span class="token comment" spellcheck="true"># print(test_target)</span>    <span class="token comment" spellcheck="true">## è®¡ç®—OAã€AAã€kappaç³»æ•°</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>    num_1<span class="token operator">=</span><span class="token number">0</span>    num_2<span class="token operator">=</span><span class="token number">0</span>    num_3<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬å®é™…åˆ†ç±»çš„æ•°é‡</span>    real_num_1<span class="token operator">=</span><span class="token number">0</span>    real_num_2<span class="token operator">=</span><span class="token number">0</span>    real_num_3<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>        <span class="token keyword">if</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_1<span class="token operator">=</span>num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">elif</span> i<span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_2<span class="token operator">=</span>num_2<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_3<span class="token operator">=</span>num_3<span class="token operator">+</span><span class="token number">1</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡å®é™…çš„åˆ†ç±»æ•°é‡</span>        <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            real_num_1<span class="token operator">=</span>real_num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">elif</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            real_num_2<span class="token operator">=</span>real_num_2<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            real_num_3<span class="token operator">=</span>real_num_3<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(num_1)</span>    <span class="token comment" spellcheck="true">### è®¡ç®—ç›¸å…³æŒ‡æ ‡</span>    OA<span class="token operator">=</span><span class="token punctuation">(</span>num_1<span class="token operator">+</span>num_2<span class="token operator">+</span>num_3<span class="token punctuation">)</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_1<span class="token operator">=</span>num_1<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_2<span class="token operator">=</span>num_2<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_3<span class="token operator">=</span>num_3<span class="token operator">*</span><span class="token number">3</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    pe<span class="token operator">=</span><span class="token punctuation">(</span>real_num_1<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span><span class="token operator">+</span>real_num_2<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span> \        <span class="token operator">+</span>real_num_3<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    kappa<span class="token operator">=</span><span class="token punctuation">(</span>OA<span class="token operator">-</span>pe<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>pe<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç»“æœå›¾</span>    <span class="token comment" spellcheck="true"># ploty(test,predict_target,real_num_1,real_num_2,real_num_3)</span>    <span class="token keyword">return</span> OA<span class="token punctuation">,</span><span class="token punctuation">[</span>AA_1<span class="token punctuation">,</span>AA_2<span class="token punctuation">,</span>AA_3<span class="token punctuation">]</span><span class="token punctuation">,</span>kappa<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># å¯¼å…¥æ•°æ®å¹¶å»é‡çº²</span>    data <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>    iris1 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    iris2 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    iris3 <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>    max_feature<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> \                          np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    iris1<span class="token operator">=</span>iris1<span class="token operator">/</span>max_feature    iris2<span class="token operator">=</span>iris2<span class="token operator">/</span>max_feature    iris3<span class="token operator">=</span>iris3<span class="token operator">/</span>max_feature    <span class="token comment" spellcheck="true"># å¯¼å…¥æ ‡ç­¾</span>    target1 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    target2 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    target3 <span class="token operator">=</span> data<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T    <span class="token comment" spellcheck="true"># å­˜å‚¨ç›¸å…³çš„æŒ‡æ ‡å€¼</span>    OAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    AAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    kappas<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#éšæœºç»™å‡º30ä¸ªéšæœºç§å­ï¼Œç”¨äºtrain_testå‡½æ•°</span>    nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">7136</span><span class="token punctuation">,</span><span class="token number">2619</span><span class="token punctuation">,</span><span class="token number">4794</span><span class="token punctuation">,</span><span class="token number">5676</span><span class="token punctuation">,</span><span class="token number">3265</span><span class="token punctuation">,</span><span class="token number">1979</span><span class="token punctuation">,</span><span class="token number">906</span><span class="token punctuation">,</span><span class="token number">9058</span><span class="token punctuation">,</span><span class="token number">2011</span><span class="token punctuation">,</span><span class="token number">5435</span><span class="token punctuation">,</span><span class="token number">1729</span><span class="token punctuation">,</span><span class="token number">4558</span><span class="token punctuation">,</span><span class="token number">8765</span><span class="token punctuation">,</span><span class="token number">6826</span><span class="token punctuation">,</span><span class="token number">6174</span><span class="token punctuation">,</span><span class="token number">6286</span><span class="token punctuation">,</span><span class="token number">7825</span><span class="token punctuation">,</span><span class="token number">4843</span><span class="token punctuation">,</span><span class="token number">9697</span><span class="token punctuation">,</span><span class="token number">788</span><span class="token punctuation">,</span><span class="token number">8082</span><span class="token punctuation">,</span><span class="token number">3785</span><span class="token punctuation">,</span><span class="token number">8206</span><span class="token punctuation">,</span><span class="token number">5383</span><span class="token punctuation">,</span><span class="token number">4723</span><span class="token punctuation">,</span><span class="token number">7249</span><span class="token punctuation">,</span><span class="token number">4929</span><span class="token punctuation">,</span><span class="token number">4722</span><span class="token punctuation">,</span><span class="token number">9587</span><span class="token punctuation">,</span><span class="token number">4400</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># nums=random.sample(range(0,10000),100)</span>    j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">while</span> j<span class="token operator">&lt;</span><span class="token number">30</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            OAs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>AAs<span class="token punctuation">[</span>j<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>kappas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>classify<span class="token punctuation">(</span>iris1<span class="token punctuation">,</span>iris2<span class="token punctuation">,</span>iris3<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>target3<span class="token punctuation">,</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            j<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span>            i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            i<span class="token operator">+=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true">#     print(j)</span>    <span class="token comment" spellcheck="true"># OAs[j],AAs[j,],kappas[j]=classify(iris1,iris2,iris3,target1,target2,target3,9587)</span>    temp<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> OAs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>            temp<span class="token operator">=</span>temp<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(np.around(AAs,decimals=3))</span>    <span class="token comment" spellcheck="true"># print(np.around(OAs,decimals=3))</span>    <span class="token comment" spellcheck="true"># print(np.around(kappas,decimals=3))</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AAå€¼åˆ†åˆ«ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">,</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OAå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kappaå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>kappas<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="sonaræ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºè§é™„ä»¶sonar-xlsxï¼‰"><a href="#sonaræ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºè§é™„ä»¶sonar-xlsxï¼‰" class="headerlink" title="sonaræ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºè§é™„ä»¶sonar.xlsxï¼‰"></a>sonaræ•°æ®é›†åˆ†ç±»ï¼ˆæ•°æ®æ¥æºè§é™„ä»¶sonar.xlsxï¼‰</h4><ol><li><strong>åˆ†ç±»æ–¹æ¡ˆä¸€ï¼š</strong></li></ol><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> random<span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook<span class="token comment" spellcheck="true"># è®¡ç®—å¹¶è¿”å›å‡å€¼å‘é‡</span><span class="token keyword">def</span> <span class="token function">junzhi</span><span class="token punctuation">(</span>sonar<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>sonar<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token comment" spellcheck="true"># è®¡ç®—ç±»å†…ç¦»æ•£åº¦çŸ©é˜µS_i</span><span class="token keyword">def</span> <span class="token function">S_i</span><span class="token punctuation">(</span>sonar<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>sonar<span class="token punctuation">)</span>    b <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> b <span class="token operator">+</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token punctuation">(</span>sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> b<span class="token comment" spellcheck="true"># è®¡ç®—ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_w</span><span class="token keyword">def</span> <span class="token function">S_w</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">)</span><span class="token punctuation">:</span>    b_1 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>sonar1<span class="token punctuation">)</span>    b_2 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>sonar2<span class="token punctuation">)</span>    c <span class="token operator">=</span> b_1 <span class="token operator">+</span> b_2    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># åˆ’åˆ†è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„å‡½æ•°</span><span class="token keyword">def</span> <span class="token function">train_test</span><span class="token punctuation">(</span>sonar<span class="token punctuation">,</span> target<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_sonar<span class="token punctuation">,</span> test_sonar<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span>\        train_test_split<span class="token punctuation">(</span>sonar<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>num<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;'train_sonar': train_sonar, 'test_sonar': test_sonar, 'train_target': train_target, 'test_target': test_target&amp;#125;</span><span class="token comment" spellcheck="true"># è®¡ç®—å‡ºæœ€ä¼˜çš„æŠ•å½±æ–¹å‘å¹¶è®¡ç®—å‡ºå†³ç­–ç‚¹</span><span class="token keyword">def</span> <span class="token function">best_w</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_sonar1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_sonar'</span><span class="token punctuation">]</span>    train_sonar2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_sonar'</span><span class="token punctuation">]</span>    s_0 <span class="token operator">=</span> S_w<span class="token punctuation">(</span>train_sonar1<span class="token punctuation">,</span> train_sonar2<span class="token punctuation">)</span>    best_w <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>s_0<span class="token punctuation">)</span><span class="token punctuation">,</span> junzhi<span class="token punctuation">(</span>train_sonar1<span class="token punctuation">)</span> <span class="token operator">-</span> junzhi<span class="token punctuation">(</span>train_sonar2<span class="token punctuation">)</span><span class="token punctuation">)</span>    y_0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">58</span><span class="token operator">/</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token operator">*</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>train_sonar1<span class="token punctuation">,</span> best_w<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">66</span><span class="token operator">/</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token operator">*</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>train_sonar2<span class="token punctuation">,</span> best_w<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(best_w)</span>    <span class="token keyword">return</span> best_w<span class="token punctuation">,</span> y_0<span class="token comment" spellcheck="true"># å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œåˆ†ç±»å¹¶è®¡ç®—ç›¸å…³è¯„ä»·æŒ‡æ ‡</span><span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>sonar2<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(num)</span>    <span class="token comment" spellcheck="true">## è®­ç»ƒé›†å¾—åˆ°çš„æœ€ä½³æ–¹å‘å’Œå†³ç­–ç‚¹</span>    w_best12<span class="token punctuation">,</span>y0_12<span class="token operator">=</span>best_w<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## æµ‹è¯•é›†</span>    test1<span class="token operator">=</span>train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_sonar'</span><span class="token punctuation">]</span>    test2<span class="token operator">=</span>train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_sonar'</span><span class="token punctuation">]</span>    test<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test1<span class="token punctuation">,</span>test2<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## å½“å‰æµ‹è¯•é›†å¯¹åº”çš„æ ‡ç­¾</span>    test_target1<span class="token operator">=</span>train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target2<span class="token operator">=</span>train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(test_target1.shape)</span>    <span class="token comment" spellcheck="true"># print(test_target2.shape)</span>    test_target<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test_target1<span class="token punctuation">,</span>test_target2<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test_target.shape)</span>    <span class="token comment" spellcheck="true"># print(test_target)</span>    <span class="token comment" spellcheck="true">## å­˜æ”¾é¢„æµ‹å¾—åˆ°çš„æ ‡ç­¾</span>    predict_target<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## é€šè¿‡å†³ç­–å‡½æ•°</span>    y<span class="token operator">=</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test<span class="token punctuation">,</span>w_best12<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>y0_12 <span class="token operator">or</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>y0_12<span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(predict_target)</span>    <span class="token comment" spellcheck="true">## è®¡ç®—OAã€AAã€kappaç³»æ•°</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>    num_1<span class="token operator">=</span><span class="token number">0</span>    num_2<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬å®é™…åˆ†ç±»çš„æ•°é‡</span>    real_num_1<span class="token operator">=</span><span class="token number">0</span>    real_num_2<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>        <span class="token keyword">if</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_1<span class="token operator">=</span>num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_2<span class="token operator">=</span>num_2<span class="token operator">+</span><span class="token number">1</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡å®é™…çš„åˆ†ç±»æ•°é‡</span>        <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            real_num_1<span class="token operator">=</span>real_num_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            real_num_2<span class="token operator">=</span>real_num_2<span class="token operator">+</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(num_1)</span>    <span class="token comment" spellcheck="true">### è®¡ç®—ç›¸å…³æŒ‡æ ‡</span>    OA<span class="token operator">=</span><span class="token punctuation">(</span>num_1<span class="token operator">+</span>num_2<span class="token punctuation">)</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_1<span class="token operator">=</span><span class="token punctuation">(</span>num_1<span class="token punctuation">)</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span>    AA_2<span class="token operator">=</span><span class="token punctuation">(</span>num_2<span class="token punctuation">)</span><span class="token operator">/</span>len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span>    pe<span class="token operator">=</span><span class="token punctuation">(</span>real_num_1<span class="token operator">*</span>len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span><span class="token operator">+</span>real_num_2<span class="token operator">*</span>\        len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    kappa<span class="token operator">=</span><span class="token punctuation">(</span>OA<span class="token operator">-</span>pe<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>pe<span class="token punctuation">)</span>    <span class="token keyword">return</span> OA<span class="token punctuation">,</span><span class="token punctuation">[</span>AA_1<span class="token punctuation">,</span>AA_2<span class="token punctuation">]</span><span class="token punctuation">,</span>kappa<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># å¯¼å…¥æ•°æ®</span>    workbook<span class="token operator">=</span>load_workbook<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'sonar.xlsx'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(workbook.sheetnames)</span>    sheet<span class="token operator">=</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet1'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨æ ·æœ¬ç‰¹å¾é›†</span>    sonar<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨æ ‡ç­¾</span>    target<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token operator">=</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value    <span class="token comment" spellcheck="true"># print(sonar.shape)</span>    <span class="token comment" spellcheck="true"># print(sonar[0,59])</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">==</span><span class="token string">'R'</span><span class="token punctuation">:</span>            target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(target[97])</span>    sonar1<span class="token operator">=</span>sonar<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    sonar2<span class="token operator">=</span>sonar<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">:</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    target1<span class="token operator">=</span>target<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    target2<span class="token operator">=</span>target<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">:</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨ç›¸å…³çš„æŒ‡æ ‡å€¼</span>    OAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    AAs<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    kappas<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#éšæœºç»™å‡º30ä¸ªéšæœºç§å­ï¼Œç”¨äºtrain_testå‡½æ•°</span>    <span class="token comment" spellcheck="true"># nums=[703,5205,8248,4998,1027,8528,7063,6513,793,2805,1524,8985,3939,9000\</span>    <span class="token comment" spellcheck="true"># ,3796,3178,628,9359,582,265,5920,8866,7960,5090,5481,4928,526,8763,5333,6596]</span>    nums<span class="token operator">=</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>    j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">while</span> j<span class="token operator">&lt;</span><span class="token number">30</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            OAs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>AAs<span class="token punctuation">[</span>j<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>kappas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>classify<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>sonar2<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>            j<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span>            k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            k<span class="token operator">+=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># OAs[j],AAs[j,],kappas[j]=classify(sonar1,sonar2,target1,target2,nums[k])</span>    temp<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> OAs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>            temp<span class="token operator">=</span>temp<span class="token operator">+</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>OAs<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>AAs<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>kappas<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AAå€¼åˆ†åˆ«ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">,</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OAå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kappaå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>kappas<span class="token punctuation">)</span><span class="token operator">/</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><ol start="2"><li><strong>åˆ†ç±»æ–¹æ¡ˆäºŒï¼š</strong></li></ol><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> random<span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook<span class="token comment" spellcheck="true"># è®¡ç®—å¹¶è¿”å›å‡å€¼å‘é‡</span><span class="token keyword">def</span> <span class="token function">junzhi</span><span class="token punctuation">(</span>sonar<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>sonar<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a<span class="token comment" spellcheck="true"># è®¡ç®—ç±»å†…ç¦»æ•£åº¦çŸ©é˜µS_i</span><span class="token keyword">def</span> <span class="token function">S_i</span><span class="token punctuation">(</span>sonar<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>sonar<span class="token punctuation">)</span>    b <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>sonar<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> b <span class="token operator">+</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token punctuation">(</span>sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> b<span class="token comment" spellcheck="true"># è®¡ç®—ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_w</span><span class="token keyword">def</span> <span class="token function">S_w</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">)</span><span class="token punctuation">:</span>    b_1 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>sonar1<span class="token punctuation">)</span>    b_2 <span class="token operator">=</span> S_i<span class="token punctuation">(</span>sonar2<span class="token punctuation">)</span>    c <span class="token operator">=</span> b_1 <span class="token operator">+</span> b_2    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># è®¡ç®—æ ·æœ¬ç±»é—´ç¦»æ•£åº¦çŸ©é˜µS_b</span><span class="token keyword">def</span> <span class="token function">S_b</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>sonar2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># æ±‚ç±»åˆ«å‡å€¼ä»¥åŠæ‰€æœ‰æ ·æœ¬çš„å‡å€¼</span>    mu_sonar1 <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>sonar1<span class="token punctuation">)</span>    mu_sonar2 <span class="token operator">=</span> junzhi<span class="token punctuation">(</span>sonar2<span class="token punctuation">)</span>    mu <span class="token operator">=</span> <span class="token punctuation">(</span>sonar1<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mu_sonar1<span class="token operator">+</span>sonar2<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>mu_sonar2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>sonar2<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>sonar1<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    c<span class="token operator">=</span>sonar1<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>mu_sonar1<span class="token operator">-</span>mu<span class="token punctuation">,</span><span class="token punctuation">(</span>mu_sonar1<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token operator">+</span> \      sonar2<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>mu_sonar2<span class="token operator">-</span>mu<span class="token punctuation">,</span><span class="token punctuation">(</span>mu_sonar2<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token comment" spellcheck="true"># åˆ’åˆ†è®­ç»ƒé›†ã€æµ‹è¯•é›†çš„å‡½æ•°</span><span class="token keyword">def</span> <span class="token function">train_test</span><span class="token punctuation">(</span>sonar<span class="token punctuation">,</span> target<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_sonar<span class="token punctuation">,</span> test_sonar<span class="token punctuation">,</span> train_target<span class="token punctuation">,</span> test_target <span class="token operator">=</span> \        train_test_split<span class="token punctuation">(</span>sonar<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>num<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;'train_sonar': train_sonar, 'test_sonar': test_sonar, 'train_target': train_target,</span>            <span class="token string">'test_target'</span><span class="token punctuation">:</span> test_target<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span><span class="token comment" spellcheck="true"># è®¡ç®—å‡ºæœ€ä¼˜çš„æŠ•å½±æ–¹å‘å¹¶è®¡ç®—å‡ºå†³ç­–ç‚¹</span><span class="token keyword">def</span> <span class="token function">best_w</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span>sonar2<span class="token punctuation">,</span>target1<span class="token punctuation">,</span>target2<span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    train_sonar1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_sonar'</span><span class="token punctuation">]</span>    train_sonar2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'train_sonar'</span><span class="token punctuation">]</span>    s_b <span class="token operator">=</span> S_b<span class="token punctuation">(</span>train_sonar1<span class="token punctuation">,</span> train_sonar2<span class="token punctuation">)</span>    s_w <span class="token operator">=</span> S_w<span class="token punctuation">(</span>train_sonar1<span class="token punctuation">,</span> train_sonar2<span class="token punctuation">)</span>    eigvalue<span class="token punctuation">,</span>eigvector<span class="token operator">=</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>eig<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>s_w<span class="token punctuation">)</span><span class="token punctuation">,</span>s_b<span class="token punctuation">)</span><span class="token punctuation">)</span>    eig<span class="token operator">=</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>eigvalue<span class="token punctuation">,</span>eigvector<span class="token punctuation">)</span><span class="token punctuation">)</span>    eig<span class="token operator">=</span>eig<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>eig<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    best_w<span class="token operator">=</span>eig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> best_w<span class="token keyword">def</span> <span class="token function">knn</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test<span class="token punctuation">,</span>test_target<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>    dis<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dis<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>real<span class="token operator">-</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>real<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>real<span class="token operator">-</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>real<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(a.shape)</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(a)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true">## è®¾ç½®ä¸€ä¸ªæ•°ç»„æ¥ç»Ÿè®¡å„ç±»çš„ä¸ªæ•°</span>    n<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> a<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>            n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(n)</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>n<span class="token operator">==</span>np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">ploty</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>predict_target<span class="token punctuation">,</span>real_num_1<span class="token punctuation">,</span>real_num_2<span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token operator">=</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span>predict_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    a<span class="token operator">=</span>a<span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>real_num_1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>real_num_1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>a<span class="token punctuation">[</span>real_num_1<span class="token punctuation">:</span>real_num_1<span class="token operator">+</span>real_num_2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>real_num_1<span class="token punctuation">:</span>real_num_1<span class="token operator">+</span>real_num_2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># plt.scatter(a[real_num_2:real_num_2+real_num_3,0],a[real_num_2:real_num_2+real_num_3,0],color='green',marker='o')</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œåˆ†ç±»å¹¶è®¡ç®—ç›¸å…³è¯„ä»·æŒ‡æ ‡</span><span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(num)</span>    <span class="token comment" spellcheck="true">## è®­ç»ƒé›†å¾—åˆ°çš„æœ€ä½³æ–¹å‘å’Œå†³ç­–ç‚¹</span>    w_best <span class="token operator">=</span> best_w<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## æµ‹è¯•é›†</span>    test1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_sonar'</span><span class="token punctuation">]</span>    test2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_sonar'</span><span class="token punctuation">]</span>    test <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test1<span class="token punctuation">,</span> test2<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## å½“å‰æµ‹è¯•é›†å¯¹åº”çš„æ ‡ç­¾</span>    test_target1 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    test_target2 <span class="token operator">=</span> train_test<span class="token punctuation">(</span>sonar2<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'test_target'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(test_target1.shape)</span>    <span class="token comment" spellcheck="true"># print(test_target2.shape)</span>    test_target <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>test_target1<span class="token punctuation">,</span> test_target2<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test_target.shape)</span>    <span class="token comment" spellcheck="true"># print(test_target)</span>    <span class="token comment" spellcheck="true">## å­˜æ”¾é¢„æµ‹å¾—åˆ°çš„æ ‡ç­¾</span>    predict_target <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">## é€šè¿‡å†³ç­–å‡½æ•°</span>    test <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>test<span class="token punctuation">,</span> w_best<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(test.shape)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>knn<span class="token punctuation">(</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test<span class="token punctuation">,</span>test_target<span class="token punctuation">,</span>k<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(predict_target)</span>    <span class="token comment" spellcheck="true">## è®¡ç®—OAã€AAã€kappaç³»æ•°</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>    num_1 <span class="token operator">=</span> <span class="token number">0</span>    num_2 <span class="token operator">=</span> <span class="token number">0</span>    <span class="token comment" spellcheck="true">### è®°å½•ä¸‰ç±»æ ·æœ¬å®é™…åˆ†ç±»çš„æ•°é‡</span>    real_num_1 <span class="token operator">=</span> <span class="token number">0</span>    real_num_2 <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡åˆ†ç±»æ­£ç¡®çš„æ•°é‡</span>        <span class="token keyword">if</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_1 <span class="token operator">=</span> num_1 <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> test_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>                num_2 <span class="token operator">=</span> num_2 <span class="token operator">+</span> <span class="token number">1</span>        <span class="token comment" spellcheck="true">## ç»Ÿè®¡å®é™…çš„åˆ†ç±»æ•°é‡</span>        <span class="token keyword">if</span> predict_target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            real_num_1 <span class="token operator">=</span> real_num_1 <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            real_num_2 <span class="token operator">=</span> real_num_2 <span class="token operator">+</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(num_1)</span>    <span class="token comment" spellcheck="true">### è®¡ç®—ç›¸å…³æŒ‡æ ‡</span>    OA <span class="token operator">=</span> <span class="token punctuation">(</span>num_1 <span class="token operator">+</span> num_2<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span>    AA_1 <span class="token operator">=</span> <span class="token punctuation">(</span>num_1<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span>    AA_2 <span class="token operator">=</span> <span class="token punctuation">(</span>num_2<span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span>    pe <span class="token operator">=</span> <span class="token punctuation">(</span>real_num_1 <span class="token operator">*</span> len<span class="token punctuation">(</span>test_target1<span class="token punctuation">)</span> <span class="token operator">+</span> real_num_2 <span class="token operator">*</span> \          len<span class="token punctuation">(</span>test_target2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>len<span class="token punctuation">(</span>test_target<span class="token punctuation">)</span><span class="token punctuation">)</span>    kappa <span class="token operator">=</span> <span class="token punctuation">(</span>OA <span class="token operator">-</span> pe<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> pe<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç”»å›¾</span>    <span class="token comment" spellcheck="true"># ploty(test,predict_target,real_num_1,real_num_2)</span>    <span class="token keyword">return</span> OA<span class="token punctuation">,</span> <span class="token punctuation">[</span>AA_1<span class="token punctuation">,</span> AA_2<span class="token punctuation">]</span><span class="token punctuation">,</span> kappa<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># å¯¼å…¥æ•°æ®</span>    workbook <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">'sonar.xlsx'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(workbook.sheetnames)</span>    sheet <span class="token operator">=</span> workbook<span class="token punctuation">[</span><span class="token string">'Sheet1'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨æ ·æœ¬ç‰¹å¾é›†</span>    sonar <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨æ ‡ç­¾</span>    target <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            sonar<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value    <span class="token comment" spellcheck="true"># print(sonar.shape)</span>    <span class="token comment" spellcheck="true"># print(sonar[0,59])</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">'R'</span><span class="token punctuation">:</span>            target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            target<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(target[97])</span>    sonar1 <span class="token operator">=</span> sonar<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>    sonar2 <span class="token operator">=</span> sonar<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">:</span><span class="token number">208</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>    target1 <span class="token operator">=</span> target<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>    target2 <span class="token operator">=</span> target<span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">:</span><span class="token number">208</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># å­˜å‚¨ç›¸å…³çš„æŒ‡æ ‡å€¼</span>    OAs <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    AAs <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    kappas <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># éšæœºç»™å‡º30ä¸ªéšæœºç§å­ï¼Œç”¨äºtrain_testå‡½æ•°</span>    nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">7136</span><span class="token punctuation">,</span><span class="token number">796</span><span class="token punctuation">,</span><span class="token number">3590</span><span class="token punctuation">,</span><span class="token number">5709</span><span class="token punctuation">,</span><span class="token number">8347</span><span class="token punctuation">,</span><span class="token number">1121</span><span class="token punctuation">,</span><span class="token number">9951</span><span class="token punctuation">,</span><span class="token number">5279</span><span class="token punctuation">,</span><span class="token number">7502</span><span class="token punctuation">,</span><span class="token number">1557</span><span class="token punctuation">,</span><span class="token number">9951</span><span class="token punctuation">,</span><span class="token number">6234</span><span class="token punctuation">,</span><span class="token number">8257</span><span class="token punctuation">,</span><span class="token number">9254</span><span class="token punctuation">,</span><span class="token number">471</span><span class="token punctuation">,</span><span class="token number">4617</span><span class="token punctuation">,</span><span class="token number">9754</span><span class="token punctuation">,</span>          <span class="token number">7772</span><span class="token punctuation">,</span><span class="token number">9594</span><span class="token punctuation">,</span><span class="token number">8979</span><span class="token punctuation">,</span><span class="token number">7422</span><span class="token punctuation">,</span><span class="token number">7888</span><span class="token punctuation">,</span><span class="token number">1944</span><span class="token punctuation">,</span><span class="token number">405</span><span class="token punctuation">,</span><span class="token number">2475</span><span class="token punctuation">,</span><span class="token number">1438</span><span class="token punctuation">,</span><span class="token number">4992</span><span class="token punctuation">,</span><span class="token number">6025</span><span class="token punctuation">,</span><span class="token number">7114</span><span class="token punctuation">,</span><span class="token number">7512</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># nums = random.sample(range(0, 10000), 100)</span>    j <span class="token operator">=</span> <span class="token number">0</span>    i <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> j <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            OAs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> AAs<span class="token punctuation">[</span>j<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kappas<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> classify<span class="token punctuation">(</span>sonar1<span class="token punctuation">,</span> sonar2<span class="token punctuation">,</span> target1<span class="token punctuation">,</span> target2<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>            i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># OAs[j],AAs[j,],kappas[j]=classify(sonar1,sonar2,target1,target2,3590)</span>    temp <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> OAs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            temp <span class="token operator">=</span> temp <span class="token operator">+</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># print(OAs)</span>    <span class="token comment" spellcheck="true"># print(AAs)</span>    <span class="token comment" spellcheck="true"># print(kappas)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AAå€¼åˆ†åˆ«ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> temp<span class="token punctuation">,</span> np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>AAs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OAå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>OAs<span class="token punctuation">)</span> <span class="token operator">/</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kappaå€¼ä¸ºï¼š\n&amp;#123;:.3f&amp;#125;"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>kappas<span class="token punctuation">)</span> <span class="token operator">/</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> numpy </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
